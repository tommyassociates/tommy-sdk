var addon=function(t){var e={};function n(a){if(e[a])return e[a].exports;var o=e[a]={i:a,l:!1,exports:{}};return t[a].call(o.exports,o,o.exports,n),o.l=!0,o.exports}return n.m=t,n.c=e,n.d=function(t,e,a){n.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:a})},n.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},n.t=function(t,e){if(1&e&&(t=n(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var a=Object.create(null);if(n.r(a),Object.defineProperty(a,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var o in t)n.d(a,o,function(e){return t[e]}.bind(null,o));return a},n.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return n.d(e,"a",e),e},n.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},n.p="",n(n.s=1)}([,function(t,e,n){"use strict";function a(){var t=this,e=t.$createElement,n=t._self._c||e;return n("f7-page",{attrs:{name:"nurse_booking__index",id:"nurse_booking__index"},on:{"page:beforein":t.onPageBeforeIn,"page:beforeout":t.onPageBeforeOut}},[n("f7-navbar",[n("tommy-nav-menu"),t._v(" "),n("f7-nav-title",[t._v(t._s(t.$t("nurse_booking.index.title","Nurse Booking")))])],1),t._v(" "),n("f7-swiper",{ref:"swiper",attrs:{pagination:""}},[n("f7-swiper-slide",{staticClass:"swiper-slide",style:"background-image: url("+t.$addonAssetUrl+"demo-slide.jpg)"}),t._v(" "),n("f7-swiper-slide",{staticClass:"swiper-slide",style:"background-image: url("+t.$addonAssetUrl+"demo-slide.jpg)"}),t._v(" "),n("f7-swiper-slide",{staticClass:"swiper-slide",style:"background-image: url("+t.$addonAssetUrl+"demo-slide.jpg)"})],1),t._v(" "),n("div",{staticClass:"sections"},[n("div",{staticClass:"section"},[n("a",{attrs:{href:"/nurse_booking/service-list/?category=Cleaning&masterDetailRoot=true","data-reload-detail":"true"}},[n("img",{attrs:{src:t.$addonAssetUrl+"icon-cleaning.svg"}}),t._v(" "),n("span",[t._v(t._s(t.$t("nurse_booking.index.cleaning_label","Cleaning")))])])]),t._v(" "),n("div",{staticClass:"section"},[n("a",{attrs:{href:"/nurse_booking/service-list/?category=Elderservice&masterDetailRoot=true","data-reload-detail":"true"}},[n("img",{attrs:{src:t.$addonAssetUrl+"icon-elderservice.svg"}}),t._v(" "),n("span",[t._v(t._s(t.$t("nurse_booking.index.elderservice_label","Elders Service")))])])]),t._v(" "),n("div",{staticClass:"section"},[n("a",{attrs:{href:"/nurse_booking/service-list/?category=Extras&masterDetailRoot=true","data-reload-detail":"true"}},[n("img",{attrs:{src:t.$addonAssetUrl+"icon-extras.svg"}}),t._v(" "),n("span",[t._v(t._s(t.$t("nurse_booking.index.extras_label","Accompany to Go Out")))])])]),t._v(" "),n("div",{staticClass:"section"},[n("a",{attrs:{href:"/nurse_booking/service-list/?category=Nursing&masterDetailRoot=true","data-reload-detail":"true"}},[n("img",{attrs:{src:t.$addonAssetUrl+"icon-nursing.svg"}}),t._v(" "),n("span",[t._v(t._s(t.$t("nurse_booking.index.nursing_label","Nursing")))])])]),t._v(" "),n("div",{staticClass:"section"},[n("a",{attrs:{href:"/nurse_booking/service-list/?category=Massage&masterDetailRoot=true","data-reload-detail":"true"}},[n("img",{attrs:{src:t.$addonAssetUrl+"icon-massage.svg"}}),t._v(" "),n("span",[t._v(t._s(t.$t("nurse_booking.index.massage_label","Massage")))])])]),t._v(" "),n("div",{staticClass:"section"},[n("a",{attrs:{href:"/nurse_booking/history/?masterDetailRoot=true","data-reload-detail":"true"}},[n("img",{attrs:{src:t.$addonAssetUrl+"icon-booking.svg"}}),t._v(" "),n("span",[t._v(t._s(t.$t("nurse_booking.index.booking_label","Booking")))])])]),t._v(" "),n("div",{staticClass:"section"},[n("a",{staticClass:"external",attrs:{href:"tommy://addon?package=wallet&back=true"}},[n("img",{attrs:{src:t.$addonAssetUrl+"icon-wallet.svg"}}),t._v(" "),n("span",[t._v(t._s(t.$t("nurse_booking.index.wallet_label","Wallet")))])])])])],1)}function o(t,e,n,a,o,s,r,i){var c,d="function"==typeof t?t.options:t;if(e&&(d.render=e,d.staticRenderFns=n,d._compiled=!0),a&&(d.functional=!0),s&&(d._scopeId="data-v-"+s),r?(c=function(t){(t=t||this.$vnode&&this.$vnode.ssrContext||this.parent&&this.parent.$vnode&&this.parent.$vnode.ssrContext)||"undefined"==typeof __VUE_SSR_CONTEXT__||(t=__VUE_SSR_CONTEXT__),o&&o.call(this,t),t&&t._registeredComponents&&t._registeredComponents.add(r)},d._ssrRegister=c):o&&(c=i?function(){o.call(this,this.$root.$options.shadowRoot)}:o),c)if(d.functional){d._injectStyles=c;var l=d.render;d.render=function(t,e){return c.call(e),l(t,e)}}else{var u=d.beforeCreate;d.beforeCreate=u?[].concat(u,c):[c]}return{exports:t,options:d}}n.r(e),a._withStripped=!0;var s=o({beforeDestroy:function(){this.$f7router.view.$navbarEl.removeClass("nurse-booking-index-navbar")},mounted:function(){var t=this;t.$refs.swiper&&t.$refs.swiper.swiper&&t.$nextTick((function(){t.$refs.swiper.swiper.update()}))},methods:{onPageBeforeIn:function(){this.$f7router.view.$navbarEl.addClass("nurse-booking-index-navbar")},onPageBeforeOut:function(){this.$f7router.view.$navbarEl.removeClass("nurse-booking-index-navbar")}}},a,[],!1,null,null,null);function r(){var t=this,e=t.$createElement,n=t._self._c||e;return n("f7-page",{attrs:{name:"nurse_booking__vip",id:"nurse_booking__vip"},on:{"page:beforein":t.onPageBeforeIn,"page:beforeout":t.onPageBeforeOut}},[n("f7-navbar",[n("tommy-nav-back")],1),t._v(" "),n("div",{staticClass:"vip-header"},[n("div",{staticClass:"avatar",style:"background-image: url("+t.$addonAssetsUrl+"demo-avatar.png"},[n("div",{staticClass:"medal medal-green"})]),t._v(" "),n("div",{staticClass:"name"},[t._v("Allen Zhang")])]),t._v(" "),n("div",{staticClass:"vip-info"},[t._v(t._s(t.$t("nurse_booking.vip.info")))]),t._v(" "),n("div",{staticClass:"vip-plans"},[n("a",{staticClass:"vip-plan vip-plan-green",attrs:{href:"/nurse_booking/vip-details/"}},[n("div",{staticClass:"vip-plan-badge"},[t._v(t._s(t.$t("nurse_booking.vip.current_plan_badge")))]),t._v(" "),n("div",{staticClass:"vip-plan-title"},[t._v(t._s(t.$t("nurse_booking.vip.plan_green")))])]),t._v(" "),n("a",{staticClass:"vip-plan vip-plan-gold",attrs:{href:"/nurse_booking/vip-details/"}},[n("div",{staticClass:"vip-plan-badge"},[t._v(t._s(t.$t("nurse_booking.vip.recommended_plan_badge")))]),t._v(" "),n("div",{staticClass:"vip-plan-title"},[t._v(t._s(t.$t("nurse_booking.vip.plan_gold")))])]),t._v(" "),n("a",{staticClass:"vip-plan vip-plan-platinum",attrs:{href:"/nurse_booking/vip-details/"}},[n("div",{staticClass:"vip-plan-title"},[t._v(t._s(t.$t("nurse_booking.vip.plan_platinum")))])])])],1)}s.options.__file="addons/nurse_booking/1.0.0/src/pages/index.vue";var i=s.exports;r._withStripped=!0;var c=o({beforeDestroy:function(){this.$f7router.view.$navbarEl.removeClass("nurse-booking-vip-navbar")},methods:{onPageBeforeIn:function(){this.$f7router.view.$navbarEl.addClass("nurse-booking-vip-navbar")},onPageBeforeOut:function(t,e){"previous"!==e.to&&this.$f7router.view.$navbarEl.removeClass("nurse-booking-vip-navbar")}}},r,[],!1,null,null,null);function d(){var t=this,e=t.$createElement,n=t._self._c||e;return n("f7-page",{attrs:{name:"nurse_booking__vip-details",id:"nurse_booking__vip-details"},on:{"page:beforein":t.onPageBeforeIn,"page:beforeout":t.onPageBeforeOut}},[n("f7-navbar",[n("tommy-nav-back")],1),t._v(" "),n("div",{staticClass:"vip-header"},[n("div",{staticClass:"avatar",style:"background-image: url("+t.$addonAssetsUrl+"demo-avatar.png"},[n("div",{staticClass:"medal medal-green"})]),t._v(" "),n("div",{staticClass:"name"},[t._v("Allen Zhang")])]),t._v(" "),n("div",{staticClass:"vip-plan-details"},[n("div",{staticClass:"vip-plan-current"},[t._v(t._s(t.$t("nurse_booking.vip.plan_green")))]),t._v(" "),n("div",{staticClass:"vip-plan-expiration"},[t._v("Expires 3rd April")])]),t._v(" "),n("div",{staticClass:"list vip-details-list"},[n("ul",[n("li",{staticClass:"item-divider"},[t._v(t._s(t.$t("nurse_booking.vip.details_plan_inclusion")))]),t._v(" "),n("li",{staticClass:"item-content"},[n("div",{staticClass:"item-inner"},[n("div",{staticClass:"item-title"},[n("div",[t._v("Nurse Visit")]),t._v(" "),n("div",{staticClass:"item-subtitle"},[n("b",[t._v("Four")]),t._v(" ("),n("b",[t._v("one")]),t._v(" time left) per month\n            ")])])])]),t._v(" "),n("li",{staticClass:"item-content"},[n("div",{staticClass:"item-inner"},[n("div",{staticClass:"item-title"},[n("div",[t._v("Clean")]),t._v(" "),n("div",{staticClass:"item-subtitle"},[n("b",[t._v("Four+One")]),t._v(" per month\n            ")])])])]),t._v(" "),n("li",{staticClass:"item-content"},[n("div",{staticClass:"item-inner"},[n("div",{staticClass:"item-title"},[n("div",[t._v("Massage")])])])]),t._v(" "),n("li",{staticClass:"item-divider"},[t._v(t._s(t.$t("nurse_booking.vip.details_administration")))]),t._v(" "),n("li",[n("a",{staticClass:"item-content item-link",attrs:{href:"#"}},[n("div",{staticClass:"item-inner"},[n("div",{staticClass:"item-title"},[t._v("Change Subscription")])])])]),t._v(" "),n("li",[n("a",{staticClass:"item-content item-link",attrs:{href:"#"}},[n("div",{staticClass:"item-inner"},[n("div",{staticClass:"item-title"},[t._v("Coupon")]),t._v(" "),n("div",{staticClass:"item-after"},[n("b",[t._v("4 Sheets")])])])])])])])],1)}c.options.__file="addons/nurse_booking/1.0.0/src/pages/vip.vue";var l=c.exports;d._withStripped=!0;var u=o({methods:{onPageBeforeIn:function(){},onPageBeforeOut:function(){}}},d,[],!1,null,null,null);function _(){var t=this,e=t.$createElement,n=t._self._c||e;return n("f7-page",{attrs:{name:"nurse_booking__service-list",id:"nurse_booking__service-list"}},[n("f7-navbar",[n("tommy-nav-back"),t._v(" "),n("f7-nav-title",[t._v(t._s(t.$t("nurse_booking.service_list."+t.category.toLowerCase()+"_title")))])],1),t._v(" "),t.services&&!t.services.length?n("div",{staticClass:"nurse_booking__empty-placeholder"},[t._v("\n    "+t._s(t.$t("nurse_booking.service_list.empty_label"))+"\n  ")]):t._e(),t._v(" "),t.services&&t.services.length?n("f7-swiper",{staticClass:"service-cards no-swipe-panel",attrs:{params:{centeredSlides:!0,slidesPerView:"auto",touchMoveStopPropagation:!1,on:{tap:t.onSlideClick}}}},t._l(t.services,(function(e){return n("f7-swiper-slide",{key:t.serviceType(e)+"-"+e.id,attrs:{"data-url":"/nurse_booking/service-details/"+e.id+"/?type="+t.serviceType(e)}},[n("a",{staticClass:"service-card",attrs:{href:"#"}},[n("div",{staticClass:"service-card-pic",style:"background-image:url("+t.serviceImage(e)+")"}),t._v(" "),n("div",{staticClass:"service-card-content"},[n("div",{staticClass:"service-card-title"},[t._v(t._s(e.name))]),t._v(" "),e.data&&e.data.duration?n("div",{staticClass:"service-card-duration"},[t._v(t._s(e.data.duration)+t._s(t.$t("nurse_booking.service_list.min_label")))]):t._e(),t._v(" "),e.coupons&&e.coupons.length?n("div",{staticClass:"service-card-coupons"},[t._v(t._s(e.coupons.length)+" "+t._s(t.$t("nurse_booking.service_list.coupons_label")))]):n("div",{staticClass:"service-card-price"},[t._v("¥ "+t._s(e.price))])])])])})),1):t._e()],1)}u.options.__file="addons/nurse_booking/1.0.0/src/pages/vip-details.vue";var v=u.exports;function p(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(t);e&&(a=a.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,a)}return n}function g(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function f(t){return function(t){if(Array.isArray(t)){for(var e=0,n=new Array(t.length);e<t.length;e++)n[e]=t[e];return n}}(t)||function(t){if(Symbol.iterator in Object(t)||"[object Arguments]"===Object.prototype.toString.call(t))return Array.from(t)}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}function m(){var t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},e=1<arguments.length&&void 0!==arguments[1]?arguments[1]:[],n=2<arguments.length?arguments[2]:void 0,a=!!t.package_products,o=e.filter((function(e){return null===e.vendor_product_id&&null===e.vendor_package_id&&(null===e.category||""===e.category)||e.category===t.category||t.category===$[e.category]||a&&e.vendor_package_id===t.id||!a&&e.vendor_product_id===t.id}));return o.filter((function(t){return!(t.max_uses&&t.use_count>=t.max_uses||t.user_id&&t.user_id!==n||t.valid_to&&(new Date).getTime()>new Date(t.valid_to).getTime())}))}_._withStripped=!0;var b=window.tommy,h=b.api,k=b.moment,y={cache:{services:[],coupons:[],locations:[],booking:{},nurse:{}},getServiceList:function(t){return Promise.all([h.call({endpoint:"vendors/".concat(t,"/products"),method:"GET",data:{}}),h.call({endpoint:"vendors/".concat(t,"/packages"),method:"GET",data:{}})]).then((function(t){var e=function(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){if(Symbol.iterator in Object(t)||"[object Arguments]"===Object.prototype.toString.call(t)){var n=[],a=!0,o=!1,s=void 0;try{for(var r,i=t[Symbol.iterator]();!(a=(r=i.next()).done)&&(n.push(r.value),!e||n.length!==e);a=!0);}catch(t){o=!0,s=t}finally{try{a||null==i.return||i.return()}finally{if(o)throw s}}return n}}(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}(t,2),n=e[0],a=e[1],o=[].concat(f(n),f(a)).filter((function(t){return t.active}));return y.cache.services=o}))},getServiceDetails:function(t,e,n){return h.call({endpoint:"vendors/".concat(t,"/").concat("Vendor::Product"===n?"products":"packages","/").concat(e),method:"GET"}).then((function(t){return t}))},getCouponList:function(t){return h.call({endpoint:"vendors/".concat(t,"/coupons"),method:"GET",data:{},cache:!1}).then((function(t){return y.cache.coupons=t}))},getLocations:function(){return h.call({endpoint:"addons/nurse_booking/install/settings/locations",method:"GET"}).then((function(t){return y.cache.locations=t&&t.data&&t.data.locations?t.data.locations:[],y.cache.locations}))},getNurseList:function(t,e,n){console.log("getNurseList @@@@@@@@@@@@@@@@",e,n,(new Date).getTimezoneOffset(),b.moment(new Date(e)).toISOString(!0));var a=k(new Date(e)).toISOString(!0),o=k(new Date(n)).toISOString(!0);return h.call({endpoint:"teams/".concat(t,"/members"),method:"GET",data:{tags:["Available For Work"],is_available_between:[a,o],timezone_offset:(new Date).getTimezoneOffset()},cache:!1}).then((function(t){return y.cache.nurses=(t||[]).filter((function(t){return!0===t.is_available})),y.cache.nurses}))},saveLocations:function(t){return t?y.cache.locations=t:t=y.cache.locations,h.call({endpoint:"addons/nurse_booking/install/settings/locations",method:"PUT",data:{data:JSON.stringify({locations:t})}}).then((function(t){return t.data.locations}))},addLocation:function(t){return t.default?(y.cache.locations.forEach((function(t){t.default=!1})),y.cache.locations.unshift(t)):y.cache.locations.push(t),y.saveLocations(y.cache.locations)},removeLocation:function(t){return y.cache.locations.splice(t,1),y.saveLocations(y.cache.locations)},createBookingEvent:function(t,e){var n,a=e.data.date;return"string"==typeof a&&(a=parseInt(a,10)),e.data.duration&&0<e.data.duration&&(n=a+60*parseInt(e.data.duration,10)*1e3),h.createEvent({addon:"nurse_booking",title:e.name,start_at:new Date(a).toJSON(),end_at:new Date(n).toJSON(),location:"".concat(e.data.location.city," ").concat(e.data.location.address),user_id:e.user_id,team_id:null,assignee_id:e.data.nurse.user_id,assignee_team_id:t,kind:"Booking",resource_id:e.id,resource_type:"VendorOrder"})},deleteBookingEvent:function(t){return h.getEvents({addon:"nurse_booking",kind:"Booking",resource_id:t,resource_type:"VendorOrder"}).then((function(t){return Promise.all(t.map((function(t){return h.deleteEvent(t.id)})))}))},setAvailabilityLock:function(t){var e=t.data.nurse.user_id,n=new Date(t.data.date),a=n.getHours();n.setHours(0,0,0,0),n=new Date(n.getTime()-60*n.getTimezoneOffset()*1e3);var o=new Date(n.getTime()-864e5),s=new Date(n.getTime()+864e5);return h.call({endpoint:"fragments?addon=availability&kind=Availability",data:{user_id:e,date_range:[o.toJSON(),s.toJSON()]}}).then((function(t){var o;t.forEach((function(t){new Date(t.start_at).toJSON()===n.toJSON()&&(o=t)}));var s={};return 7<=a&&a<13?s.lock_am=!0:13<=a&&a<22?s.lock_pm=!0:s.lock_nd=!0,o?(Object.assign(o.data,s),h.updateFragment(o.id,o)):h.createFragment({addon:"availability",kind:"Availability",data:JSON.stringify(function(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?p(Object(n),!0).forEach((function(e){g(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):p(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}({},s)),start_at:n.toJSON(),user_id:e})}))},deleteAvailabilityLock:function(t){var e=t.data.nurse.user_id,n=new Date(parseInt(t.data.date,10)),a=n.getHours();n.setHours(0,0,0,0),n=new Date(n.getTime()-60*n.getTimezoneOffset()*1e3);var o=new Date(n.getTime()-864e5),s=new Date(n.getTime()+864e5);return h.call({endpoint:"fragments?addon=availability&kind=Availability",data:{user_id:e,date_range:[o.toJSON(),s.toJSON()]}}).then((function(t){var e,o;return t.forEach((function(t){new Date(t.start_at).toJSON()===n.toJSON()&&(e=t)})),o=7<=a&&a<13?"lock_am":13<=a&&a<22?"lock_pm":"lock_nd",e&&e.data&&e.data[o]?(delete e.data[o],h.updateFragment(e.id,e)):Promise.resolve("nothing-to-remove")}))},sendOrder:function(t,e){return h.call({endpoint:"vendors/".concat(t,"/orders"),method:"POST",data:e})},updateOrder:function(t,e){return h.call({endpoint:"vendors/".concat(t,"/orders/").concat(e.id),method:"PUT",data:e})},getOrdersHistory:function(t){return h.call({endpoint:"vendors/".concat(t,"/orders/"),method:"GET",cache:!1}).then((function(t){return y.cache.orders=t}))},getOrderDetails:function(t,e){return h.call({endpoint:"vendors/".concat(t,"/orders/").concat(e,"?with_wallet_transaction=true"),method:"GET"}).then((function(t){return t}))},cancelOrder:function(t,e){return h.call({endpoint:"vendors/".concat(t,"/orders/").concat(e),method:"DELETE"})}},C=y,$={Massage:"按摩",Cleaning:"常规家政",Nursing:"护理",Elderservice:"老人家政",Extras:"外出陪同"};var w=o({data:function(){return{services:null,category:this.$f7route.query.category}},methods:{onSlideClick:function(t){var e=this.$$(t.target).closest(".swiper-slide").attr("data-url");e&&this.$f7router.navigate(e)},serviceType:function(t){return t.package_products?"package":"product"},serviceImage:function(t){return t.image_url?t.image_url:"".concat(this.$addonAssetsUrl,"demo-package.png")}},mounted:function(){var t=this;if(t.$f7route.query.masterDetailRoot){var e=t.$f7.navbar.getElByPage(t.$el);e&&t.$$(e).addClass("navbar-master-detail-root")}var n=t.$root.team?t.$root.team.id:t.$addons.addons.nurse_booking.data.nursing_team_id;Promise.all([C.getServiceList(n),C.getCouponList(n)]).then((function(e){var n=function(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){if(Symbol.iterator in Object(t)||"[object Arguments]"===Object.prototype.toString.call(t)){var n=[],a=!0,o=!1,s=void 0;try{for(var r,i=t[Symbol.iterator]();!(a=(r=i.next()).done)&&(n.push(r.value),!e||n.length!==e);a=!0);}catch(t){o=!0,s=t}finally{try{a||null==i.return||i.return()}finally{if(o)throw s}}return n}}(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}(e,2),a=n[0],o=n[1],s=a.filter((function(e){return e.category===t.category||e.category===$[t.category]}));s.forEach((function(e){e.coupons=m(e,o,t.$root.user.id)})),t.services=s}))}},_,[],!1,null,null,null);function D(){var t=this,e=t.$createElement,n=t._self._c||e;return n("f7-page",{attrs:{name:"nurse_booking__service-details",id:"nurse_booking__service-details"}},[n("f7-navbar",[n("tommy-nav-back"),t._v(" "),n("f7-nav-title",[t._v(t._s(t.service.name))])],1),t._v(" "),n("a",{staticClass:"nurse_booking__toolbar-button",attrs:{slot:"fixed"},on:{click:t.book},slot:"fixed"},[t._v(t._s(t.$t("nurse_booking.service_details.book_button")))]),t._v(" "),n("div",{staticClass:"service-details-header"},[n("f7-swiper",[n("div",{staticClass:"swiper-slide",style:"background-image: url("+t.serviceImage(t.service)+")"})])],1),t._v(" "),n("div",{staticClass:"service-details-meta"},[n("div",{staticClass:"service-details-meta-wrap"},[n("div",{staticClass:"service-details-meta-left"},[n("div",{staticClass:"service-details-title"},[t._v(t._s(t.service.name))]),t._v(" "),t.service.data&&t.service.data.duration?n("div",{staticClass:"service-details-duration"},[t._v(t._s(t.service.data.duration)+"min")]):t._e()]),t._v(" "),n("div",{staticClass:"service-details-price"},[t._v("¥ "+t._s(t.service.price))])]),t._v(" "),t.service.coupons&&t.service.coupons.length?n("a",{staticClass:"service-details-coupons-link",on:{click:t.chooseCoupon}},[n("span",[t._v(t._s(t.$t("nurse_booking.service_details.n_coupons_available",{n:t.service.coupons.length})))])]):t._e()]),t._v(" "),n("div",{staticClass:"service-details-content"},[n("div",{staticClass:"service-details-label"},[t._v(t._s(t.$t("nurse_booking.service_details.service_details_label"))+":")]),t._v(" "),n("div",{staticClass:"service-details-text"},[n("p",[t._v("\n        "+t._s(t.service.description)+"\n      ")])]),t._v(" "),t.products?n("div",{staticClass:"service-details-products"},t._l(t.products,(function(e){return n("div",{key:e.id,staticClass:"service-details-product"},[n("div",{staticClass:"service-details-product-image",style:"background-image: url("+t.serviceImage(e)+")"}),t._v(" "),n("div",{staticClass:"service-details-product-name"},[t._v(t._s(e.name))])])})),0):t._e()])],1)}w.options.__file="addons/nurse_booking/1.0.0/src/pages/service-list.vue";var O=w.exports;function S(t,e){var n=window.tommy.moment,a=n.utc(t).toDate();return n(a).format(e)}function E(t,e,n,a){var o=window.tommy.app.f7,s=e||[],r=t.map((function(t){return Object.assign({},t,{checked:s.some((function(e){return e.id===t.id}))})})),i='\n  <div class="nurse_booking-coupon-picker">\n    <div class="coupon-picker-img">\n      <img src="'.concat(P.addons.getAssetsUrl("nurse_booking"),'coupon-picker.svg" height="78">\n    </div>\n    <div class="coupon-picker-text">').concat(P.i18n.t("nurse_booking.coupon_picker.text"),'</div>\n    <div class="coupon-picker-items">\n      ').concat(r.map((function(t){return'\n      <label>\n        <input type="checkbox" name="nurse_booking-coupon-picker-radio" value="'.concat(t.id,'" ').concat(t.checked?"checked":"",'>\n        <div class="coupon-item-content">\n          ').concat("percentage"!==t.kind?'\n          <div class="coupon-item-title">¥ '.concat(t.amount,"</div>\n          "):'\n          <div class="coupon-item-title">'.concat(100*t.amount,"%</div>\n          "),'\n          <div class="coupon-item-name">').concat(t.name,"</div>\n          ").concat(t.expires_at||t.valid_to?'\n          <div class="coupon-item-date">'.concat(S(t.expires_at||t.valid_to,"D MMM YYYY"),"</div>\n          "):"",'\n        </div>\n        <div class="coupon-item-label">').concat(P.i18n.t("nurse_booking.coupon_picker.use_label"),"</div>\n      </label>\n      ").trim()})).join(""),"\n    </div>\n  </div>\n  ").trim(),c=o.dialog.create({content:i,cssClass:"nurse_booking-coupon-picker-modal",buttons:[{text:P.i18n.t("nurse_booking.coupon_picker.skip_button","Skip"),onClick:function(){a&&a()}},{text:P.i18n.t("nurse_booking.coupon_picker.confirm_button","Confirm"),bold:!0,onClick:function(){n&&n(s)}}]}).open().$el;c.find(".dialog-button-bold").addClass("dialog-button-disabled"),c.find("input").on("change",(function(e){c.find(".dialog-button-bold").removeClass("dialog-button-disabled");var n=parseInt(e.target.value,10),a=t.find((function(t){return t.id===n}));e.target.checked?s.push(a):s.splice(s.findIndex((function(t){return t.id===n})),1)}))}D._withStripped=!0;var P=window.tommy,x=o({props:{id:[Number,String]},data:function(){var t=this,e=t.$f7route.query.type||"product",n={},a=null;return(C.cache.services||[]).forEach((function(a){var o=a.package_products?"package":"product";a.id===parseInt(t.id,10)&&o===e&&((n=a).coupons=m(n,C.cache.coupons,t.$root.user.id))})),n.package_products&&n.package_products.length&&(a=n.package_products.map((function(t){return(C.cache.services||[]).find((function(e){return e.id===t.product_id&&!e.package_products}))}))),{service:n,selectedCoupons:[],type:e,products:a}},mounted:function(){},methods:{serviceImage:function(t){return t.image_url?t.image_url:"".concat(this.$addonAssetsUrl,"demo-package.png")},book:function(){var t=this,e=t.service;C.cache.booking.services=[e],C.cache.booking.serviceType=t.type,e.coupons&&e.coupons.length?E(e.coupons,t.selectedCoupons,(function(n){C.cache.booking.services=[e],C.cache.booking.coupons=t.selectedCoupons,t.$f7router.navigate("/nurse_booking/order-select-location/")}),(function(){C.cache.booking.coupon=null,delete C.cache.booking.coupons,t.selectedCoupons=[],t.$f7router.navigate("/nurse_booking/order-select-location/")})):(C.cache.booking.coupon=null,delete C.cache.booking.coupons,t.selectedCoupons=[],t.$f7router.navigate("/nurse_booking/order-select-location/"))},chooseCoupon:function(){var t=this;E(t.service.coupons,t.selectedCoupons,(function(e){C.cache.booking.services=[t.service],C.cache.booking.coupons=t.selectedCoupons,t.$f7router.navigate("/nurse_booking/order-select-location/")}),(function(){t.selectedCoupons=[]}))}}},D,[],!1,null,null,null);function I(){var t=this,e=t.$createElement,n=t._self._c||e;return n("f7-page",{attrs:{name:"nurse_booking__location",id:"nurse_booking__location"}},[n("f7-navbar",[n("tommy-nav-back"),t._v(" "),n("f7-nav-title",[t._v(t._s(t.$t("nurse_booking.location.title")))])],1),t._v(" "),t._l(t.locations,(function(e,a){return t.locations&&t.locations.length?n("div",{key:a,staticClass:"location-card"},[n("i",{staticClass:"location-card-icon"}),t._v(" "),n("div",{staticClass:"location-card-title"},[e.default?n("span",{staticClass:"location-card-default-badge"},[t._v("["+t._s(t.$t("nurse_booking.location.default_label"))+"]")]):t._e(),t._v("\n      "+t._s(e.city)+" "+t._s(e.address)+"\n    ")]),t._v(" "),n("a",{staticClass:"location-delete-button",attrs:{href:"#"},on:{click:function(n){return t.deleteLocation(e,a)}}}),t._v(" "),n("a",{staticClass:"location-card-button location-select-button",attrs:{href:"#"},on:{click:function(n){return t.selectLocation(e,a)}}},[t._v(t._s(t.$t("nurse_booking.location.select_button")))])]):t._e()})),t._v(" "),t.addMode||t.locations&&!t.locations.length?n("div",{staticClass:"location-card location-add-form"},[n("input",{attrs:{type:"text",placeholder:t.$t("nurse_booking.location.city_placeholder")},domProps:{value:t.city},on:{input:function(e){t.city=e.target.value}}}),t._v(" "),n("textarea",{attrs:{type:"text",placeholder:t.$t("nurse_booking.location.address_placeholder")},domProps:{value:t.address},on:{input:function(e){t.address=e.target.value}}}),t._v(" "),n("label",[n("input",{attrs:{type:"checkbox",name:"default"},domProps:{checked:t.isDefault},on:{change:function(e){t.isDefault=e.target.checked}}}),t._v(" "),n("i",{staticClass:"framework7-icons"},[t._v("check")]),t._v(" "),n("span",[t._v(t._s(t.$t("nurse_booking.location.set_default_label")))])]),t._v(" "),n("a",{staticClass:"location-card-button location-save-button",attrs:{href:"#"},on:{click:function(e){return t.saveLocation()}}},[t._v(t._s(t.$t("nurse_booking.location.save_button")))])]):t._e(),t._v(" "),t.locations&&t.locations.length?n("a",{staticClass:"location-add-button",attrs:{href:"#"},on:{click:function(e){return t.addLocation()}}},[t._v(t._s(t.$t("nurse_booking.location.add_button")))]):t._e()],2)}x.options.__file="addons/nurse_booking/1.0.0/src/pages/service-details.vue";var A=x.exports;function T(t){return function(t){if(Array.isArray(t)){for(var e=0,n=new Array(t.length);e<t.length;e++)n[e]=t[e];return n}}(t)||function(t){if(Symbol.iterator in Object(t)||"[object Arguments]"===Object.prototype.toString.call(t))return Array.from(t)}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}I._withStripped=!0;var j=o({data:function(){return{service:C.cache.booking.services[0],locations:null,addMode:!1,city:this.$root.user.location||this.$root.user.city||"",address:this.$root.user.address||"",isDefault:!1}},mounted:function(){var t=this;C.getLocations().then((function(){t.locations=T(C.cache.locations||[])}))},methods:{deleteLocation:function(t,e){var n=this;C.removeLocation(e).then((function(){n.locations.splice(e,1)}))},selectLocation:function(t){var e=this,n=t.city,a=t.address;0<=n.indexOf("山缘")||0<=a.indexOf("山缘")?(C.cache.booking.location=t,e.$f7route.query.back?e.$f7router.back():e.$f7router.navigate("/nurse_booking/order-select-date/")):e.$f7.dialog.alert(e.$t("nurse_booking.location.not_available"))},saveLocation:function(){var t=this,e=t.city,n=t.address,a=t.isDefault;e&&n&&C.addLocation({city:e,address:n,default:a}).then((function(){t.locations=T(C.cache.locations||[]),t.addMode=!1,t.city="",t.address="",t.isDefault=!1}))},addLocation:function(){this.addMode=!0}}},I,[],!1,null,null,null);function M(){var t=this,e=t.$createElement,n=t._self._c||e;return n("f7-page",{attrs:{name:"nurse_booking__date-time",id:"nurse_booking__date-time"}},[n("f7-navbar",[n("tommy-nav-back"),t._v(" "),n("f7-nav-title",[t._v(t._s(t.$t("nurse_booking.date_time.title")))])],1),t._v(" "),n("a",{staticClass:"nurse_booking__toolbar-button",class:{disabled:!t.selectedDate||!t.selectedHours},attrs:{slot:"fixed",href:"#"},on:{click:t.selectDateTime},slot:"fixed"},[t._v(t._s(t.$t("nurse_booking.date_time.determine_button")))]),t._v(" "),n("div",{staticClass:"date-time-dates"},t._l(t.dates,(function(e,a){return n("label",{key:a,staticClass:"date-time-date",class:{"date-time-date-disabled":e.disabled}},[n("input",{attrs:{type:"radio",disabled:e.disabled},domProps:{checked:t.selectedDate===e.value},on:{change:function(n){t.selectedDate=e.value}}}),t._v(" "),n("div",{staticClass:"date-time-date-num"},[t._v(t._s(e.day)+"."+t._s(e.month))]),t._v(" "),e.today?n("div",{staticClass:"date-time-date-day"},[t._v("Today")]):n("div",{staticClass:"date-time-date-day"},[t._v(t._s(e.weekDay))])])})),0),t._v(" "),n("div",{staticClass:"date-time-hours"},t._l(t.hours,(function(e,a){return n("label",{key:a,staticClass:"date-time-hour",class:{disabled:e.disabled}},[n("input",{attrs:{type:"radio",disabled:e.disabled},domProps:{checked:t.selectedHours===e.value},on:{change:function(n){t.selectedHours=e.value}}}),t._v(" "),n("span",[t._v(t._s(e.hour))])])})),0)],1)}j.options.__file="addons/nurse_booking/1.0.0/src/pages/order-select-location.vue";var Y=j.exports;M._withStripped=!0;var B=o({data:function(){for(var t,e=new Date,n=e.getTime(),a=[],o=0;o<=13;o+=1){var s=new Date(n+24*o*60*60*1e3),r=s.getMonth()+1,i=s.getDate();i<10&&(i="0".concat(i)),r<10&&(r="0".concat(r));var c=s.getDay(),d=0===o&&19<=e.getHours();d&&(t=!0),a.push({disabled:d,value:new Date(s.getFullYear(),s.getMonth(),s.getDate()).getTime(),day:i,month:r,weekDay:this.$t("nurse_booking.date_time.week_days.".concat(c))})}var l,u,_=this.$f7route.query.date&&new Date(parseInt(this.$f7route.query.date,10));return _&&(l=new Date(_.getFullYear(),_.getMonth(),_.getDate()).getTime(),u=_.getHours()),{dates:a,selectedDate:l||(t?a[1].value:a[0].value),selectedHours:u||null}},watch:{selectedDate:function(){this.selectedHours=null}},computed:{hours:function(){var t,e=new Date(this.selectedDate),n=[],a=new Date;a.getFullYear()===e.getFullYear()&&a.getMonth()===e.getMonth()&&a.getDate()===e.getDate()&&(t=!0);for(var o=10;o<=19;o+=1){var s=!!t&&a.getHours()>=o;n.push({value:o,disabled:s,hour:"".concat(o,":00")})}return n}},methods:{selectDateTime:function(){var t=this,e=t.selectedDate,n=t.selectedHours;C.cache.booking.date=new Date(parseInt(e,10)).getTime()+60*n*60*1e3,console.log("booking.date, @@@@@@@@@@@@@@@@@@@@@",t.selectedDate,t.selectedHours,C.cache.booking.date),t.$f7route.query.back?t.$f7router.back():t.$f7router.navigate("/nurse_booking/order-select-nurse/")}}},M,[],!1,null,null,null);function N(){var t=this,e=t.$createElement,n=t._self._c||e;return n("f7-page",{attrs:{name:"nurse_booking__nurse-list",id:"nurse_booking__nurse-list"}},[n("f7-navbar",[n("tommy-nav-back"),t._v(" "),n("f7-nav-title",[t._v(t._s(t.$t("nurse_booking.nurse_list.title")))])],1),t._v(" "),t.nurses?n("div",{staticClass:"nurse-list"},[n("ul",t._l(t.nurses,(function(e){return n("li",{key:e.id,class:{"nurse-selected":t.selectedNurseId===e.user_id}},[n("a",{staticClass:"nurse-content-wrap",on:{click:function(n){return t.selectNurse(e)}}},[n("div",{staticClass:"nurse-media",style:"background-image: url("+(e.icon_url||"")+")"}),t._v(" "),n("div",{staticClass:"nurse-content"},[n("div",{staticClass:"nurse-name"},[t._v(t._s(e.last_name)+" "+t._s(e.first_name))])])])])})),0)]):t._e()],1)}B.options.__file="addons/nurse_booking/1.0.0/src/pages/order-select-date.vue";var L=B.exports;N._withStripped=!0;var U=o({data:function(){return{nurses:null,selectedNurseId:this.$f7route.query.nurse_id?parseInt(this.$f7route.query.nurse_id,10):void 0}},mounted:function(){var t=this,e=t.$root.team?t.$root.team.id:t.$addons.addons.nurse_booking.data.nursing_team_id,n=C.cache.booking.date,a=n+36e5;if(C.cache.booking.services&&C.cache.booking.services.length){var o=0;C.cache.booking.services.forEach((function(t){t.data&&t.data.duration&&(o+=parseInt(t.data.duration,10))})),o&&(a=n+6e4*o)}C.getNurseList(e,new Date(n),new Date(a)).then((function(e){return t.nurses=e}))},methods:{selectNurse:function(t){this.selectedNurseId=t.user_id,C.cache.booking.nurse=t,this.$f7route.query.back?this.$f7router.back():this.$f7router.navigate("/nurse_booking/order-confirm/")}}},N,[],!1,null,null,null);function H(){var t=this,e=t.$createElement,n=t._self._c||e;return n("f7-page",{attrs:{name:"nurse_booking__order-confirm",id:"nurse_booking__order-confirm"},on:{"page:beforein":t.onPageBeforeIn}},[n("f7-navbar",[n("tommy-nav-back"),t._v(" "),n("f7-nav-title",[t._v(t._s(t.$t("nurse_booking.order_confirm.title")))])],1),t._v(" "),n("a",{staticClass:"nurse_booking__toolbar-button service-book-button",attrs:{slot:"fixed",href:"#"},on:{click:t.payOrder},slot:"fixed"},[t._v(t._s(t.$t("nurse_booking.order_confirm.pay_button")))]),t._v(" "),n("div",{staticClass:"service-details-block"},[n("div",{staticClass:"service-image",style:"background-image: url("+t.serviceImage+")"}),t._v(" "),n("div",{staticClass:"service-details"},[n("div",{staticClass:"service-title"},[t._v(t._s(t.serviceName))]),t._v(" "),n("div",{staticClass:"service-price"},[t._v("¥"+t._s(t.servicePrice))])])]),t._v(" "),n("f7-list",{attrs:{"no-hairlines":""}},[t.nurse?n("f7-list-item",{attrs:{title:t.nurse.last_name+" "+t.nurse.first_name,link:"/nurse_booking/order-select-nurse/?nurse_id="+t.nurse.id+"&back=true"}},[n("img",{attrs:{slot:"media",src:t.$addonAssetsUrl+"icon-nurse.svg"},slot:"media"})]):t._e(),t._v(" "),n("f7-list-item",{attrs:{title:t.formatDate(t.date,"MMMM D, YYYY HH:mm"),link:"/nurse_booking/order-select-date/?date="+new Date(t.date).getTime()+"&back=true"}},[n("img",{attrs:{slot:"media",src:t.$addonAssetsUrl+"icon-time.svg"},slot:"media"})])],1),t._v(" "),n("f7-list",{attrs:{"no-hairlines":""}},[n("f7-list-item",{attrs:{title:t.user.first_name+" "+t.user.last_name}},[n("img",{attrs:{slot:"media",src:t.$addonAssetsUrl+"icon-user.svg"},slot:"media"})]),t._v(" "),t.user.mobile?n("f7-list-item",{attrs:{title:t.user.mobile}},[n("img",{attrs:{slot:"media",src:t.$addonAssetsUrl+"icon-phone.svg"},slot:"media"})]):t._e(),t._v(" "),n("f7-list-item",{attrs:{link:"/nurse_booking/order-select-location/?back=true"}},[n("span",{staticClass:"location-default-badge",attrs:{slot:"title"},slot:"title"},[t._v("["+t._s(t.$t("nurse_booking.location.default_label"))+"]")]),t._v(" "),n("span",{attrs:{slot:"title"},slot:"title"},[t._v(t._s(t.location.city)+" "+t._s(t.location.address))]),t._v(" "),n("img",{attrs:{slot:"media",src:t.$addonAssetsUrl+"icon-location.svg"},slot:"media"})])],1),t._v(" "),n("f7-list",{staticClass:"list-prices",attrs:{"no-hairlines":""}},[t.coupons&&t.coupons.length?n("f7-list-item",{attrs:{link:"#",title:t.$t("nurse_booking.order_confirm.coupons_label"),after:"-¥ "+t.couponDiscount},on:{click:t.selectCoupon}}):t._e(),t._v(" "),n("f7-list-item",{staticClass:"item-total-price",attrs:{title:t.$t("nurse_booking.order_confirm.total_label"),after:"¥"+t.total}})],1)],1)}U.options.__file="addons/nurse_booking/1.0.0/src/pages/order-select-nurse.vue";var q=U.exports;function R(t){var e=t.services,n=0;return e.forEach((function(t){n+=t.price})),n}function J(t){var e=t.coupons,n=(t.services,R(t)),a=0;return e&&e.forEach((function(t){a+="percentage"!==t.kind?t.amount:t.amount*n})),n<a&&(a=n),a}function V(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(t);e&&(a=a.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,a)}return n}function F(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function G(t){var e=!(1<arguments.length&&void 0!==arguments[1])||arguments[1];if(!z){var n,a;z=!0;var o,s=window.tommy,r=s.moment,i=s.app.f7,c=t.teamId,d=t.productName,l=t.total,u=t.discount,_=void 0===u?0:u,v=t.location,p=t.date,g=t.couponIds,f=t.orderId,m=t.nurse,b=t.vendor_order_items_attributes,h=t.duration,k="/nurse_booking/order-success/",y="/nurse_booking/order-error/",$={vendor_order_items_attributes:b,vendor_coupon_ids:g,name:d,status:"pending",team_id:c,assignee_id:m.user_id,assignee_team_id:c,data:{location:v,date:p,nurse:m,duration:h},discount:_,total:l},w=$.data.date;"string"==typeof w&&(w=parseInt(w,10)),o=$.data.duration&&0<$.data.duration?w+60*parseInt($.data.duration,10)*1e3:w+36e5;var D=r(w).format("YYYY-MM-DDTHH:mm:ss"),O=r(o).format("YYYY-MM-DDTHH:mm:ss");$.workforce_shift_attributes={event_attributes:{title:$.name,location_name:$.data.location.city,address:$.data.location.address,details:d,start_at:D,end_at:O}},e?C.sendOrder(c,$).then(S).catch((function(){z=!1})):S(function(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?V(Object(n),!0).forEach((function(e){F(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):V(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}({id:f},$))}function S(t){if(0===l)return C.cache.booking.transaction={},t.status="paid",void C.updateOrder(c,t).then((function(){z=!1,i.views.main.router.navigate("".concat(k,"?id=").concat(t.id))})).catch((function(){z=!1}));s.initWalletTransaction({addon:"nurse_booking",payee_name:d,currency:"CNY",amount:l,order_id:t.id},(function(e){var o=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{};n=!(z=!1),a||(C.cache.booking.transaction=e,t.status="paid",t.wallet_transaction_id=e.id,t.payment_method=o.paymentMethod||"card",t.data.payment_method=o.paymentMethod||"card",C.updateOrder(c,t).then((function(){i.views.main.router.navigate("".concat(k,"?id=").concat(t.id))})).catch((function(){z=!1})))}),(function(e){a=!(z=!1),n||C.cancelOrder(c,t.id).then((function(){i.views.main.router.navigate("".concat(y,"?id=").concat(t.id))})).catch((function(){i.views.main.router.navigate("".concat(y,"?id=").concat(t.id))}))}))}}var z=!(H._withStripped=!0),W=o({data:function(){return{services:C.cache.booking.services,coupons:C.cache.booking.coupons,user:this.$root.user,location:C.cache.booking.location,date:C.cache.booking.date,nurse:C.cache.booking.nurse}},computed:{monies:function(){return function(t){return{subtotal:R(t),discount:J(t),total:(e=t,Math.max(R(e)-J(e),0))};var e}(this)},couponDiscount:function(){return this.monies.discount},total:function(){return this.monies.total},servicePrice:function(){return this.monies.subtotal},serviceImage:function(){var t=this.services[0];return t.image_url?t.image_url:"".concat(this.$addonAssetsUrl,"demo-package.png")},serviceName:function(){return this.services.map((function(t){return t.name})).join(", ")}},methods:{formatDate:S,selectCoupon:function(){E(this.services[0].coupons,this.coupons,(function(t){}),(function(){}))},onPageBeforeIn:function(t,e){"previous"===e.from&&(this.location=C.cache.booking.location,this.date=C.cache.booking.date,this.nurse=C.cache.booking.nurse)},payOrder:function(){var t=this,e=t.services,n=t.coupons,a=t.location,o=t.date,s=t.total,r=t.nurse,i=t.services.map((function(t){return{orderable_id:t.id,orderable_type:t.package_products?"Vendor::Package":"Vendor::Product",quantity:t.quantity||1}})),c=t.$root.team?t.$root.team.id:t.$addons.addons.nurse_booking.data.nursing_team_id,d=0;e.forEach((function(t){t.data&&t.data.duration&&(d+=parseInt(t.data.duration,10))})),d=d||60;var l=t.couponDiscount;G({vendor_order_items_attributes:i,teamId:c,productName:e.map((function(t){return t.name})).join(", "),productId:e[0].id,total:s,couponIds:n?n.map((function(t){return t.id})):null,discount:l,location:a,date:o,nurse:r,duration:d})}}},H,[],!1,null,null,null);function K(){var t=this,e=t.$createElement,n=t._self._c||e;return n("f7-page",{attrs:{name:"nurse_booking__order-details",id:"nurse_booking__order-details"}},[n("f7-navbar",[t.$f7route.query.backToHome?n("tommy-nav-back",{attrs:{href:"/nurse_booking/",force:""}}):n("tommy-nav-back"),t._v(" "),n("f7-nav-title",[t._v(t._s(t.$t("nurse_booking.order_details.title")))])],1),t._v(" "),t.status?[t.status.canceled?n("div",{staticClass:"order-details-status"},[n("div",{staticClass:"order-details-status-title"},[t._v(t._s(t.$t("nurse_booking.order_details.status_canceled")))]),t._v(" "),n("div",{staticClass:"order-details-status-date"},[t._v(t._s(t.formatDate(t.date,"D MMM. YYYY")))]),t._v(" "),n("img",{attrs:{src:t.$addonAssetsUrl+"icon-status-canceled.svg"}})]):t._e(),t._v(" "),t.status.pending?n("div",{staticClass:"order-details-status"},[n("div",{staticClass:"order-details-status-title"},[t._v(t._s(t.$t("nurse_booking.order_details.status_pending")))]),t._v(" "),n("div",{staticClass:"order-details-status-date"},[t._v(t._s(t.formatDate(t.date,"D MMM. YYYY")))]),t._v(" "),n("img",{attrs:{src:t.$addonAssetsUrl+"icon-status-pending.svg"}})]):t._e(),t._v(" "),t.status.progress?n("div",{staticClass:"order-details-status"},[n("div",{staticClass:"order-details-status-title"},[t._v(t._s(t.$t("nurse_booking.order_details.status_progress")))]),t._v(" "),n("div",{staticClass:"order-details-status-date"},[t._v(t._s(t.formatDate(t.date,"D MMM. YYYY")))]),t._v(" "),n("img",{attrs:{src:t.$addonAssetsUrl+"icon-status-progress.svg"}})]):t._e(),t._v(" "),t.status.complete?n("div",{staticClass:"order-details-status"},[n("div",{staticClass:"order-details-status-title"},[t._v(t._s(t.$t("nurse_booking.order_details.status_complete")))]),t._v(" "),n("div",{staticClass:"order-details-status-date"},[t._v(t._s(t.formatDate(t.date,"D MMM. YYYY")))]),t._v(" "),n("img",{attrs:{src:t.$addonAssetsUrl+"icon-status-complete.svg"}})]):t._e()]:t._e(),t._v(" "),t.services?n("f7-list",{staticClass:"order-details-list",attrs:{"no-hairlines":""}},[t.nurse?n("f7-list-item",{attrs:{title:t.nurse.first_name+" "+t.nurse.last_name}},[n("span",{staticClass:"order-details-list-nurse-avatar",style:"background-image: url("+(t.nurse.icon_url||"")+")",attrs:{slot:"media"},slot:"media"})]):t._e(),t._v(" "),n("f7-list-item",{attrs:{title:t.$t("nurse_booking.order_details.service_label")+":",after:t.serviceName}}),t._v(" "),n("f7-list-item",{attrs:{title:t.$t("nurse_booking.order_details.time_label")+":",after:t.formatDate(t.date,"MMMM D, YYYY HH:mm")}}),t._v(" "),t.discount?n("li",{staticClass:"item-content item-total-price"},[n("div",{staticClass:"item-inner"},[n("div",{staticClass:"item-title"},[t._v(t._s(t.$t("nurse_booking.order_details.coupons_label"))+":")]),t._v(" "),n("div",{staticClass:"item-after price"},[t._v("¥"+t._s(t.discount))])])]):t._e(),t._v(" "),n("li",{staticClass:"item-content item-total-price"},[n("div",{staticClass:"item-inner"},[n("div",{staticClass:"item-title"},[t._v(t._s(t.$t("nurse_booking.order_details.total_label"))+":")]),t._v(" "),n("div",{staticClass:"item-after price"},[t._v("¥"+t._s(t.total))])])]),t._v(" "),n("f7-list-item",{staticClass:"item-total-price",attrs:{title:t.$t("nurse_booking.order_details.payment_label")+":",after:t.transaction&&t.transaction.card_name?t.transaction.card_name:null}}),t._v(" "),t.status?[t.status.pending?n("a",{staticClass:"order-details-red-button",attrs:{href:"#"},on:{click:t.payOrder}},[t._v(t._s(t.$t("nurse_booking.order_details.pay_button")))]):t._e(),t._v(" "),t.status.complete||t.status.canceled?n("a",{staticClass:"order-details-red-button",attrs:{href:"#"},on:{click:t.repeatOrder}},[t._v(t._s(t.$t("nurse_booking.order_details.repeat_button")))]):t._e(),t._v(" "),t.status.pending||t.status.progress?n("a",{staticClass:"order-details-white-button",attrs:{href:"#"},on:{click:t.cancelOrder}},[t._v(t._s(t.$t("nurse_booking.order_details.cancel_button")))]):t._e()]:t._e()],2):t._e()],2)}W.options.__file="addons/nurse_booking/1.0.0/src/pages/order-confirm.vue";var X=W.exports;K._withStripped=!0;var Z=o({data:function(){var t=C.cache.booking,e=t.transaction,n=t.services,a=t.coupons,o=t.location,s=t.date,r=t.nurse,i={teamId:this.$root.team?this.$root.team.id:this.$addons.addons.nurse_booking.data.nursing_team_id,transaction:null,services:null,coupons:null,location:null,date:null,order:null,status:null,total:null,preventCancel:!1,nurse:null};return this.$f7route.query.id||Object.assign(i,{transaction:e,services:n,coupons:a,location:o,date:s,nurse:r}),i},computed:{serviceName:function(){return this.services.map((function(t){return t.name})).join(", ")}},mounted:function(){var t=this;if(t.$f7route.query.masterDetailRoot){var e=t.$f7.navbar.getElByPage(t.$el);e&&t.$$(e).addClass("navbar-master-detail-root")}t.$f7route.query.id&&C.getOrderDetails(t.teamId,t.$f7route.query.id).then((function(e){var n=(t.order=e).canceled;t.status={pending:!n&&"pending"===e.status,canceled:n,progress:!n&&("paid"===e.status||"processing"===e.status),complete:!n&&"complete"===e.status},t.date=parseInt(e.data.date,10),t.nurse=e.data.nurse,t.transaction={card_name:e.wallet_transaction?e.wallet_transaction.card_name:null},t.discount=e.discount,t.total=e.total,Promise.all(e.vendor_order_items.map((function(e){return C.getServiceDetails(t.teamId,e.orderable_id,e.orderable_type).then((function(t){return t.quantity=e.quantity,Promise.resolve(t)}))}))).then((function(e){t.services=e}))}))},methods:{formatDate:S,repeatOrder:function(){var t=this.order,e=this.services;t&&(C.cache.booking.date=parseInt(t.data.date,10),C.cache.booking.location=t.data.location,C.cache.booking.nurse=t.data.nurse,C.cache.booking.vendor_order_items_attributes=t.vendor_order_items.map((function(t){return{vendor_product_id:t.vendor_product_id,orderable_id:t.vendor_product_id,orderable_type:t.package_products?"Vendor::Package":"Vendor::Product",quantity:t.quantity}})),delete C.cache.booking.coupons,C.cache.booking.services=e,this.$f7router.navigate("/nurse_booking/order-confirm/"))},cancelOrder:function(){var t=this,e=t.order;e&&(t.preventCancel||(t.preventCancel=!0,t.$f7.dialog.confirm('\n        <div class="order-details-cancel-order-icon"></div>\n        <div>'.concat(t.$t("nurse_booking.order_details.cancel_confirm"),"</div>\n        "),(function(){C.cancelOrder(t.teamId,e.id,e.wallet_transaction_id,e).then((function(){t.preventCancel=!1,t.$f7router.navigate("/nurse_booking/order-canceled/")})).catch((function(){t.preventCancel=!1}))}),(function(){t.preventCancel=!1}))))},payOrder:function(){var t=this.order;G({teamId:this.teamId,vendor_order_items_attributes:(t.vendor_order_items||[]).map((function(t){return{orderable_id:t.vendor_product_id,orderable_type:t.package_products?"Vendor::Package":"Vendor::Product",quantity:t.quantity}})),orderId:t.id,productName:t.name,productId:t.vendor_product_id||t.vendor_order_items[0],total:t.total,couponsIds:t.vendor_coupons_ids,discount:t.discount,location:t.data.location,date:t.data.date,nurse:t.data.nurse,duration:t.data.duration},!1)}}},K,[],!1,null,null,null);function Q(){var t=this,e=t.$createElement,n=t._self._c||e;return n("f7-page",{attrs:{name:"nurse_booking__order-canceled",id:"nurse_booking__order-canceled","no-navbar":""}},[n("div",{staticClass:"order-status-title"},[t._v(t._s(t.$t("nurse_booking.order_canceled.title")))]),t._v(" "),n("div",{staticClass:"order-status-img"},[n("img",{attrs:{src:t.$addonAssetsUrl+"order-canceled.svg"}})]),t._v(" "),n("div",{staticClass:"order-status-message"},[t._v(t._s(t.$t("nurse_booking.order_canceled.message")))]),t._v(" "),n("div",{staticClass:"order-status-buttons no-master-detail"},[n("a",{attrs:{href:"/nurse_booking/","data-clear-previous-history":"true"}},[t._v(t._s(t.$t("nurse_booking.order_canceled.home_button")))])])])}Z.options.__file="addons/nurse_booking/1.0.0/src/pages/order-details.vue";var tt=Z.exports;Q._withStripped=!0;var et=o({mounted:function(){document.addEventListener("backbutton",this.onBackButton)},beforeDestroy:function(){document.removeEventListener("backbutton",this.onBackButton)},methods:{onBackButton:function(){this.$f7router.back("/nurse_booking/",{force:!0})},onPageAfterIn:function(){var t=this;setTimeout((function(){t.$f7router.clearPreviousHistory()}),500)}}},Q,[],!1,null,null,null);function nt(){var t=this,e=t.$createElement,n=t._self._c||e;return n("f7-page",{attrs:{name:"nurse_booking__order-error",id:"nurse_booking__order-error","no-navbar":""}},[n("div",{staticClass:"order-status-title"},[t._v(t._s(t.$t("nurse_booking.order_error.title")))]),t._v(" "),n("div",{staticClass:"order-status-img"},[n("img",{attrs:{src:t.$addonAssetsUrl+"order-success.svg"}})]),t._v(" "),n("div",{staticClass:"order-status-buttons"},[n("a",{attrs:{href:"/nurse_booking/order-details/?backToHome=true&id="+t.$f7route.query.id+"&masterDetailRoot=true"}},[t._v(t._s(t.$t("nurse_booking.order_error.details_button")))]),t._v(" "),n("a",{staticClass:"no-master-detail",attrs:{href:"/nurse_booking/","data-clear-previous-history":"true"}},[t._v(t._s(t.$t("nurse_booking.order_error.home_button")))])])])}et.options.__file="addons/nurse_booking/1.0.0/src/pages/order-canceled.vue";var at=et.exports;nt._withStripped=!0;var ot=o({mounted:function(){document.addEventListener("backbutton",this.onBackButton)},beforeDestroy:function(){document.removeEventListener("backbutton",this.onBackButton)},methods:{onBackButton:function(){this.$f7router.back("/nurse_booking/",{force:!0})},onPageAfterIn:function(){var t=this;setTimeout((function(){t.$f7router.clearPreviousHistory()}),500)}}},nt,[],!1,null,null,null);function st(){var t=this,e=t.$createElement,n=t._self._c||e;return n("f7-page",{attrs:{name:"nurse_booking__order-success",id:"nurse_booking__order-success","no-navbar":""},on:{"page:afterin":t.onPageAfterIn}},[n("div",{staticClass:"order-status-title"},[t._v(t._s(t.$t("nurse_booking.order_success.title")))]),t._v(" "),n("div",{staticClass:"order-status-img"},[n("img",{attrs:{src:t.$addonAssetsUrl+"order-success.svg"}})]),t._v(" "),n("div",{staticClass:"order-status-buttons"},[n("a",{attrs:{href:"/nurse_booking/order-details/?backToHome=true&id="+t.$f7route.query.id+"&masterDetailRoot=true"}},[t._v(t._s(t.$t("nurse_booking.order_success.details_button")))]),t._v(" "),n("a",{staticClass:"no-master-detail",attrs:{href:"/nurse_booking/","data-clear-previous-history":"true"}},[t._v(t._s(t.$t("nurse_booking.order_success.home_button")))])])])}ot.options.__file="addons/nurse_booking/1.0.0/src/pages/order-error.vue";var rt=ot.exports;st._withStripped=!0;var it=o({mounted:function(){document.addEventListener("backbutton",this.onBackButton)},beforeDestroy:function(){document.removeEventListener("backbutton",this.onBackButton)},methods:{onBackButton:function(){this.$f7router.back("/nurse_booking/",{force:!0})},onPageAfterIn:function(){var t=this;setTimeout((function(){t.$f7router.clearPreviousHistory()}),500)}}},st,[],!1,null,null,null);function ct(){var t=this,e=t.$createElement,n=t._self._c||e;return n("f7-page",{attrs:{name:"nurse_booking__history",id:"nurse_booking__history"}},[n("f7-navbar",[n("tommy-nav-back"),t._v(" "),n("f7-nav-title",[t._v(t._s(t.$t("nurse_booking.history.title")))])],1),t._v(" "),t.ordersSorted?n("div",{staticClass:"orders-list"},t._l(t.ordersSorted,(function(e,a){return n("a",{key:a,staticClass:"order-item",attrs:{href:"/nurse_booking/order-details/?id="+e.id}},[n("div",{staticClass:"order-item-header"},[e.data?n("div",{staticClass:"order-item-date"},[t._v(t._s(t.formatDate(e.data.date,"D MMM YYYY")))]):t._e(),t._v(" "),n("div",{staticClass:"order-item-status"},[t._v(t._s(t.$t(e.statusKey)))])]),t._v(" "),n("div",{staticClass:"order-item-content"},[n("div",{staticClass:"order-item-details"},[n("div",{staticClass:"order-item-details-row"},[t._v(t._s(e.name))]),t._v(" "),e.data?n("div",{staticClass:"order-item-details-row order-item-details-date"},[t._v(t._s(t.formatDate(e.data.date,"MMM D, YYYY H:mm")))]):t._e()]),t._v(" "),n("div",{staticClass:"order-item-amount"},[t._v("¥"+t._s(e.total))])])])})),0):t._e()],1)}it.options.__file="addons/nurse_booking/1.0.0/src/pages/order-success.vue";var dt=it.exports;ct._withStripped=!0;var lt=o({data:function(){return{orders:null}},computed:{ordersSorted:function(){return this.orders?this.orders.sort((function(t,e){return e.id>t.id?1:e.id<t.id?-1:0})):null}},mounted:function(){var t=this;if(t.$f7route.query.masterDetailRoot){var e=t.$f7.navbar.getElByPage(t.$el);e&&t.$$(e).addClass("navbar-master-detail-root")}var n=t.$root.team?t.$root.team.id:t.$addons.addons.nurse_booking.data.nursing_team_id;C.getOrdersHistory(n).then((function(e){e.forEach((function(t){t.statusKey="nurse_booking.history.status_".concat(t.canceled?"canceled":t.status),t.data&&t.data.date&&(Number.isNaN(parseInt(t.data.date,10))||(t.data.date=parseInt(t.data.date,10)))})),t.orders=e}))},methods:{formatDate:S}},ct,[],!1,null,null,null);lt.options.__file="addons/nurse_booking/1.0.0/src/pages/history.vue";var ut=[{path:"/nurse_booking/",component:i,master:!0},{path:"/nurse_booking/vip/",component:l},{path:"/nurse_booking/vip-details/",component:v},{path:"/nurse_booking/service-list/",component:O},{path:"/nurse_booking/service-details/:id/",component:A},{path:"/nurse_booking/order-select-location/",component:Y},{path:"/nurse_booking/order-select-date/",component:L},{path:"/nurse_booking/order-select-nurse/",component:q},{path:"/nurse_booking/order-confirm/",component:X},{path:"/nurse_booking/order-details/",component:tt},{path:"/nurse_booking/order-canceled/",component:at},{path:"/nurse_booking/order-error/",component:rt},{path:"/nurse_booking/order-success/",component:dt},{path:"/nurse_booking/history/",component:lt.exports}];e.default=ut}]).default;