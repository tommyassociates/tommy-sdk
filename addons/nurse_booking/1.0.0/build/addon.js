var addon=function(e){var t={};function n(a){if(t[a])return t[a].exports;var o=t[a]={i:a,l:!1,exports:{}};return e[a].call(o.exports,o,o.exports,n),o.l=!0,o.exports}return n.m=e,n.c=t,n.d=function(e,t,a){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:a})},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var a=Object.create(null);if(n.r(a),Object.defineProperty(a,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var o in e)n.d(a,o,function(t){return e[t]}.bind(null,o));return a},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="",n(n.s=1)}([,function(e,t,n){"use strict";function a(){var e=this,t=e.$createElement,n=e._self._c||t;return n("f7-page",{attrs:{name:"nurse_booking__index",id:"nurse_booking__index"},on:{"page:beforein":e.onPageBeforeIn,"page:beforeout":e.onPageBeforeOut}},[n("f7-navbar",[n("tommy-nav-menu"),e._v(" "),n("f7-nav-title",[e._v(e._s(e.$t("nurse_booking.index.title","Nurse Booking")))])],1),e._v(" "),n("f7-swiper",{ref:"swiper",attrs:{pagination:""}},[n("f7-swiper-slide",{staticClass:"swiper-slide",style:"background-image: url("+e.$addonAssetUrl+"demo-slide.jpg)"}),e._v(" "),n("f7-swiper-slide",{staticClass:"swiper-slide",style:"background-image: url("+e.$addonAssetUrl+"demo-slide.jpg)"}),e._v(" "),n("f7-swiper-slide",{staticClass:"swiper-slide",style:"background-image: url("+e.$addonAssetUrl+"demo-slide.jpg)"})],1),e._v(" "),n("div",{staticClass:"sections"},[n("div",{staticClass:"section"},[n("a",{attrs:{href:"/nurse_booking/service-list/?category=Cleaning&masterDetailRoot=true","data-reload-detail":"true"}},[n("img",{attrs:{src:e.$addonAssetUrl+"icon-cleaning.svg"}}),e._v(" "),n("span",[e._v(e._s(e.$t("nurse_booking.index.cleaning_label","Cleaning")))])])]),e._v(" "),n("div",{staticClass:"section"},[n("a",{attrs:{href:"/nurse_booking/service-list/?category=Elderservice&masterDetailRoot=true","data-reload-detail":"true"}},[n("img",{attrs:{src:e.$addonAssetUrl+"icon-elderservice.svg"}}),e._v(" "),n("span",[e._v(e._s(e.$t("nurse_booking.index.elderservice_label","Elders Service")))])])]),e._v(" "),n("div",{staticClass:"section"},[n("a",{attrs:{href:"/nurse_booking/service-list/?category=Extras&masterDetailRoot=true","data-reload-detail":"true"}},[n("img",{attrs:{src:e.$addonAssetUrl+"icon-extras.svg"}}),e._v(" "),n("span",[e._v(e._s(e.$t("nurse_booking.index.extras_label","Accompany to Go Out")))])])]),e._v(" "),n("div",{staticClass:"section"},[n("a",{attrs:{href:"/nurse_booking/service-list/?category=Nursing&masterDetailRoot=true","data-reload-detail":"true"}},[n("img",{attrs:{src:e.$addonAssetUrl+"icon-nursing.svg"}}),e._v(" "),n("span",[e._v(e._s(e.$t("nurse_booking.index.nursing_label","Nursing")))])])]),e._v(" "),n("div",{staticClass:"section"},[n("a",{attrs:{href:"/nurse_booking/service-list/?category=Massage&masterDetailRoot=true","data-reload-detail":"true"}},[n("img",{attrs:{src:e.$addonAssetUrl+"icon-massage.svg"}}),e._v(" "),n("span",[e._v(e._s(e.$t("nurse_booking.index.massage_label","Massage")))])])]),e._v(" "),n("div",{staticClass:"section"},[n("a",{attrs:{href:"/nurse_booking/history/?masterDetailRoot=true","data-reload-detail":"true"}},[n("img",{attrs:{src:e.$addonAssetUrl+"icon-booking.svg"}}),e._v(" "),n("span",[e._v(e._s(e.$t("nurse_booking.index.booking_label","Booking")))])])]),e._v(" "),n("div",{staticClass:"section"},[n("a",{staticClass:"external",attrs:{href:"tommy://addon?package=wallet&back=true"}},[n("img",{attrs:{src:e.$addonAssetUrl+"icon-wallet.svg"}}),e._v(" "),n("span",[e._v(e._s(e.$t("nurse_booking.index.wallet_label","Wallet")))])])])])],1)}function o(e,t,n,a,o,r,s,i){var c,d="function"==typeof e?e.options:e;if(t&&(d.render=t,d.staticRenderFns=n,d._compiled=!0),a&&(d.functional=!0),r&&(d._scopeId="data-v-"+r),s?(c=function(e){(e=e||this.$vnode&&this.$vnode.ssrContext||this.parent&&this.parent.$vnode&&this.parent.$vnode.ssrContext)||"undefined"==typeof __VUE_SSR_CONTEXT__||(e=__VUE_SSR_CONTEXT__),o&&o.call(this,e),e&&e._registeredComponents&&e._registeredComponents.add(s)},d._ssrRegister=c):o&&(c=i?function(){o.call(this,this.$root.$options.shadowRoot)}:o),c)if(d.functional){d._injectStyles=c;var l=d.render;d.render=function(e,t){return c.call(t),l(e,t)}}else{var u=d.beforeCreate;d.beforeCreate=u?[].concat(u,c):[c]}return{exports:e,options:d}}n.r(t),a._withStripped=!0;var r=o({beforeDestroy:function(){this.$f7router.view.$navbarEl.removeClass("nurse-booking-index-navbar")},mounted:function(){var e=this;e.$refs.swiper&&e.$refs.swiper.swiper&&e.$nextTick((function(){e.$refs.swiper.swiper.update()}))},methods:{onPageBeforeIn:function(){this.$f7router.view.$navbarEl.addClass("nurse-booking-index-navbar")},onPageBeforeOut:function(){this.$f7router.view.$navbarEl.removeClass("nurse-booking-index-navbar")}}},a,[],!1,null,null,null);function s(){var e=this,t=e.$createElement,n=e._self._c||t;return n("f7-page",{attrs:{name:"nurse_booking__vip",id:"nurse_booking__vip"},on:{"page:beforein":e.onPageBeforeIn,"page:beforeout":e.onPageBeforeOut}},[n("f7-navbar",[n("tommy-nav-back")],1),e._v(" "),n("div",{staticClass:"vip-header"},[n("div",{staticClass:"avatar",style:"background-image: url("+e.$addonAssetsUrl+"demo-avatar.png"},[n("div",{staticClass:"medal medal-green"})]),e._v(" "),n("div",{staticClass:"name"},[e._v("Allen Zhang")])]),e._v(" "),n("div",{staticClass:"vip-info"},[e._v(e._s(e.$t("nurse_booking.vip.info")))]),e._v(" "),n("div",{staticClass:"vip-plans"},[n("a",{staticClass:"vip-plan vip-plan-green",attrs:{href:"/nurse_booking/vip-details/"}},[n("div",{staticClass:"vip-plan-badge"},[e._v(e._s(e.$t("nurse_booking.vip.current_plan_badge")))]),e._v(" "),n("div",{staticClass:"vip-plan-title"},[e._v(e._s(e.$t("nurse_booking.vip.plan_green")))])]),e._v(" "),n("a",{staticClass:"vip-plan vip-plan-gold",attrs:{href:"/nurse_booking/vip-details/"}},[n("div",{staticClass:"vip-plan-badge"},[e._v(e._s(e.$t("nurse_booking.vip.recommended_plan_badge")))]),e._v(" "),n("div",{staticClass:"vip-plan-title"},[e._v(e._s(e.$t("nurse_booking.vip.plan_gold")))])]),e._v(" "),n("a",{staticClass:"vip-plan vip-plan-platinum",attrs:{href:"/nurse_booking/vip-details/"}},[n("div",{staticClass:"vip-plan-title"},[e._v(e._s(e.$t("nurse_booking.vip.plan_platinum")))])])])],1)}r.options.__file="addons/nurse_booking/1.0.0/src/pages/index.vue";var i=r.exports;s._withStripped=!0;var c=o({beforeDestroy:function(){this.$f7router.view.$navbarEl.removeClass("nurse-booking-vip-navbar")},methods:{onPageBeforeIn:function(){this.$f7router.view.$navbarEl.addClass("nurse-booking-vip-navbar")},onPageBeforeOut:function(e,t){"previous"!==t.to&&this.$f7router.view.$navbarEl.removeClass("nurse-booking-vip-navbar")}}},s,[],!1,null,null,null);function d(){var e=this,t=e.$createElement,n=e._self._c||t;return n("f7-page",{attrs:{name:"nurse_booking__vip-details",id:"nurse_booking__vip-details"},on:{"page:beforein":e.onPageBeforeIn,"page:beforeout":e.onPageBeforeOut}},[n("f7-navbar",[n("tommy-nav-back")],1),e._v(" "),n("div",{staticClass:"vip-header"},[n("div",{staticClass:"avatar",style:"background-image: url("+e.$addonAssetsUrl+"demo-avatar.png"},[n("div",{staticClass:"medal medal-green"})]),e._v(" "),n("div",{staticClass:"name"},[e._v("Allen Zhang")])]),e._v(" "),n("div",{staticClass:"vip-plan-details"},[n("div",{staticClass:"vip-plan-current"},[e._v(e._s(e.$t("nurse_booking.vip.plan_green")))]),e._v(" "),n("div",{staticClass:"vip-plan-expiration"},[e._v("Expires 3rd April")])]),e._v(" "),n("div",{staticClass:"list vip-details-list"},[n("ul",[n("li",{staticClass:"item-divider"},[e._v(e._s(e.$t("nurse_booking.vip.details_plan_inclusion")))]),e._v(" "),n("li",{staticClass:"item-content"},[n("div",{staticClass:"item-inner"},[n("div",{staticClass:"item-title"},[n("div",[e._v("Nurse Visit")]),e._v(" "),n("div",{staticClass:"item-subtitle"},[n("b",[e._v("Four")]),e._v(" ("),n("b",[e._v("one")]),e._v(" time left) per month\n            ")])])])]),e._v(" "),n("li",{staticClass:"item-content"},[n("div",{staticClass:"item-inner"},[n("div",{staticClass:"item-title"},[n("div",[e._v("Clean")]),e._v(" "),n("div",{staticClass:"item-subtitle"},[n("b",[e._v("Four+One")]),e._v(" per month\n            ")])])])]),e._v(" "),n("li",{staticClass:"item-content"},[n("div",{staticClass:"item-inner"},[n("div",{staticClass:"item-title"},[n("div",[e._v("Massage")])])])]),e._v(" "),n("li",{staticClass:"item-divider"},[e._v(e._s(e.$t("nurse_booking.vip.details_administration")))]),e._v(" "),n("li",[n("a",{staticClass:"item-content item-link",attrs:{href:"#"}},[n("div",{staticClass:"item-inner"},[n("div",{staticClass:"item-title"},[e._v("Change Subscription")])])])]),e._v(" "),n("li",[n("a",{staticClass:"item-content item-link",attrs:{href:"#"}},[n("div",{staticClass:"item-inner"},[n("div",{staticClass:"item-title"},[e._v("Coupon")]),e._v(" "),n("div",{staticClass:"item-after"},[n("b",[e._v("4 Sheets")])])])])])])])],1)}c.options.__file="addons/nurse_booking/1.0.0/src/pages/vip.vue";var l=c.exports;d._withStripped=!0;var u=o({methods:{onPageBeforeIn:function(){},onPageBeforeOut:function(){}}},d,[],!1,null,null,null);function _(){var e=this,t=e.$createElement,n=e._self._c||t;return n("f7-page",{attrs:{name:"nurse_booking__service-list",id:"nurse_booking__service-list"}},[n("f7-navbar",[n("tommy-nav-back"),e._v(" "),n("f7-nav-title",[e._v(e._s(e.$t("nurse_booking.service_list."+e.category.toLowerCase()+"_title")))])],1),e._v(" "),e.services&&!e.services.length?n("div",{staticClass:"nurse_booking__empty-placeholder"},[e._v("\n    "+e._s(e.$t("nurse_booking.service_list.empty_label"))+"\n  ")]):e._e(),e._v(" "),e.services&&e.services.length?n("f7-swiper",{staticClass:"service-cards no-swipe-panel",attrs:{params:{centeredSlides:!0,slidesPerView:"auto",touchMoveStopPropagation:!1,on:{tap:e.onSlideClick}}}},e._l(e.services,(function(t){return n("f7-swiper-slide",{key:e.serviceType(t)+"-"+t.id,attrs:{"data-url":"/nurse_booking/service-details/"+t.id+"/?type="+e.serviceType(t)}},[n("a",{staticClass:"service-card",attrs:{href:"#"}},[n("div",{staticClass:"service-card-pic",style:"background-image:url("+e.serviceImage(t)+")"}),e._v(" "),n("div",{staticClass:"service-card-content"},[n("div",{staticClass:"service-card-title"},[e._v(e._s(t.name))]),e._v(" "),t.data&&t.data.duration?n("div",{staticClass:"service-card-duration"},[e._v(e._s(t.data.duration)+e._s(e.$t("nurse_booking.service_list.min_label")))]):e._e(),e._v(" "),t.coupons&&t.coupons.length?n("div",{staticClass:"service-card-coupons"},[e._v(e._s(t.coupons.length)+" "+e._s(e.$t("nurse_booking.service_list.coupons_label")))]):n("div",{staticClass:"service-card-price"},[e._v("¥ "+e._s(t.price))])])])])})),1):e._e()],1)}u.options.__file="addons/nurse_booking/1.0.0/src/pages/vip-details.vue";var v=u.exports;function p(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function g(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function f(e){return function(e){if(Array.isArray(e)){for(var t=0,n=new Array(e.length);t<e.length;t++)n[t]=e[t];return n}}(e)||function(e){if(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e))return Array.from(e)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}function m(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:[],n=2<arguments.length?arguments[2]:void 0,a=!!e.vendor_package_products,o=t.filter((function(t){return t.category===e.category||e.category===C[t.category]||a&&t.vendor_package_id===e.id||!a&&t.vendor_product_id===e.id}));return o.filter((function(e){return!(e.max_uses&&e.use_count>=e.max_uses||e.user_id&&e.user_id!==n||e.valid_to&&(new Date).getTime()>new Date(e.valid_to).getTime())}))}_._withStripped=!0;var b=window.tommy,h=b.api,k={cache:{services:[],coupons:[],locations:[],booking:{},nurse:{}},getServiceList:function(e){return Promise.all([h.call({endpoint:"vendors/".concat(e,"/products"),method:"GET",data:{}}),h.call({endpoint:"vendors/".concat(e,"/packages"),method:"GET",data:{}})]).then((function(e){var t=function(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e)){var n=[],a=!0,o=!1,r=void 0;try{for(var s,i=e[Symbol.iterator]();!(a=(s=i.next()).done)&&(n.push(s.value),!t||n.length!==t);a=!0);}catch(e){o=!0,r=e}finally{try{a||null==i.return||i.return()}finally{if(o)throw r}}return n}}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}(e,2),n=t[0],a=t[1],o=[].concat(f(n),f(a)).filter((function(e){return e.active}));return k.cache.services=o}))},getServiceDetails:function(e,t,n){return h.call({endpoint:"vendors/".concat(e,"/").concat("VendorProduct"===n?"products":"packages","/").concat(t),method:"GET"}).then((function(e){return e}))},getCouponList:function(e){return h.call({endpoint:"vendors/".concat(e,"/coupons"),method:"GET",data:{},cache:!1}).then((function(e){return k.cache.coupons=e}))},getLocations:function(){return h.call({endpoint:"addons/nurse_booking/install/settings/locations",method:"GET"}).then((function(e){return k.cache.locations=e&&e.data&&e.data.locations?e.data.locations:[],k.cache.locations}))},getNurseList:function(e,t,n){var a=b.moment(new Date(t)).toISOString(!0),o=b.moment(new Date(n)).toISOString(!0);return h.call({endpoint:"teams/".concat(e,"/members"),method:"GET",data:{tags:["Employee"],is_available_between:[a,o],timezone_offset:(new Date).getTimezoneOffset()},cache:!1}).then((function(e){return k.cache.nurses=(e||[]).filter((function(e){return!0===e.is_available})),k.cache.nurses}))},saveLocations:function(e){return e?k.cache.locations=e:e=k.cache.locations,h.call({endpoint:"addons/nurse_booking/install/settings/locations",method:"PUT",data:{data:JSON.stringify({locations:e})}}).then((function(e){return e.data.locations}))},addLocation:function(e){return e.default?(k.cache.locations.forEach((function(e){e.default=!1})),k.cache.locations.unshift(e)):k.cache.locations.push(e),k.saveLocations(k.cache.locations)},removeLocation:function(e){return k.cache.locations.splice(e,1),k.saveLocations(k.cache.locations)},createBookingEvent:function(e,t){var n,a=t.data.date;return"string"==typeof a&&(a=parseInt(a,10)),t.data.duration&&0<t.data.duration&&(n=a+60*parseInt(t.data.duration,10)*1e3),h.createEvent({addon:"nurse_booking",title:t.name,start_at:new Date(a).toJSON(),end_at:new Date(n).toJSON(),location:"".concat(t.data.location.city," ").concat(t.data.location.address),user_id:t.user_id,team_id:null,assignee_id:t.data.nurse.user_id,assignee_team_id:e,kind:"Booking",resource_id:t.id,resource_type:"VendorOrder"})},deleteBookingEvent:function(e){return h.getEvents({addon:"nurse_booking",kind:"Booking",resource_id:e,resource_type:"VendorOrder"}).then((function(e){return Promise.all(e.map((function(e){return h.deleteEvent(e.id)})))}))},setAvailabilityLock:function(e){var t=e.data.nurse.user_id,n=new Date(e.data.date),a=n.getHours();n.setHours(0,0,0,0),n=new Date(n.getTime()-60*n.getTimezoneOffset()*1e3);var o=new Date(n.getTime()-864e5),r=new Date(n.getTime()+864e5);return h.call({endpoint:"fragments?addon=availability&kind=Availability",data:{user_id:t,date_range:[o.toJSON(),r.toJSON()]}}).then((function(e){var o;e.forEach((function(e){new Date(e.start_at).toJSON()===n.toJSON()&&(o=e)}));var r={};return 7<=a&&a<13?r.lock_am=!0:13<=a&&a<22?r.lock_pm=!0:r.lock_nd=!0,o?(Object.assign(o.data,r),h.updateFragment(o.id,o)):h.createFragment({addon:"availability",kind:"Availability",data:JSON.stringify(function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?p(Object(n),!0).forEach((function(t){g(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):p(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}({},r)),start_at:n.toJSON(),user_id:t})}))},deleteAvailabilityLock:function(e){var t=e.data.nurse.user_id,n=new Date(parseInt(e.data.date,10)),a=n.getHours();n.setHours(0,0,0,0),n=new Date(n.getTime()-60*n.getTimezoneOffset()*1e3);var o=new Date(n.getTime()-864e5),r=new Date(n.getTime()+864e5);return h.call({endpoint:"fragments?addon=availability&kind=Availability",data:{user_id:t,date_range:[o.toJSON(),r.toJSON()]}}).then((function(e){var t,o;return e.forEach((function(e){new Date(e.start_at).toJSON()===n.toJSON()&&(t=e)})),o=7<=a&&a<13?"lock_am":13<=a&&a<22?"lock_pm":"lock_nd",t&&t.data&&t.data[o]?(delete t.data[o],h.updateFragment(t.id,t)):Promise.resolve("nothing-to-remove")}))},sendOrder:function(e,t){return h.call({endpoint:"vendors/".concat(e,"/orders"),method:"POST",data:t})},updateOrder:function(e,t){return h.call({endpoint:"vendors/".concat(e,"/orders/").concat(t.id),method:"PUT",data:t})},getOrdersHistory:function(e){return h.call({endpoint:"vendors/".concat(e,"/orders/"),method:"GET",cache:!1}).then((function(e){return k.cache.orders=e}))},getOrderDetails:function(e,t){return h.call({endpoint:"vendors/".concat(e,"/orders/").concat(t,"?with_wallet_transaction=true"),method:"GET"}).then((function(e){return e}))},cancelOrder:function(e,t){return h.call({endpoint:"vendors/".concat(e,"/orders/").concat(t),method:"DELETE"})}},y=k,C={Massage:"按摩",Cleaning:"常规家政",Nursing:"护理",Elderservice:"老人家政",Extras:"外出陪同"};var $=o({data:function(){return{services:null,category:this.$f7route.query.category}},methods:{onSlideClick:function(e){var t=this.$$(e.target).closest(".swiper-slide").attr("data-url");t&&this.$f7router.navigate(t)},serviceType:function(e){return e.vendor_package_products?"package":"product"},serviceImage:function(e){return e.image_url?e.image_url:"".concat(this.$addonAssetsUrl,"demo-package.png")}},mounted:function(){var e=this;if(e.$f7route.query.masterDetailRoot){var t=e.$f7.navbar.getElByPage(e.$el);t&&e.$$(t).addClass("navbar-master-detail-root")}var n=e.$root.team?e.$root.team.id:e.$addons.addons.nurse_booking.data.nursing_team_id;Promise.all([y.getServiceList(n),y.getCouponList(n)]).then((function(t){var n=function(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e)){var n=[],a=!0,o=!1,r=void 0;try{for(var s,i=e[Symbol.iterator]();!(a=(s=i.next()).done)&&(n.push(s.value),!t||n.length!==t);a=!0);}catch(e){o=!0,r=e}finally{try{a||null==i.return||i.return()}finally{if(o)throw r}}return n}}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}(t,2),a=n[0],o=n[1],r=a.filter((function(t){return t.category===e.category||t.category===C[e.category]}));r.forEach((function(t){t.coupons=m(t,o,e.$root.user.id)})),e.services=r}))}},_,[],!1,null,null,null);function w(){var e=this,t=e.$createElement,n=e._self._c||t;return n("f7-page",{attrs:{name:"nurse_booking__service-details",id:"nurse_booking__service-details"}},[n("f7-navbar",[n("tommy-nav-back"),e._v(" "),n("f7-nav-title",[e._v(e._s(e.service.name))])],1),e._v(" "),n("a",{staticClass:"nurse_booking__toolbar-button",attrs:{slot:"fixed"},on:{click:e.book},slot:"fixed"},[e._v(e._s(e.$t("nurse_booking.service_details.book_button")))]),e._v(" "),n("div",{staticClass:"service-details-header"},[n("f7-swiper",[n("div",{staticClass:"swiper-slide",style:"background-image: url("+e.serviceImage(e.service)+")"})])],1),e._v(" "),n("div",{staticClass:"service-details-meta"},[n("div",{staticClass:"service-details-meta-wrap"},[n("div",{staticClass:"service-details-meta-left"},[n("div",{staticClass:"service-details-title"},[e._v(e._s(e.service.name))]),e._v(" "),e.service.data&&e.service.data.duration?n("div",{staticClass:"service-details-duration"},[e._v(e._s(e.service.data.duration)+"min")]):e._e()]),e._v(" "),n("div",{staticClass:"service-details-price"},[e._v("¥ "+e._s(e.service.price))])]),e._v(" "),e.service.coupons&&e.service.coupons.length?n("a",{staticClass:"service-details-coupons-link",on:{click:e.chooseCoupon}},[n("span",[e._v(e._s(e.$t("nurse_booking.service_details.n_coupons_available",{n:e.service.coupons.length})))])]):e._e()]),e._v(" "),n("div",{staticClass:"service-details-content"},[n("div",{staticClass:"service-details-label"},[e._v(e._s(e.$t("nurse_booking.service_details.service_details_label"))+":")]),e._v(" "),n("div",{staticClass:"service-details-text"},[n("p",[e._v("\n        "+e._s(e.service.description)+"\n      ")])]),e._v(" "),e.products?n("div",{staticClass:"service-details-products"},e._l(e.products,(function(t){return n("div",{key:t.id,staticClass:"service-details-product"},[n("div",{staticClass:"service-details-product-image",style:"background-image: url("+e.serviceImage(t)+")"}),e._v(" "),n("div",{staticClass:"service-details-product-name"},[e._v(e._s(t.name))])])})),0):e._e()])],1)}$.options.__file="addons/nurse_booking/1.0.0/src/pages/service-list.vue";var O=$.exports;function D(e,t){var n=window.tommy.moment,a=n.utc(e).toDate();return n(a).format(t)}function P(e,t,n,a){var o,r,s=window.tommy.app.f7,i=e.map((function(e){return Object.assign({},e,{checked:!!a&&e.id===a.id})})),c='\n  <div class="nurse_booking-coupon-picker">\n    <div class="coupon-picker-img">\n      <img src="'.concat(E.addons.getAssetsUrl("nurse_booking"),'coupon-picker.svg" height="78">\n    </div>\n    <div class="coupon-picker-text">').concat(E.i18n.t("nurse_booking.coupon_picker.text"),'</div>\n    <div class="coupon-picker-items">\n      ').concat(i.map((function(e){return'\n      <label>\n        <input type="radio" name="nurse_booking-coupon-picker-radio" value="'.concat(e.id,'" ').concat(e.checked?"checked":"",'>\n        <div class="coupon-item-content">\n          ').concat("percentage"!==e.kind?'\n          <div class="coupon-item-title">¥ '.concat(e.amount,"</div>\n          "):'\n          <div class="coupon-item-title">'.concat(100*e.amount,"%</div>\n          "),'\n          <div class="coupon-item-name">').concat(e.name,"</div>\n          ").concat(e.expires_at||e.valid_to?'\n          <div class="coupon-item-date">'.concat(D(e.expires_at||e.valid_to,"D MMM YYYY"),"</div>\n          "):"",'\n        </div>\n        <div class="coupon-item-label">').concat(E.i18n.t("nurse_booking.coupon_picker.use_label"),"</div>\n      </label>\n      ").trim()})).join(""),"\n    </div>\n  </div>\n  ").trim(),d=s.dialog.create({content:c,cssClass:"nurse_booking-coupon-picker-modal",buttons:[{text:E.i18n.t("nurse_booking.coupon_picker.skip_button","Skip"),onClick:function(){n&&n()}},{text:E.i18n.t("nurse_booking.coupon_picker.confirm_button","Confirm"),bold:!0,onClick:function(){t&&t(r)}}]}).open().$el;d.find(".dialog-button-bold").addClass("dialog-button-disabled"),d.find("input").on("change",(function(t){d.find(".dialog-button-bold").removeClass("dialog-button-disabled"),t.target.checked&&(o=t.target.value,e.forEach((function(e){e.id===parseInt(o,10)&&(r=e)})))}))}w._withStripped=!0;var E=window.tommy,S=o({props:{id:[Number,String]},data:function(){var e=this,t=e.$f7route.query.type||"product",n={},a=null;return(y.cache.services||[]).forEach((function(a){var o=a.vendor_package_products?"package":"product";a.id===parseInt(e.id,10)&&o===t&&((n=a).coupons=m(n,y.cache.coupons,e.$root.user.id))})),n.vendor_package_products&&n.vendor_package_products.length&&(a=n.vendor_package_products.map((function(e){return(y.cache.services||[]).filter((function(t){return t.id===e.vendor_product_id&&!t.vendor_package_products}))[0]}))),{service:n,selectedCoupon:null,type:t,products:a}},mounted:function(){},methods:{serviceImage:function(e){return e.image_url?e.image_url:"".concat(this.$addonAssetsUrl,"demo-package.png")},book:function(){var e=this,t=e.service;y.cache.booking.services=[t],y.cache.booking.serviceType=e.type,t.coupons&&t.coupons.length?P(t.coupons,(function(n){e.selectedCoupon=n,y.cache.booking.services=[t],y.cache.booking.coupon=e.selectedCoupon,e.$f7router.navigate("/nurse_booking/order-select-location/")}),(function(){y.cache.booking.coupon=null,delete y.cache.booking.coupon,e.selectedCoupon=null,e.$f7router.navigate("/nurse_booking/order-select-location/")})):(y.cache.booking.coupon=null,delete y.cache.booking.coupon,e.selectedCoupon=null,e.$f7router.navigate("/nurse_booking/order-select-location/"))},chooseCoupon:function(){var e=this;P(e.service.coupons,(function(t){e.selectedCoupon=t,y.cache.booking.services=[e.service],y.cache.booking.coupon=e.selectedCoupon,e.$f7router.navigate("/nurse_booking/order-select-location/")}),(function(){e.selectedCoupon=null}))}}},w,[],!1,null,null,null);function x(){var e=this,t=e.$createElement,n=e._self._c||t;return n("f7-page",{attrs:{name:"nurse_booking__location",id:"nurse_booking__location"}},[n("f7-navbar",[n("tommy-nav-back"),e._v(" "),n("f7-nav-title",[e._v(e._s(e.$t("nurse_booking.location.title")))])],1),e._v(" "),e._l(e.locations,(function(t,a){return e.locations&&e.locations.length?n("div",{key:a,staticClass:"location-card"},[n("i",{staticClass:"location-card-icon"}),e._v(" "),n("div",{staticClass:"location-card-title"},[t.default?n("span",{staticClass:"location-card-default-badge"},[e._v("["+e._s(e.$t("nurse_booking.location.default_label"))+"]")]):e._e(),e._v("\n      "+e._s(t.city)+" "+e._s(t.address)+"\n    ")]),e._v(" "),n("a",{staticClass:"location-delete-button",attrs:{href:"#"},on:{click:function(n){return e.deleteLocation(t,a)}}}),e._v(" "),n("a",{staticClass:"location-card-button location-select-button",attrs:{href:"#"},on:{click:function(n){return e.selectLocation(t,a)}}},[e._v(e._s(e.$t("nurse_booking.location.select_button")))])]):e._e()})),e._v(" "),e.addMode||e.locations&&!e.locations.length?n("div",{staticClass:"location-card location-add-form"},[n("input",{attrs:{type:"text",domProps:{defaultValue:e.defaultCity},placeholder:e.$t("nurse_booking.location.city_placeholder")},domProps:{value:e.city},on:{input:function(t){e.city=t.target.value}}}),e._v(" "),n("textarea",{attrs:{type:"text",placeholder:e.$t("nurse_booking.location.address_placeholder")},domProps:{value:e.address||e.defaultAddress},on:{input:function(t){e.address=t.target.value}}}),e._v(" "),n("label",[n("input",{attrs:{type:"checkbox",name:"default"},domProps:{checked:e.isDefault},on:{change:function(t){e.isDefault=t.target.checked}}}),e._v(" "),n("i",{staticClass:"framework7-icons"},[e._v("check")]),e._v(" "),n("span",[e._v(e._s(e.$t("nurse_booking.location.set_default_label")))])]),e._v(" "),n("a",{staticClass:"location-card-button location-save-button",attrs:{href:"#"},on:{click:function(t){return e.saveLocation()}}},[e._v(e._s(e.$t("nurse_booking.location.save_button")))])]):e._e(),e._v(" "),e.locations&&e.locations.length?n("a",{staticClass:"location-add-button",attrs:{href:"#"},on:{click:function(t){return e.addLocation()}}},[e._v(e._s(e.$t("nurse_booking.location.add_button")))]):e._e()],2)}S.options.__file="addons/nurse_booking/1.0.0/src/pages/service-details.vue";var I=S.exports;function A(e){return function(e){if(Array.isArray(e)){for(var t=0,n=new Array(e.length);t<e.length;t++)n[t]=e[t];return n}}(e)||function(e){if(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e))return Array.from(e)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}x._withStripped=!0;var j=o({data:function(){return{service:y.cache.booking.services[0],locations:null,addMode:!1,city:this.$root.user.location||this.$root.user.city||"",address:this.$root.user.address||"",isDefault:!1}},mounted:function(){var e=this;y.getLocations().then((function(){e.locations=A(y.cache.locations||[])}))},methods:{deleteLocation:function(e,t){var n=this;y.removeLocation(t).then((function(){n.locations.splice(t,1)}))},selectLocation:function(e){var t=this,n=e.city,a=e.address;0<=n.indexOf("山缘")||0<=a.indexOf("山缘")?(y.cache.booking.location=e,t.$f7route.query.back?t.$f7router.back():t.$f7router.navigate("/nurse_booking/order-select-date/")):t.$f7.dialog.alert(t.$t("nurse_booking.location.not_available"))},saveLocation:function(){var e=this,t=e.city,n=e.address,a=e.isDefault;t&&n&&y.addLocation({city:t,address:n,default:a}).then((function(){e.locations=A(y.cache.locations||[]),e.addMode=!1,e.city="",e.address="",e.isDefault=!1}))},addLocation:function(){this.addMode=!0}}},x,[],!1,null,null,null);function M(){var e=this,t=e.$createElement,n=e._self._c||t;return n("f7-page",{attrs:{name:"nurse_booking__date-time",id:"nurse_booking__date-time"}},[n("f7-navbar",[n("tommy-nav-back"),e._v(" "),n("f7-nav-title",[e._v(e._s(e.$t("nurse_booking.date_time.title")))])],1),e._v(" "),n("a",{staticClass:"nurse_booking__toolbar-button",class:{disabled:!e.selectedDate||!e.selectedHours},attrs:{slot:"fixed",href:"#"},on:{click:e.selectDateTime},slot:"fixed"},[e._v(e._s(e.$t("nurse_booking.date_time.determine_button")))]),e._v(" "),n("div",{staticClass:"date-time-dates"},e._l(e.dates,(function(t,a){return n("label",{key:a,staticClass:"date-time-date",class:{"date-time-date-disabled":t.disabled}},[n("input",{attrs:{type:"radio",disabled:t.disabled},domProps:{checked:e.selectedDate===t.value},on:{change:function(n){e.selectedDate=t.value}}}),e._v(" "),n("div",{staticClass:"date-time-date-num"},[e._v(e._s(t.day)+"."+e._s(t.month))]),e._v(" "),t.today?n("div",{staticClass:"date-time-date-day"},[e._v("Today")]):n("div",{staticClass:"date-time-date-day"},[e._v(e._s(t.weekDay))])])})),0),e._v(" "),n("div",{staticClass:"date-time-hours"},e._l(e.hours,(function(t,a){return n("label",{key:a,staticClass:"date-time-hour",class:{disabled:t.disabled}},[n("input",{attrs:{type:"radio",disabled:t.disabled},domProps:{checked:e.selectedHours===t.value},on:{change:function(n){e.selectedHours=t.value}}}),e._v(" "),n("span",[e._v(e._s(t.hour))])])})),0)],1)}j.options.__file="addons/nurse_booking/1.0.0/src/pages/order-select-location.vue";var T=j.exports;M._withStripped=!0;var B=o({data:function(){for(var e,t=new Date,n=t.getTime(),a=[],o=0;o<=13;o+=1){var r=new Date(n+24*o*60*60*1e3),s=r.getMonth()+1,i=r.getDate();i<10&&(i="0".concat(i)),s<10&&(s="0".concat(s));var c=r.getDay(),d=0===o&&19<=t.getHours();d&&(e=!0),a.push({disabled:d,value:new Date(r.getFullYear(),r.getMonth(),r.getDate()).getTime(),day:i,month:s,weekDay:this.$t("nurse_booking.date_time.week_days.".concat(c))})}var l,u,_=this.$f7route.query.date&&new Date(parseInt(this.$f7route.query.date,10));return _&&(l=new Date(_.getFullYear(),_.getMonth(),_.getDate()).getTime(),u=_.getHours()),{dates:a,selectedDate:l||(e?a[1].value:a[0].value),selectedHours:u||null}},watch:{selectedDate:function(){this.selectedHours=null}},computed:{hours:function(){var e,t=new Date(this.selectedDate),n=[],a=new Date;a.getFullYear()===t.getFullYear()&&a.getMonth()===t.getMonth()&&a.getDate()===t.getDate()&&(e=!0);for(var o=10;o<=19;o+=1){var r=!!e&&a.getHours()>=o;n.push({value:o,disabled:r,hour:"".concat(o,":00")})}return n}},methods:{selectDateTime:function(){var e=this,t=e.selectedDate,n=e.selectedHours;y.cache.booking.date=new Date(parseInt(t,10)).getTime()+60*n*60*1e3,e.$f7route.query.back?e.$f7router.back():e.$f7router.navigate("/nurse_booking/order-select-nurse/")}}},M,[],!1,null,null,null);function N(){var e=this,t=e.$createElement,n=e._self._c||t;return n("f7-page",{attrs:{name:"nurse_booking__nurse-list",id:"nurse_booking__nurse-list"}},[n("f7-navbar",[n("tommy-nav-back"),e._v(" "),n("f7-nav-title",[e._v(e._s(e.$t("nurse_booking.nurse_list.title")))])],1),e._v(" "),e.nurses?n("div",{staticClass:"nurse-list"},[n("ul",e._l(e.nurses,(function(t){return n("li",{key:t.id,class:{"nurse-selected":e.selectedNurseId===t.user_id}},[n("a",{staticClass:"nurse-content-wrap",on:{click:function(n){return e.selectNurse(t)}}},[n("div",{staticClass:"nurse-media",style:"background-image: url("+(t.icon_url||"")+")"}),e._v(" "),n("div",{staticClass:"nurse-content"},[n("div",{staticClass:"nurse-name"},[e._v(e._s(t.last_name)+" "+e._s(t.first_name))])])])])})),0)]):e._e()],1)}B.options.__file="addons/nurse_booking/1.0.0/src/pages/order-select-date.vue";var Y=B.exports;N._withStripped=!0;var L=o({data:function(){return{nurses:null,selectedNurseId:this.$f7route.query.nurse_id?parseInt(this.$f7route.query.nurse_id,10):void 0}},mounted:function(){var e=this,t=e.$root.team?e.$root.team.id:e.$addons.addons.nurse_booking.data.nursing_team_id,n=y.cache.booking.date,a=n+36e5;if(y.cache.booking.services&&y.cache.booking.services.length){var o=0;y.cache.booking.services.forEach((function(e){e.data&&e.data.duration&&(o+=parseInt(e.data.duration,10))})),o&&(a=n+6e4*o)}y.getNurseList(t,new Date(n),new Date(a)).then((function(t){e.$root.teamMembers&&t.length===e.$root.teamMembers.length?e.nurses=e.$root.teamMembers.filter((function(e){return 0<=e.tags.indexOf("Available For Work")})):e.nurses=t}))},methods:{selectNurse:function(e){this.selectedNurseId=e.user_id,y.cache.booking.nurse=e,this.$f7route.query.back?this.$f7router.back():this.$f7router.navigate("/nurse_booking/order-confirm/")}}},N,[],!1,null,null,null);function U(){var e=this,t=e.$createElement,n=e._self._c||t;return n("f7-page",{attrs:{name:"nurse_booking__order-confirm",id:"nurse_booking__order-confirm"},on:{"page:beforein":e.onPageBeforeIn}},[n("f7-navbar",[n("tommy-nav-back"),e._v(" "),n("f7-nav-title",[e._v(e._s(e.$t("nurse_booking.order_confirm.title")))])],1),e._v(" "),n("a",{staticClass:"nurse_booking__toolbar-button service-book-button",attrs:{slot:"fixed",href:"#"},on:{click:e.payOrder},slot:"fixed"},[e._v(e._s(e.$t("nurse_booking.order_confirm.pay_button")))]),e._v(" "),n("div",{staticClass:"service-details-block"},[n("div",{staticClass:"service-image",style:"background-image: url("+e.serviceImage+")"}),e._v(" "),n("div",{staticClass:"service-details"},[n("div",{staticClass:"service-title"},[e._v(e._s(e.serviceName))]),e._v(" "),n("div",{staticClass:"service-price"},[e._v("¥"+e._s(e.servicePrice))])])]),e._v(" "),n("f7-list",{attrs:{"no-hairlines":""}},[e.nurse?n("f7-list-item",{attrs:{title:e.nurse.last_name+" "+e.nurse.first_name,link:"/nurse_booking/order-select-nurse/?nurse_id="+e.nurse.id+"&back=true"}},[n("img",{attrs:{slot:"media",src:e.$addonAssetsUrl+"icon-nurse.svg"},slot:"media"})]):e._e(),e._v(" "),n("f7-list-item",{attrs:{title:e.formatDate(e.date,"MMMM D, YYYY HH:mm"),link:"/nurse_booking/order-select-date/?date="+new Date(e.date).getTime()+"&back=true"}},[n("img",{attrs:{slot:"media",src:e.$addonAssetsUrl+"icon-time.svg"},slot:"media"})])],1),e._v(" "),n("f7-list",{attrs:{"no-hairlines":""}},[n("f7-list-item",{attrs:{title:e.user.first_name+" "+e.user.last_name}},[n("img",{attrs:{slot:"media",src:e.$addonAssetsUrl+"icon-user.svg"},slot:"media"})]),e._v(" "),e.user.mobile?n("f7-list-item",{attrs:{title:e.user.mobile}},[n("img",{attrs:{slot:"media",src:e.$addonAssetsUrl+"icon-phone.svg"},slot:"media"})]):e._e(),e._v(" "),n("f7-list-item",{attrs:{link:"/nurse_booking/order-select-location/?back=true"}},[n("span",{staticClass:"location-default-badge",attrs:{slot:"title"},slot:"title"},[e._v("["+e._s(e.$t("nurse_booking.location.default_label"))+"]")]),e._v(" "),n("span",{attrs:{slot:"title"},slot:"title"},[e._v(e._s(e.location.city)+" "+e._s(e.location.address))]),e._v(" "),n("img",{attrs:{slot:"media",src:e.$addonAssetsUrl+"icon-location.svg"},slot:"media"})])],1),e._v(" "),n("f7-list",{staticClass:"list-prices",attrs:{"no-hairlines":""}},[e.coupon?n("f7-list-item",{attrs:{link:"#",title:e.$t("nurse_booking.order_confirm.coupons_label"),after:"percentage"!==e.coupon.kind?"-¥"+e.couponDiscount:"-"+100*e.coupon.amount+"%"},on:{click:e.selectCoupon}}):e._e(),e._v(" "),n("f7-list-item",{staticClass:"item-total-price",attrs:{title:e.$t("nurse_booking.order_confirm.total_label"),after:"¥"+e.total}})],1)],1)}L.options.__file="addons/nurse_booking/1.0.0/src/pages/order-select-nurse.vue";var q=L.exports;function H(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function R(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function J(e){var t=!(1<arguments.length&&void 0!==arguments[1])||arguments[1];if(!V){var n,a;V=!0;var o,r=window.tommy,s=r.app.f7,i=e.teamId,c=e.productName,d=e.total,l=e.discount,u=void 0===l?0:l,_=e.location,v=e.date,p=e.couponId,g=e.orderId,f=e.nurse,m=e.vendor_order_items_attributes,b=e.duration,h="/nurse_booking/order-success/",k="/nurse_booking/order-error/",C={vendor_order_items_attributes:m,vendor_coupon_id:p||null,name:c,status:"pending",comment:"",assignee_id:f.user_id,assignee_team_id:i,data:{location:_,date:v,nurse:f,duration:b},discount:u,total:d},$=C.data.date;"string"==typeof $&&($=parseInt($,10)),o=C.data.duration&&0<C.data.duration?$+60*parseInt(C.data.duration,10)*1e3:$+36e5,C.event_attributes={addon:"nurse_booking",title:C.name,start_at:new Date($).toJSON(),end_at:new Date(o).toJSON(),location:"".concat(C.data.location.city," ").concat(C.data.location.address),user_id:C.user_id,team_id:null,assignee_id:C.data.nurse.user_id,assignee_team_id:i,kind:"Booking",resource_id:C.id,resource_type:"VendorOrder"},t?y.sendOrder(i,C).then(w).catch((function(){V=!1})):w(function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?H(Object(n),!0).forEach((function(t){R(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):H(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}({id:g},C))}function w(e){if(0===d)return y.cache.booking.transaction={},e.status="paid",void y.updateOrder(i,e).then((function(){V=!1,s.views.main.router.navigate("".concat(h,"?id=").concat(e.id))})).catch((function(){V=!1}));r.initWalletTransaction({addon:"nurse_booking",payee_name:c,currency:"CNY",amount:d,order_id:e.id},(function(t){var o=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{};n=!(V=!1),a||(y.cache.booking.transaction=t,e.status="paid",e.wallet_transaction_id=t.id,e.payment_method=o.paymentMethod||"card",e.data.payment_method=o.paymentMethod||"card",y.updateOrder(i,e).then((function(){s.views.main.router.navigate("".concat(h,"?id=").concat(e.id))})).catch((function(){V=!1})))}),(function(t){a=!(V=!1),n||y.cancelOrder(i,e.id).then((function(){s.views.main.router.navigate("".concat(k,"?id=").concat(e.id))})).catch((function(){s.views.main.router.navigate("".concat(k,"?id=").concat(e.id))}))}))}}var V=!(U._withStripped=!0),F=o({data:function(){return{services:y.cache.booking.services,coupon:y.cache.booking.coupon,user:this.$root.user,location:y.cache.booking.location,date:y.cache.booking.date,nurse:y.cache.booking.nurse}},computed:{couponDiscount:function(){var e=this.coupon,t=0;return e&&(t="percentage"!==e.kind?e.amount:e.amount*this.servicePrice),t>this.servicePrice&&(t=this.servicePrice),t},total:function(){return Math.max(this.servicePrice-this.couponDiscount,0)},servicePrice:function(){var e=this.services,t=0;return e.forEach((function(e){t+=e.price})),t},serviceImage:function(){var e=this.services[0];return e.image_url?e.image_url:"".concat(this.$addonAssetsUrl,"demo-package.png")},serviceName:function(){return this.services.map((function(e){return e.name})).join(", ")}},methods:{formatDate:D,selectCoupon:function(){var e=this;P(e.services[0].coupons,(function(t){y.cache.booking.coupon=t,e.coupon=t}),(function(){}),e.coupon)},onPageBeforeIn:function(e,t){"previous"===t.from&&(this.location=y.cache.booking.location,this.date=y.cache.booking.date,this.nurse=y.cache.booking.nurse)},payOrder:function(){var e=this,t=e.services,n=e.coupon,a=e.location,o=e.date,r=e.total,s=e.nurse,i=e.services.map((function(e){return{orderable_id:e.id,orderable_type:e.vendor_package_products?"VendorPackage":"VendorProduct",quantity:e.quantity||1}})),c=e.$root.team?e.$root.team.id:e.$addons.addons.nurse_booking.data.nursing_team_id,d=0;t.forEach((function(e){e.data&&e.data.duration&&(d+=parseInt(e.data.duration,10))})),d=d||60;var l=0;n&&(l=e.couponDiscount),J({vendor_order_items_attributes:i,teamId:c,productName:t.map((function(e){return e.name})).join(", "),productId:t[0].id,total:r,couponId:n?n.id:null,discount:l,location:a,date:o,nurse:s,duration:d})}}},U,[],!1,null,null,null);function G(){var e=this,t=e.$createElement,n=e._self._c||t;return n("f7-page",{attrs:{name:"nurse_booking__order-details",id:"nurse_booking__order-details"}},[n("f7-navbar",[e.$f7route.query.backToHome?n("tommy-nav-back",{attrs:{href:"/nurse_booking/",force:""}}):n("tommy-nav-back"),e._v(" "),n("f7-nav-title",[e._v(e._s(e.$t("nurse_booking.order_details.title")))])],1),e._v(" "),e.status?[e.status.canceled?n("div",{staticClass:"order-details-status"},[n("div",{staticClass:"order-details-status-title"},[e._v(e._s(e.$t("nurse_booking.order_details.status_canceled")))]),e._v(" "),n("div",{staticClass:"order-details-status-date"},[e._v(e._s(e.formatDate(e.date,"D MMM. YYYY")))]),e._v(" "),n("img",{attrs:{src:e.$addonAssetsUrl+"icon-status-canceled.svg"}})]):e._e(),e._v(" "),e.status.pending?n("div",{staticClass:"order-details-status"},[n("div",{staticClass:"order-details-status-title"},[e._v(e._s(e.$t("nurse_booking.order_details.status_pending")))]),e._v(" "),n("div",{staticClass:"order-details-status-date"},[e._v(e._s(e.formatDate(e.date,"D MMM. YYYY")))]),e._v(" "),n("img",{attrs:{src:e.$addonAssetsUrl+"icon-status-pending.svg"}})]):e._e(),e._v(" "),e.status.progress?n("div",{staticClass:"order-details-status"},[n("div",{staticClass:"order-details-status-title"},[e._v(e._s(e.$t("nurse_booking.order_details.status_progress")))]),e._v(" "),n("div",{staticClass:"order-details-status-date"},[e._v(e._s(e.formatDate(e.date,"D MMM. YYYY")))]),e._v(" "),n("img",{attrs:{src:e.$addonAssetsUrl+"icon-status-progress.svg"}})]):e._e(),e._v(" "),e.status.complete?n("div",{staticClass:"order-details-status"},[n("div",{staticClass:"order-details-status-title"},[e._v(e._s(e.$t("nurse_booking.order_details.status_complete")))]),e._v(" "),n("div",{staticClass:"order-details-status-date"},[e._v(e._s(e.formatDate(e.date,"D MMM. YYYY")))]),e._v(" "),n("img",{attrs:{src:e.$addonAssetsUrl+"icon-status-complete.svg"}})]):e._e()]:e._e(),e._v(" "),e.services?n("f7-list",{staticClass:"order-details-list",attrs:{"no-hairlines":""}},[e.nurse?n("f7-list-item",{attrs:{title:e.nurse.first_name+" "+e.nurse.last_name}},[n("span",{staticClass:"order-details-list-nurse-avatar",style:"background-image: url("+(e.nurse.icon_url||"")+")",attrs:{slot:"media"},slot:"media"})]):e._e(),e._v(" "),n("f7-list-item",{attrs:{title:e.$t("nurse_booking.order_details.service_label")+":",after:e.serviceName}}),e._v(" "),n("f7-list-item",{attrs:{title:e.$t("nurse_booking.order_details.time_label")+":",after:e.formatDate(e.date,"MMMM D, YYYY HH:mm")}}),e._v(" "),e.coupon?n("li",{staticClass:"item-content"},[n("div",{staticClass:"item-inner"},[n("div",{staticClass:"item-title"},[e._v(e._s(e.$t("nurse_booking.order_details.coupons_label"))+":")]),e._v(" "),n("div",{staticClass:"item-after price"},[e._v("-¥"+e._s(e.coupon.amount))])])]):e._e(),e._v(" "),n("li",{staticClass:"item-content item-total-price"},[n("div",{staticClass:"item-inner"},[n("div",{staticClass:"item-title"},[e._v(e._s(e.$t("nurse_booking.order_details.total_label"))+":")]),e._v(" "),n("div",{staticClass:"item-after price"},[e._v("¥"+e._s(e.total))])])]),e._v(" "),n("f7-list-item",{staticClass:"item-total-price",attrs:{title:e.$t("nurse_booking.order_details.payment_label")+":",after:e.transaction&&e.transaction.card_name?e.transaction.card_name:null}}),e._v(" "),e.status?[e.status.progress?n("a",{staticClass:"order-details-white-button",attrs:{href:"#"},on:{click:e.cancelOrder}},[e._v(e._s(e.$t("nurse_booking.order_details.cancel_button")))]):e._e(),e._v(" "),e.status.pending?n("a",{staticClass:"order-details-red-button",attrs:{href:"#"},on:{click:e.payOrder}},[e._v(e._s(e.$t("nurse_booking.order_details.pay_button")))]):e._e(),e._v(" "),e.status.complete||e.status.canceled?n("a",{staticClass:"order-details-red-button",attrs:{href:"#"},on:{click:e.repeatOrder}},[e._v(e._s(e.$t("nurse_booking.order_details.repeat_button")))]):e._e()]:e._e()],2):e._e()],2)}F.options.__file="addons/nurse_booking/1.0.0/src/pages/order-confirm.vue";var z=F.exports;G._withStripped=!0;var W=o({data:function(){var e=y.cache.booking,t=e.transaction,n=e.services,a=e.coupon,o=e.location,r=e.date,s=e.nurse,i={teamId:this.$root.team?this.$root.team.id:this.$addons.addons.nurse_booking.data.nursing_team_id,transaction:null,services:null,coupon:null,location:null,date:null,order:null,status:null,total:null,preventCancel:!1,nurse:null};return this.$f7route.query.id||Object.assign(i,{transaction:t,services:n,coupon:a,location:o,date:r,nurse:s}),i},computed:{totalComputed:function(){var e=this.services,t=this.coupon,n=this.total,a=0;e.forEach((function(e){a+=e.price}));var o=0;return t&&(o="percentage"!==t.kind?t.amount:t.amount*a),n||Math.max(a-o,0)},serviceName:function(){return this.services.map((function(e){return e.name})).join(", ")}},mounted:function(){var e=this;if(e.$f7route.query.masterDetailRoot){var t=e.$f7.navbar.getElByPage(e.$el);t&&e.$$(t).addClass("navbar-master-detail-root")}e.$f7route.query.id&&y.getOrderDetails(e.teamId,e.$f7route.query.id).then((function(t){var n=(e.order=t).canceled;e.status={pending:!n&&"pending"===t.status,canceled:n,progress:!n&&("paid"===t.status||"processing"===t.status),complete:!n&&"complete"===t.status},e.date=parseInt(t.data.date,10),e.nurse=t.data.nurse,e.transaction={card_name:t.wallet_transaction?t.wallet_transaction.card_name:null},e.total=t.total,t.vendor_coupon_id&&(e.coupon={id:t.vendor_coupon_id,kind:"fixed",amount:t.discount}),Promise.all(t.vendor_order_items.map((function(t){return y.getServiceDetails(e.teamId,t.orderable_id,t.orderable_type).then((function(e){return e.quantity=t.quantity,Promise.resolve(e)}))}))).then((function(t){e.services=t}))}))},methods:{formatDate:D,repeatOrder:function(){var e=this.order,t=this.services;e&&(y.cache.booking.date=parseInt(e.data.date,10),y.cache.booking.location=e.data.location,y.cache.booking.nurse=e.data.nurse,y.cache.booking.vendor_order_items_attributes=e.vendor_order_items.map((function(e){return{vendor_product_id:e.vendor_product_id,orderable_id:e.vendor_product_id,orderable_type:e.vendor_package_products?"VendorPackage":"VendorProduct",quantity:e.quantity}})),delete y.cache.booking.coupon,y.cache.booking.services=t,this.$f7router.navigate("/nurse_booking/order-confirm/"))},cancelOrder:function(){var e=this,t=e.order;t&&(e.preventCancel||(e.preventCancel=!0,e.$f7.dialog.confirm('\n        <div class="order-details-cancel-order-icon"></div>\n        <div>'.concat(e.$t("nurse_booking.order_details.cancel_confirm"),"</div>\n        "),(function(){y.cancelOrder(e.teamId,t.id,t.wallet_transaction_id,t).then((function(){e.preventCancel=!1,e.$f7router.navigate("/nurse_booking/order-canceled/")})).catch((function(){e.preventCancel=!1}))}),(function(){e.preventCancel=!1}))))},payOrder:function(){var e=this.order;J({teamId:this.teamId,vendor_order_items_attributes:(e.vendor_order_items||[]).map((function(e){return{orderable_id:e.vendor_product_id,orderable_type:e.vendor_package_products?"VendorPackage":"VendorProduct",quantity:e.quantity}})),orderId:e.id,productName:e.name,productId:e.vendor_product_id||e.vendor_order_items[0],total:e.total,couponId:e.vendor_coupon_id,discount:e.discount,location:e.data.location,date:e.data.date,nurse:e.data.nurse,duration:e.data.duration},!1)}}},G,[],!1,null,null,null);function K(){var e=this,t=e.$createElement,n=e._self._c||t;return n("f7-page",{attrs:{name:"nurse_booking__order-canceled",id:"nurse_booking__order-canceled","no-navbar":""}},[n("div",{staticClass:"order-status-title"},[e._v(e._s(e.$t("nurse_booking.order_canceled.title")))]),e._v(" "),n("div",{staticClass:"order-status-img"},[n("img",{attrs:{src:e.$addonAssetsUrl+"order-canceled.svg"}})]),e._v(" "),n("div",{staticClass:"order-status-message"},[e._v(e._s(e.$t("nurse_booking.order_canceled.message")))]),e._v(" "),n("div",{staticClass:"order-status-buttons no-master-detail"},[n("a",{attrs:{href:"/nurse_booking/","data-clear-previous-history":"true"}},[e._v(e._s(e.$t("nurse_booking.order_canceled.home_button")))])])])}W.options.__file="addons/nurse_booking/1.0.0/src/pages/order-details.vue";var X=W.exports;K._withStripped=!0;var Z=o({mounted:function(){document.addEventListener("backbutton",this.onBackButton)},beforeDestroy:function(){document.removeEventListener("backbutton",this.onBackButton)},methods:{onBackButton:function(){this.$f7router.back("/nurse_booking/",{force:!0})},onPageAfterIn:function(){var e=this;setTimeout((function(){e.$f7router.clearPreviousHistory()}),500)}}},K,[],!1,null,null,null);function Q(){var e=this,t=e.$createElement,n=e._self._c||t;return n("f7-page",{attrs:{name:"nurse_booking__order-error",id:"nurse_booking__order-error","no-navbar":""}},[n("div",{staticClass:"order-status-title"},[e._v(e._s(e.$t("nurse_booking.order_error.title")))]),e._v(" "),n("div",{staticClass:"order-status-img"},[n("img",{attrs:{src:e.$addonAssetsUrl+"order-success.svg"}})]),e._v(" "),n("div",{staticClass:"order-status-buttons"},[n("a",{attrs:{href:"/nurse_booking/order-details/?backToHome=true&id="+e.$f7route.query.id+"&masterDetailRoot=true"}},[e._v(e._s(e.$t("nurse_booking.order_error.details_button")))]),e._v(" "),n("a",{staticClass:"no-master-detail",attrs:{href:"/nurse_booking/","data-clear-previous-history":"true"}},[e._v(e._s(e.$t("nurse_booking.order_error.home_button")))])])])}Z.options.__file="addons/nurse_booking/1.0.0/src/pages/order-canceled.vue";var ee=Z.exports;Q._withStripped=!0;var te=o({mounted:function(){document.addEventListener("backbutton",this.onBackButton)},beforeDestroy:function(){document.removeEventListener("backbutton",this.onBackButton)},methods:{onBackButton:function(){this.$f7router.back("/nurse_booking/",{force:!0})},onPageAfterIn:function(){var e=this;setTimeout((function(){e.$f7router.clearPreviousHistory()}),500)}}},Q,[],!1,null,null,null);function ne(){var e=this,t=e.$createElement,n=e._self._c||t;return n("f7-page",{attrs:{name:"nurse_booking__order-success",id:"nurse_booking__order-success","no-navbar":""},on:{"page:afterin":e.onPageAfterIn}},[n("div",{staticClass:"order-status-title"},[e._v(e._s(e.$t("nurse_booking.order_success.title")))]),e._v(" "),n("div",{staticClass:"order-status-img"},[n("img",{attrs:{src:e.$addonAssetsUrl+"order-success.svg"}})]),e._v(" "),n("div",{staticClass:"order-status-buttons"},[n("a",{attrs:{href:"/nurse_booking/order-details/?backToHome=true&id="+e.$f7route.query.id+"&masterDetailRoot=true"}},[e._v(e._s(e.$t("nurse_booking.order_success.details_button")))]),e._v(" "),n("a",{staticClass:"no-master-detail",attrs:{href:"/nurse_booking/","data-clear-previous-history":"true"}},[e._v(e._s(e.$t("nurse_booking.order_success.home_button")))])])])}te.options.__file="addons/nurse_booking/1.0.0/src/pages/order-error.vue";var ae=te.exports;ne._withStripped=!0;var oe=o({mounted:function(){document.addEventListener("backbutton",this.onBackButton)},beforeDestroy:function(){document.removeEventListener("backbutton",this.onBackButton)},methods:{onBackButton:function(){this.$f7router.back("/nurse_booking/",{force:!0})},onPageAfterIn:function(){var e=this;setTimeout((function(){e.$f7router.clearPreviousHistory()}),500)}}},ne,[],!1,null,null,null);function re(){var e=this,t=e.$createElement,n=e._self._c||t;return n("f7-page",{attrs:{name:"nurse_booking__history",id:"nurse_booking__history"}},[n("f7-navbar",[n("tommy-nav-back"),e._v(" "),n("f7-nav-title",[e._v(e._s(e.$t("nurse_booking.history.title")))])],1),e._v(" "),e.ordersSorted?n("div",{staticClass:"orders-list"},e._l(e.ordersSorted,(function(t,a){return n("a",{key:a,staticClass:"order-item",attrs:{href:"/nurse_booking/order-details/?id="+t.id}},[n("div",{staticClass:"order-item-header"},[t.data?n("div",{staticClass:"order-item-date"},[e._v(e._s(e.formatDate(t.data.date,"D MMM YYYY")))]):e._e(),e._v(" "),n("div",{staticClass:"order-item-status"},[e._v(e._s(e.$t(t.statusKey)))])]),e._v(" "),n("div",{staticClass:"order-item-content"},[n("div",{staticClass:"order-item-details"},[n("div",{staticClass:"order-item-details-row"},[e._v(e._s(t.name))]),e._v(" "),t.data?n("div",{staticClass:"order-item-details-row order-item-details-date"},[e._v(e._s(e.formatDate(t.data.date,"MMM D, YYYY H:mm")))]):e._e()]),e._v(" "),n("div",{staticClass:"order-item-amount"},[e._v("¥"+e._s(t.total))])])])})),0):e._e()],1)}oe.options.__file="addons/nurse_booking/1.0.0/src/pages/order-success.vue";var se=oe.exports;re._withStripped=!0;var ie=o({data:function(){return{orders:null}},computed:{ordersSorted:function(){return this.orders?this.orders.sort((function(e,t){return t.id>e.id?1:t.id<e.id?-1:0})):null}},mounted:function(){var e=this;if(e.$f7route.query.masterDetailRoot){var t=e.$f7.navbar.getElByPage(e.$el);t&&e.$$(t).addClass("navbar-master-detail-root")}var n=e.$root.team?e.$root.team.id:e.$addons.addons.nurse_booking.data.nursing_team_id;y.getOrdersHistory(n).then((function(t){t.forEach((function(e){e.statusKey="nurse_booking.history.status_".concat(e.canceled?"canceled":e.status),e.data&&e.data.date&&(Number.isNaN(parseInt(e.data.date,10))||(e.data.date=parseInt(e.data.date,10)))})),e.orders=t}))},methods:{formatDate:D}},re,[],!1,null,null,null);ie.options.__file="addons/nurse_booking/1.0.0/src/pages/history.vue";var ce=[{path:"/nurse_booking/",component:i,master:!0},{path:"/nurse_booking/vip/",component:l},{path:"/nurse_booking/vip-details/",component:v},{path:"/nurse_booking/service-list/",component:O},{path:"/nurse_booking/service-details/:id/",component:I},{path:"/nurse_booking/order-select-location/",component:T},{path:"/nurse_booking/order-select-date/",component:Y},{path:"/nurse_booking/order-select-nurse/",component:q},{path:"/nurse_booking/order-confirm/",component:z},{path:"/nurse_booking/order-details/",component:X},{path:"/nurse_booking/order-canceled/",component:ee},{path:"/nurse_booking/order-error/",component:ae},{path:"/nurse_booking/order-success/",component:se},{path:"/nurse_booking/history/",component:ie.exports}];t.default=ce}]).default;