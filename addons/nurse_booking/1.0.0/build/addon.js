var addon=function(){var a=window.tommy.api,g={cache:{services:[],coupons:[],locations:[],booking:{}},getServiceList:function getServiceList(t){return a.call({endpoint:"vendors/"+t+"/products",method:"GET",data:{}}).then(function(t){return g.cache.services=t})},getServiceDetails:function getServiceDetails(t,e){return a.call({endpoint:"vendors/"+t+"/products/"+e,method:"GET"}).then(function(t){return t})},getCouponList:function getCouponList(t){return a.call({endpoint:"vendors/"+t+"/coupons",method:"GET",data:{}}).then(function(t){return g.cache.coupons=t})},getLocations:function getLocations(){return a.call({endpoint:"addons/nurse_booking/install/settings/locations",method:"GET"}).then(function(t){return g.cache.locations=t&&t.data&&t.data.locations?t.data.locations:[],g.cache.locations})},saveLocations:function saveLocations(t){return t?g.cache.locations=t:t=g.cache.locations,a.call({endpoint:"addons/nurse_booking/install/settings/locations",method:"PUT",data:{data:JSON.stringify({locations:t})}}).then(function(t){return t.data.locations})},addLocation:function addLocation(t){return t.default?(g.cache.locations.forEach(function(t){t.default=!1}),g.cache.locations.unshift(t)):g.cache.locations.push(t),g.saveLocations(g.cache.locations)},removeLocation:function removeLocation(t){return g.cache.locations.splice(t,1),g.saveLocations(g.cache.locations)},sendOrder:function sendOrder(t,e){return a.call({endpoint:"vendors/"+t+"/orders",method:"POST",data:e})},getOrdersHistory:function getOrdersHistory(t){return a.call({endpoint:"vendors/"+t+"/orders/",method:"GET"}).then(function(t){return g.cache.orders=t})},getOrderDetails:function getOrderDetails(t,e){return a.call({endpoint:"vendors/"+t+"/orders/"+e+"?with_wallet_transaction=true",method:"GET"}).then(function(t){return t})},cancelOrder:function cancelOrder(t,e){return a.call({endpoint:"vendors/"+t+"/orders/"+e,method:"DELETE"})}},t={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("f7-page",{attrs:{name:"nurse_booking__service-list",id:"nurse_booking__service-list"}},[a("f7-navbar",[a("tommy-nav-back"),e._v(" "),a("f7-nav-title",[e._v(e._s(e.$t("nurse_booking.service_list."+e.category.toLowerCase()+"_title")))])],1),e._v(" "),e.services?a("f7-swiper",{staticClass:"service-cards no-swipe-panel",attrs:{params:{centeredSlides:!0,slidesPerView:"auto",touchMoveStopPropagation:!1}}},e._l(e.services,function(t){return a("f7-swiper-slide",{key:t.id},[a("a",{staticClass:"service-card",attrs:{href:"/nurse_booking/service-details/"+t.id+"/"}},[a("div",{staticClass:"service-card-pic",style:"background-image:url("+e.$addonAssetsUrl+"demo-package.png"}),e._v(" "),a("div",{staticClass:"service-card-content"},[a("div",{staticClass:"service-card-title"},[e._v(e._s(t.name))]),e._v(" "),a("div",{staticClass:"service-card-duration"},[e._v(e._s(t.data.duration)+"min")]),e._v(" "),t.coupons.length?a("div",{staticClass:"service-card-coupons"},[e._v(e._s(t.coupons.length)+" Coupons")]):a("div",{staticClass:"service-card-price"},[e._v("¥ "+e._s(t.price))])])])])})):e._e()],1)},staticRenderFns:[],data:function data(){return{services:null,category:this.$f7route.query.category}},mounted:function mounted(){var o=this,t=o.$root.team.id;Promise.all([g.getServiceList(t),g.getCouponList(t)]).then(function(t){var e=t[0],a=t[1],s=e.filter(function(t){return t.category===o.category});s.forEach(function(e){e.coupons=a.filter(function(t){return t.vendor_product_id===e.id})}),o.services=s})}};function formatDate(t,e){var a=window.tommy.moment;return a(a.utc(t).toDate()).format(e)}var l=window.tommy;function couponPicker(e,t,a,s){var o,i,n=window.tommy.app.f7,r=e.map(function(t){return Object.assign({},t,{checked:!!s&&t.id===s.id})}),c=('\n  <div class="nurse_booking-coupon-picker">\n    <div class="coupon-picker-img">\n      <img src="'+l.addons.getAssetsUrl("nurse_booking")+'coupon-picker.svg" height="78">\n    </div>\n    <div class="coupon-picker-text">'+l.i18n.t("nurse_booking.coupon_picker.text")+'</div>\n    <div class="coupon-picker-items">\n      '+r.map(function(t){return('\n      <label>\n        <input type="radio" name="nurse_booking-coupon-picker-radio" value="'+t.id+'" '+(t.checked?"checked":"")+'>\n        <div class="coupon-item-content">\n          <div class="coupon-item-title">¥ '+t.amount+'</div>\n          <div class="coupon-item-name">'+t.name+'</div>\n          <div class="coupon-item-date">'+formatDate(t.expires_at,"D MMM YYYY")+'</div>\n        </div>\n        <div class="coupon-item-label">'+l.i18n.t("nurse_booking.coupon_picker.use_label")+"</div>\n      </label>\n      ").trim()}).join("")+"\n    </div>\n  </div>\n  ").trim(),d=n.dialog.create({content:c,cssClass:"nurse_booking-coupon-picker-modal",buttons:[{text:l.i18n.t("nurse_booking.coupon_picker.skip_button","Skip"),onClick:function onClick(){a&&a()}},{text:l.i18n.t("nurse_booking.coupon_picker.confirm_button","Confirm"),bold:!0,onClick:function onClick(){t&&t(i)}}]}).open().$el;d.find(".dialog-button-bold").addClass("dialog-button-disabled"),d.find("input").on("change",function(t){d.find(".dialog-button-bold").removeClass("dialog-button-disabled"),t.target.checked&&(o=t.target.value,e.forEach(function(t){t.id===parseInt(o,10)&&(i=t)}))})}function payOrder(t,s){void 0===s&&(s=!0);var e=window.tommy,o=e.app.f7,i=t.teamId,n=t.productName,r=t.productId,c=t.total,d=t.discount;void 0===d&&(d=0);var l=t.location,u=t.date,v=t.couponId,_=t.orderId;e.initWalletTransaction({addon:"nurse_booking",payee_name:n,currency:"CNY",amount:c},function(e){var t={vendor_product_id:r,vendor_coupon_id:v||null,wallet_transaction_id:e.id,name:n,status:"paid",comment:"",data:{location:l,date:u},discount:d,total:c},a="/nurse_booking/order-success/";s?g.sendOrder(i,t).then(function(t){g.cache.booking.transaction=e,o.views.main.router.navigate(a+"?id="+t.id)}):(g.cache.booking.transaction=e,o.views.main.router.navigate(a+"?id="+_))},function(e){if(e.id){var t={vendor_product_id:r,vendor_coupon_id:v||null,wallet_transaction_id:e.id,name:n,status:"pending",comment:"",data:{location:l,date:u},discount:d,total:c},a="/nurse_booking/order-error/";s?g.sendOrder(i,t).then(function(t){g.cache.booking.transaction=e,o.views.main.router.navigate(a+"?id="+t.id)}):(g.cache.booking.transaction=e,o.views.main.router.navigate(a+"?id="+_))}})}return[{path:"/nurse_booking/",component:{render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("f7-page",{attrs:{name:"nurse_booking__index",id:"nurse_booking__index"},on:{"page:beforein":t.onPageBeforeIn,"page:beforeout":t.onPageBeforeOut}},[a("f7-navbar",[a("tommy-nav-menu"),t._v(" "),a("f7-nav-title",[t._v(t._s(t.$t("nurse_booking.index.title","Nurse Booking")))])],1),t._v(" "),a("f7-swiper",{attrs:{pagination:""}},[a("f7-swiper-slide",{staticClass:"swiper-slide",style:"background-image: url("+t.$addonAssetUrl+"demo-slide.jpg)"}),t._v(" "),a("f7-swiper-slide",{staticClass:"swiper-slide",style:"background-image: url("+t.$addonAssetUrl+"demo-slide.jpg)"}),t._v(" "),a("f7-swiper-slide",{staticClass:"swiper-slide",style:"background-image: url("+t.$addonAssetUrl+"demo-slide.jpg)"})],1),t._v(" "),a("div",{staticClass:"sections"},[a("div",{staticClass:"section"},[a("a",{attrs:{href:"/nurse_booking/vip/"}},[a("img",{attrs:{src:t.$addonAssetUrl+"icon-vip.svg"}}),t._v(" "),a("span",[t._v(t._s(t.$t("nurse_booking.index.vip_label","VIP")))])])]),t._v(" "),a("div",{staticClass:"section"},[a("a",{attrs:{href:"/nurse_booking/service-list/?category=Nursing"}},[a("img",{attrs:{src:t.$addonAssetUrl+"icon-nursing.svg"}}),t._v(" "),a("span",[t._v(t._s(t.$t("nurse_booking.index.nursing_label","Nursing")))])])]),t._v(" "),a("div",{staticClass:"section"},[a("a",{attrs:{href:"/nurse_booking/service-list/?category=Cleaning"}},[a("img",{attrs:{src:t.$addonAssetUrl+"icon-cleaning.svg"}}),t._v(" "),a("span",[t._v(t._s(t.$t("nurse_booking.index.cleaning_label","Cleaning")))])])]),t._v(" "),a("div",{staticClass:"section"},[a("a",{attrs:{href:"/nurse_booking/service-list/?category=Massage"}},[a("img",{attrs:{src:t.$addonAssetUrl+"icon-massage.svg"}}),t._v(" "),a("span",[t._v(t._s(t.$t("nurse_booking.index.massage_label","Massage")))])])]),t._v(" "),a("div",{staticClass:"section"},[a("a",{attrs:{href:"/nurse_booking/history/"}},[a("img",{attrs:{src:t.$addonAssetUrl+"icon-booking.svg"}}),t._v(" "),a("span",[t._v(t._s(t.$t("nurse_booking.index.booking_label","Booking")))])])]),t._v(" "),a("div",{staticClass:"section"},[a("a",{staticClass:"external",attrs:{href:"tommy://addon?package=wallet&back=true"}},[a("img",{attrs:{src:t.$addonAssetUrl+"icon-wallet.svg"}}),t._v(" "),a("span",[t._v(t._s(t.$t("nurse_booking.index.wallet_label","Wallet")))])])])])],1)},staticRenderFns:[],beforeDestroy:function beforeDestroy(){this.$f7router.view.$navbarEl.removeClass("nurse-booking-index-navbar")},methods:{onPageBeforeIn:function onPageBeforeIn(){this.$f7router.view.$navbarEl.addClass("nurse-booking-index-navbar")},onPageBeforeOut:function onPageBeforeOut(){this.$f7router.view.$navbarEl.removeClass("nurse-booking-index-navbar")}}}},{path:"/nurse_booking/vip/",component:{render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("f7-page",{attrs:{name:"nurse_booking__vip",id:"nurse_booking__vip"},on:{"page:beforein":t.onPageBeforeIn,"page:beforeout":t.onPageBeforeOut}},[a("f7-navbar",[a("tommy-nav-back")],1),t._v(" "),a("div",{staticClass:"vip-header"},[a("div",{staticClass:"avatar",style:"background-image: url("+t.$addonAssetsUrl+"demo-avatar.png"},[a("div",{staticClass:"medal medal-green"})]),t._v(" "),a("div",{staticClass:"name"},[t._v("Allen Zhang")])]),t._v(" "),a("div",{staticClass:"vip-info"},[t._v(t._s(t.$t("nurse_booking.vip.info")))]),t._v(" "),a("div",{staticClass:"vip-plans"},[a("a",{staticClass:"vip-plan vip-plan-green",attrs:{href:"/nurse_booking/vip-details/"}},[a("div",{staticClass:"vip-plan-badge"},[t._v(t._s(t.$t("nurse_booking.vip.current_plan_badge")))]),t._v(" "),a("div",{staticClass:"vip-plan-title"},[t._v(t._s(t.$t("nurse_booking.vip.plan_green")))])]),t._v(" "),a("a",{staticClass:"vip-plan vip-plan-gold",attrs:{href:"/nurse_booking/vip-details/"}},[a("div",{staticClass:"vip-plan-badge"},[t._v(t._s(t.$t("nurse_booking.vip.recommended_plan_badge")))]),t._v(" "),a("div",{staticClass:"vip-plan-title"},[t._v(t._s(t.$t("nurse_booking.vip.plan_gold")))])]),t._v(" "),a("a",{staticClass:"vip-plan vip-plan-platinum",attrs:{href:"/nurse_booking/vip-details/"}},[a("div",{staticClass:"vip-plan-title"},[t._v(t._s(t.$t("nurse_booking.vip.plan_platinum")))])])])],1)},staticRenderFns:[],methods:{onPageBeforeIn:function onPageBeforeIn(){this.$f7router.view.$navbarEl.addClass("nurse-booking-vip-navbar")},onPageBeforeOut:function onPageBeforeOut(t,e){"previous"!==e.to&&this.$f7router.view.$navbarEl.removeClass("nurse-booking-vip-navbar")}}}},{path:"/nurse_booking/vip-details/",component:{render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("f7-page",{attrs:{name:"nurse_booking__vip-details",id:"nurse_booking__vip-details"},on:{"page:beforein":t.onPageBeforeIn,"page:beforeout":t.onPageBeforeOut}},[a("f7-navbar",[a("tommy-nav-back")],1),t._v(" "),a("div",{staticClass:"vip-header"},[a("div",{staticClass:"avatar",style:"background-image: url("+t.$addonAssetsUrl+"demo-avatar.png"},[a("div",{staticClass:"medal medal-green"})]),t._v(" "),a("div",{staticClass:"name"},[t._v("Allen Zhang")])]),t._v(" "),a("div",{staticClass:"vip-plan-details"},[a("div",{staticClass:"vip-plan-current"},[t._v(t._s(t.$t("nurse_booking.vip.plan_green")))]),t._v(" "),a("div",{staticClass:"vip-plan-expiration"},[t._v("Expires 3rd April")])]),t._v(" "),a("div",{staticClass:"list vip-details-list"},[a("ul",[a("li",{staticClass:"item-divider"},[t._v(t._s(t.$t("nurse_booking.vip.details_plan_inclusion")))]),t._v(" "),a("li",{staticClass:"item-content"},[a("div",{staticClass:"item-inner"},[a("div",{staticClass:"item-title"},[a("div",[t._v("Nurse Visit")]),t._v(" "),a("div",{staticClass:"item-subtitle"},[a("b",[t._v("Four")]),t._v(" ("),a("b",[t._v("one")]),t._v(" time left) per month ")])])])]),t._v(" "),a("li",{staticClass:"item-content"},[a("div",{staticClass:"item-inner"},[a("div",{staticClass:"item-title"},[a("div",[t._v("Clean")]),t._v(" "),a("div",{staticClass:"item-subtitle"},[a("b",[t._v("Four+One")]),t._v(" per month ")])])])]),t._v(" "),a("li",{staticClass:"item-content"},[a("div",{staticClass:"item-inner"},[a("div",{staticClass:"item-title"},[a("div",[t._v("Massage")])])])]),t._v(" "),a("li",{staticClass:"item-divider"},[t._v(t._s(t.$t("nurse_booking.vip.details_administration")))]),t._v(" "),a("li",[a("a",{staticClass:"item-content item-link",attrs:{href:"#"}},[a("div",{staticClass:"item-inner"},[a("div",{staticClass:"item-title"},[t._v("Change Subscription")])])])]),t._v(" "),a("li",[a("a",{staticClass:"item-content item-link",attrs:{href:"#"}},[a("div",{staticClass:"item-inner"},[a("div",{staticClass:"item-title"},[t._v("Coupon")]),t._v(" "),a("div",{staticClass:"item-after"},[a("b",[t._v("4 Sheets")])])])])])])])],1)},staticRenderFns:[],methods:{onPageBeforeIn:function onPageBeforeIn(){},onPageBeforeOut:function onPageBeforeOut(){}}}},{path:"/nurse_booking/service-list/",component:t},{path:"/nurse_booking/service-details/:id/",component:{render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("f7-page",{attrs:{name:"nurse_booking__service-details",id:"nurse_booking__service-details"}},[a("f7-navbar",[a("tommy-nav-back"),t._v(" "),a("f7-nav-title",[t._v(t._s(t.service.name))])],1),t._v(" "),a("a",{staticClass:"nurse_booking__toolbar-button",attrs:{slot:"fixed"},on:{click:t.book},slot:"fixed"},[t._v(t._s(t.$t("nurse_booking.service_details.book_button")))]),t._v(" "),a("div",{staticClass:"service-details-header"},[a("f7-swiper",{attrs:{pagination:""}},[a("div",{staticClass:"swiper-slide",style:"background-image: url("+t.$addonAssetUrl+"demo-package.png)"}),t._v(" "),a("div",{staticClass:"swiper-slide",style:"background-image: url("+t.$addonAssetUrl+"demo-package.png)"}),t._v(" "),a("div",{staticClass:"swiper-slide",style:"background-image: url("+t.$addonAssetUrl+"demo-package.png)"})])],1),t._v(" "),a("div",{staticClass:"service-details-meta"},[a("div",{staticClass:"service-details-meta-wrap"},[a("div",{staticClass:"service-details-meta-left"},[a("div",{staticClass:"service-details-title"},[t._v(t._s(t.service.name))]),t._v(" "),a("div",{staticClass:"service-details-duration"},[t._v(t._s(t.service.data.duration)+"min")])]),t._v(" "),a("div",{staticClass:"service-details-price"},[t._v("¥ "+t._s(t.service.price))])]),t._v(" "),t.service.coupons.length?a("a",{staticClass:"service-details-coupons-link",on:{click:t.chooseCoupon}},[a("span",[t._v(t._s(t.service.coupons.length)+" coupons available")])]):t._e()]),t._v(" "),a("div",{staticClass:"service-details-content"},[a("div",{staticClass:"service-details-label"},[t._v(t._s(t.$t("nurse_booking.service_details.service_details_label"))+":")]),t._v(" "),a("div",{staticClass:"service-details-text"},[a("p",[t._v(" "+t._s(t.service.description)+" ")])])])],1)},staticRenderFns:[],props:{id:[Number,String]},data:function data(){var e=this,a={};return(g.cache.services||[]).forEach(function(t){t.id===parseInt(e.id,10)&&((a=t).coupons=g.cache.coupons.filter(function(t){return t.vendor_product_id===a.id}))}),{service:a,selectedCoupon:null}},mounted:function mounted(){},methods:{book:function book(){var e=this,a=e.service;(g.cache.booking.service=a).coupons&&a.coupons.length?couponPicker(a.coupons,function(t){e.selectedCoupon=t,g.cache.booking.service=a,g.cache.booking.coupon=e.selectedCoupon,e.$f7router.navigate("/nurse_booking/order-select-location/")},function(){g.cache.booking.coupon=null,delete g.cache.booking.coupon,e.selectedCoupon=null,e.$f7router.navigate("/nurse_booking/order-select-location/")}):(g.cache.booking.coupon=null,delete g.cache.booking.coupon,e.selectedCoupon=null,e.$f7router.navigate("/nurse_booking/order-select-location/"))},chooseCoupon:function chooseCoupon(){var e=this;couponPicker(e.service.coupons,function(t){e.selectedCoupon=t,g.cache.booking.service=e.service,g.cache.booking.coupon=e.selectedCoupon,e.$f7router.navigate("/nurse_booking/order-select-location/")},function(){e.selectedCoupon=null})}}}},{path:"/nurse_booking/order-select-location/",component:{render:function(){var s=this,t=s.$createElement,o=s._self._c||t;return o("f7-page",{attrs:{name:"nurse_booking__location",id:"nurse_booking__location"}},[o("f7-navbar",[o("tommy-nav-back"),s._v(" "),o("f7-nav-title",[s._v(s._s(s.$t("nurse_booking.location.title")))])],1),s._v(" "),s._l(s.locations,function(e,a){return s.locations&&s.locations.length?o("div",{key:a,staticClass:"location-card"},[o("i",{staticClass:"location-card-icon"}),s._v(" "),o("div",{staticClass:"location-card-title"},[e.default?o("span",{staticClass:"location-card-default-badge"},[s._v("["+s._s(s.$t("nurse_booking.location.default_label"))+"]")]):s._e(),s._v(" "+s._s(e.city)+" "+s._s(e.address)+" ")]),s._v(" "),o("a",{staticClass:"location-delete-button",attrs:{href:"#"},on:{click:function(t){s.deleteLocation(e,a)}}}),s._v(" "),o("a",{staticClass:"location-card-button location-select-button",attrs:{href:"#"},on:{click:function(t){s.selectLocation(e,a)}}},[s._v(s._s(s.$t("nurse_booking.location.select_button")))])]):s._e()}),s._v(" "),s.addMode||s.locations&&!s.locations.length?o("div",{staticClass:"location-card location-add-form"},[o("input",{attrs:{type:"text",placeholder:s.$t("nurse_booking.location.city_placeholder")},domProps:{value:s.city},on:{input:function(t){s.city=t.target.value}}}),s._v(" "),o("textarea",{attrs:{type:"text",placeholder:s.$t("nurse_booking.location.address_placeholder")},domProps:{value:s.address},on:{input:function(t){s.address=t.target.value}}}),s._v(" "),o("label",[o("input",{attrs:{type:"checkbox",name:"default"},domProps:{checked:s.isDefault},on:{change:function(t){s.isDefault=t.target.checked}}}),s._v(" "),o("i",{staticClass:"framework7-icons"},[s._v("check")]),s._v(" "),o("span",[s._v(s._s(s.$t("nurse_booking.location.set_default_label")))])]),s._v(" "),o("a",{staticClass:"location-card-button location-save-button",attrs:{href:"#"},on:{click:function(t){s.saveLocation()}}},[s._v(s._s(s.$t("nurse_booking.location.save_button")))])]):s._e(),s._v(" "),s.locations&&s.locations.length?o("a",{staticClass:"location-add-button",attrs:{href:"#"},on:{click:function(t){s.addLocation()}}},[s._v(s._s(s.$t("nurse_booking.location.add_button")))]):s._e()],2)},staticRenderFns:[],data:function data(){return{service:g.cache.booking.service,locations:null,addMode:!1,city:"",address:"",isDefault:!1}},mounted:function mounted(){var t=this;g.getLocations().then(function(){t.locations=[].concat(g.cache.locations||[])})},methods:{deleteLocation:function deleteLocation(t,e){var a=this;g.removeLocation(e).then(function(){a.locations.splice(e,1)})},selectLocation:function selectLocation(t){var e,a=this,s=t.city,o=a.service;(o.data.available_in||o.data.availabile_in||[]).forEach(function(t){t.toLowerCase()===s.toLowerCase()&&(e=!0)}),e?(g.cache.booking.location=t,a.$f7route.query.back?a.$f7router.back():a.$f7router.navigate("/nurse_booking/order-select-date/")):a.$f7.dialog.alert(a.$t("nurse_booking.location.not_available"))},saveLocation:function saveLocation(){var t=this,e=t.city,a=t.address,s=t.isDefault;e&&a&&g.addLocation({city:e,address:a,default:s}).then(function(){t.locations=[].concat(g.cache.locations||[]),t.addMode=!1,t.city="",t.address="",t.isDefault=!1})},addLocation:function addLocation(){this.addMode=!0}}}},{path:"/nurse_booking/order-select-date/",component:{render:function(){var a=this,t=a.$createElement,s=a._self._c||t;return s("f7-page",{attrs:{name:"nurse_booking__date-time",id:"nurse_booking__date-time"}},[s("f7-navbar",[s("tommy-nav-back"),a._v(" "),s("f7-nav-title",[a._v(a._s(a.$t("nurse_booking.date_time.title")))])],1),a._v(" "),s("a",{staticClass:"nurse_booking__toolbar-button",class:{disabled:!a.selectedDate||!a.selectedHours},attrs:{slot:"fixed",href:"#"},on:{click:a.selectDateTime},slot:"fixed"},[a._v(a._s(a.$t("nurse_booking.date_time.determine_button")))]),a._v(" "),s("div",{staticClass:"date-time-dates"},a._l(a.dates,function(e,t){return s("label",{key:t,staticClass:"date-time-date",class:{"date-time-date-disabled":e.disabled}},[s("input",{attrs:{type:"radio",disabled:e.disabled},domProps:{checked:a.selectedDate===e.value},on:{change:function(t){a.selectedDate=e.value}}}),a._v(" "),s("div",{staticClass:"date-time-date-num"},[a._v(a._s(e.day)+"."+a._s(e.month))]),a._v(" "),e.today?s("div",{staticClass:"date-time-date-day"},[a._v("Today")]):s("div",{staticClass:"date-time-date-day"},[a._v(a._s(e.weekDay))])])})),a._v(" "),s("div",{staticClass:"date-time-hours"},a._l(a.hours,function(e,t){return s("label",{key:t,staticClass:"date-time-hour",class:{disabled:e.disabled}},[s("input",{attrs:{type:"radio",disabled:e.disabled},domProps:{checked:a.selectedHours===e.value},on:{change:function(t){a.selectedHours=e.value}}}),a._v(" "),s("span",[a._v(a._s(e.hour))])])}))],1)},staticRenderFns:[],data:function data(){for(var t,e=new Date,a=e.getTime(),s=[],o=0;o<=13;o+=1){var i=new Date(a+24*o*60*60*1e3),n=i.getMonth()+1,r=i.getDate();r<10&&(r="0"+r),n<10&&(n="0"+n);var c=i.getDay(),d=!!(0===o)&&19<=e.getHours();d&&(t=!0),s.push({disabled:d,value:new Date(i.getFullYear(),i.getMonth(),i.getDate()).getTime(),day:r,month:n,weekDay:this.$t("nurse_booking.date_time.week_days."+c)})}var l,u,v=this.$f7route.query.date&&new Date(parseInt(this.$f7route.query.date,10));return v&&(l=new Date(v.getFullYear(),v.getMonth(),v.getDate()).getTime(),u=v.getHours()),{service:g.cache.booking.service,dates:s,selectedDate:l||(t?s[1].value:s[0].value),selectedHours:u||null}},watch:{selectedDate:function selectedDate(){this.selectedHours=null}},computed:{hours:function hours(){var t,e=new Date(this.selectedDate),hours=[],a=new Date;a.getFullYear()===e.getFullYear()&&a.getMonth()===e.getMonth()&&a.getDate()===e.getDate()&&(t=!0);for(var s=10;s<=19;s+=1){var o=!!t&&a.getHours()>=s;hours.push({value:s,disabled:o,hour:s+":00"})}return hours}},methods:{selectDateTime:function selectDateTime(){var t=this,e=t.selectedDate,a=t.selectedHours;g.cache.booking.date=new Date(parseInt(e,10)).getTime()+60*a*60*1e3,t.$f7route.query.back?t.$f7router.back():t.$f7router.navigate("/nurse_booking/order-confirm/")}}}},{path:"/nurse_booking/order-confirm/",component:{render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("f7-page",{attrs:{name:"nurse_booking__order-confirm",id:"nurse_booking__order-confirm"},on:{"page:beforein":t.onPageBeforeIn}},[a("f7-navbar",[a("tommy-nav-back"),t._v(" "),a("f7-nav-title",[t._v(t._s(t.$t("nurse_booking.order_confirm.title")))])],1),t._v(" "),a("a",{staticClass:"nurse_booking__toolbar-button service-book-button",attrs:{slot:"fixed",href:"#"},on:{click:t.payOrder},slot:"fixed"},[t._v(t._s(t.$t("nurse_booking.order_confirm.pay_button")))]),t._v(" "),a("div",{staticClass:"service-details-block"},[a("div",{staticClass:"service-image",style:"background-image: url("+t.$addonAssetUrl+"demo-package.png)"}),t._v(" "),a("div",{staticClass:"service-details"},[a("div",{staticClass:"service-title"},[t._v(t._s(t.service.name))]),t._v(" "),a("div",{staticClass:"service-price"},[t._v("¥"+t._s(t.service.price))])])]),t._v(" "),a("f7-list",{attrs:{"no-hairlines":""}},[a("f7-list-item",{attrs:{title:t.formatDate(t.date,"MMMM D, YYYY HH:mm"),link:"/nurse_booking/order-select-date/?date="+new Date(t.date).getTime()+"&back=true"}},[a("img",{attrs:{slot:"media",src:t.$addonAssetsUrl+"icon-time.svg"},slot:"media"})])],1),t._v(" "),a("f7-list",{attrs:{"no-hairlines":""}},[a("f7-list-item",{attrs:{title:t.user.first_name+" "+t.user.last_name}},[a("img",{attrs:{slot:"media",src:t.$addonAssetsUrl+"icon-user.svg"},slot:"media"})]),t._v(" "),t.user.mobile?a("f7-list-item",{attrs:{title:t.user.mobile}},[a("img",{attrs:{slot:"media",src:t.$addonAssetsUrl+"icon-phone.svg"},slot:"media"})]):t._e(),t._v(" "),a("f7-list-item",{attrs:{link:"/nurse_booking/order-select-location/?back=true"}},[a("span",{staticClass:"location-default-badge",attrs:{slot:"title"},slot:"title"},[t._v("["+t._s(t.$t("nurse_booking.location.default_label"))+"]")]),t._v(" "),a("span",{attrs:{slot:"title"},slot:"title"},[t._v(t._s(t.location.city)+" "+t._s(t.location.address))]),t._v(" "),a("img",{attrs:{slot:"media",src:t.$addonAssetsUrl+"icon-location.svg"},slot:"media"})])],1),t._v(" "),a("f7-list",{staticClass:"list-prices",attrs:{"no-hairlines":""}},[t.coupon?a("f7-list-item",{attrs:{link:"#",title:t.$t("nurse_booking.order_confirm.coupons_label"),after:"-¥"+t.coupon.amount},on:{click:t.selectCoupon}}):t._e(),t._v(" "),a("f7-list-item",{staticClass:"item-total-price",attrs:{title:t.$t("nurse_booking.order_confirm.total_label"),after:"¥"+t.total}})],1)],1)},staticRenderFns:[],data:function data(){return{service:g.cache.booking.service,coupon:g.cache.booking.coupon,user:this.$root.user,location:g.cache.booking.location,date:g.cache.booking.date}},watch:{},computed:{total:function total(){var t=this.service,e=this.coupon;return t.price-(e?e.amount:0)}},methods:{formatDate:formatDate,selectCoupon:function selectCoupon(){var e=this;couponPicker(e.service.coupons,function(t){g.cache.booking.coupon=t,e.coupon=t},function(){},e.coupon)},onPageBeforeIn:function onPageBeforeIn(t,e){"previous"===e.from&&(this.location=g.cache.booking.location,this.date=g.cache.booking.date)},payOrder:function payOrder$1(){var t=this,e=t.service,a=t.coupon,s=t.location,o=t.date,i=t.total;payOrder({teamId:t.$root.team.id,productName:e.name,productId:e.id,total:i,couponId:a?a.id:null,discount:a?a.amount:0,location:s,date:o})}}}},{path:"/nurse_booking/order-details/",component:{render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("f7-page",{attrs:{name:"nurse_booking__order-details",id:"nurse_booking__order-details"}},[a("f7-navbar",[t.$f7route.query.backToHome?a("tommy-nav-back",{attrs:{href:"/",force:""}}):a("tommy-nav-back"),t._v(" "),a("f7-nav-title",[t._v(t._s(t.$t("nurse_booking.order_details.title")))])],1),t._v(" "),t.status?[t.status.canceled?a("div",{staticClass:"order-details-status"},[a("div",{staticClass:"order-details-status-title"},[t._v(t._s(t.$t("nurse_booking.order_details.status_canceled")))]),t._v(" "),a("div",{staticClass:"order-details-status-date"},[t._v(t._s(t.formatDate(t.date,"D MMM. YYYY")))]),t._v(" "),a("img",{attrs:{src:t.$addonAssetsUrl+"icon-status-canceled.svg"}})]):t._e(),t._v(" "),t.status.pending?a("div",{staticClass:"order-details-status"},[a("div",{staticClass:"order-details-status-title"},[t._v(t._s(t.$t("nurse_booking.order_details.status_pending")))]),t._v(" "),a("div",{staticClass:"order-details-status-date"},[t._v(t._s(t.formatDate(t.date,"D MMM. YYYY")))]),t._v(" "),a("img",{attrs:{src:t.$addonAssetsUrl+"icon-status-pending.svg"}})]):t._e(),t._v(" "),t.status.progress?a("div",{staticClass:"order-details-status"},[a("div",{staticClass:"order-details-status-title"},[t._v(t._s(t.$t("nurse_booking.order_details.status_progress")))]),t._v(" "),a("div",{staticClass:"order-details-status-date"},[t._v(t._s(t.formatDate(t.date,"D MMM. YYYY")))]),t._v(" "),a("img",{attrs:{src:t.$addonAssetsUrl+"icon-status-progress.svg"}})]):t._e(),t._v(" "),t.status.complete?a("div",{staticClass:"order-details-status"},[a("div",{staticClass:"order-details-status-title"},[t._v(t._s(t.$t("nurse_booking.order_details.status_complete")))]),t._v(" "),a("div",{staticClass:"order-details-status-date"},[t._v(t._s(t.formatDate(t.date,"D MMM. YYYY")))]),t._v(" "),a("img",{attrs:{src:t.$addonAssetsUrl+"icon-status-complete.svg"}})]):t._e()]:t._e(),t._v(" "),t.service?a("f7-list",{staticClass:"order-details-list",attrs:{"no-hairlines":""}},[a("f7-list-item",{attrs:{title:t.$t("nurse_booking.order_details.service_label")+":",after:t.service.name}}),t._v(" "),a("f7-list-item",{attrs:{title:t.$t("nurse_booking.order_details.time_label")+":",after:t.formatDate(t.date,"MMMM D, YYYY HH:mm")}}),t._v(" "),t.coupon?a("li",{staticClass:"item-content"},[a("div",{staticClass:"item-inner"},[a("div",{staticClass:"item-title"},[t._v(t._s(t.$t("nurse_booking.order_details.coupons_label"))+":")]),t._v(" "),a("div",{staticClass:"item-after price"},[t._v("-¥"+t._s(t.coupon.amount))])])]):t._e(),t._v(" "),a("li",{staticClass:"item-content item-total-price"},[a("div",{staticClass:"item-inner"},[a("div",{staticClass:"item-title"},[t._v(t._s(t.$t("nurse_booking.order_details.total_label"))+":")]),t._v(" "),a("div",{staticClass:"item-after price"},[t._v("¥"+t._s(t.total))])])]),t._v(" "),a("f7-list-item",{staticClass:"item-total-price",attrs:{title:t.$t("nurse_booking.order_details.payment_label")+":",after:t.transaction?t.transaction.card_name:null}}),t._v(" "),t.status?[t.status.progress?a("a",{staticClass:"order-details-white-button",attrs:{href:"#"},on:{click:t.cancelOrder}},[t._v(t._s(t.$t("nurse_booking.order_details.cancel_button")))]):t._e(),t._v(" "),t.status.pending?a("a",{staticClass:"order-details-red-button",attrs:{href:"#"},on:{click:t.payOrder}},[t._v(t._s(t.$t("nurse_booking.order_details.pay_button")))]):t._e(),t._v(" "),t.status.complete||t.status.canceled?a("a",{staticClass:"order-details-red-button",attrs:{href:"#"},on:{click:t.repeatOrder}},[t._v(t._s(t.$t("nurse_booking.order_details.repeat_button")))]):t._e()]:t._e()],2):t._e()],2)},staticRenderFns:[],data:function data(){var t=g.cache.booking,e=t.transaction,a=t.service,s=t.coupon,o=t.location,i=t.date,data={transaction:null,service:null,coupon:null,location:null,date:null,order:null,status:null,total:null,preventCancel:!1};return this.$f7route.query.id||Object.assign(data,{transaction:e,service:a,coupon:s,location:o,date:i}),data},computed:{totalComputed:function totalComputed(){var t=this.service,e=this.coupon;return this.total||t.price-(e?e.amount:0)}},mounted:function mounted(){var a=this;a.$f7route.query.id&&g.getOrderDetails(a.$root.team.id,a.$f7route.query.id).then(function(t){var e=(a.order=t).canceled;a.status={pending:!e&&"pending"===t.status,canceled:e,progress:!e&&("paid"===t.status||"processing"===t.status),complete:!e&&"complete"===t.status},a.date=parseInt(t.data.date,10),a.service={name:t.name,id:t.vendor_product_id},a.transaction={card_name:t.wallet_transaction.card_name},a.total=t.total,t.vendor_coupon_id&&(a.coupon={id:t.vendor_coupon_id,amount:t.discount})})},methods:{formatDate:formatDate,repeatOrder:function repeatOrder(){var e=this,t=e.order;t&&(g.cache.booking.date=parseInt(t.data.date,10),g.cache.booking.location=t.data.location,delete g.cache.booking.coupon,g.getServiceDetails(e.$root.team.id,t.vendor_product_id).then(function(t){g.cache.booking.service=t,e.$f7router.navigate("/nurse_booking/order-confirm/")}))},cancelOrder:function cancelOrder(){var t=this,e=t.order;e&&(t.preventCancel||(t.preventCancel=!0,t.$f7.dialog.confirm('\n        <div class="order-details-cancel-order-icon"></div>\n        <div>'+t.$t("nurse_booking.order_details.cancel_confirm")+"</div>\n        ",function(){g.cancelOrder(t.$root.team.id,e.id).then(function(){t.preventCancel=!1,t.$f7router.navigate("/nurse_booking/order-canceled/")}).catch(function(){t.preventCancel=!1})},function(){t.preventCancel=!1})))},payOrder:function payOrder$1(){var t=this.order;payOrder({teamId:this.$root.team.id,orderId:t.id,productName:t.name,productId:t.vendor_product_id,total:t.total,couponId:t.vendor_coupon_id,discount:t.discount,location:t.data.location,date:t.data.date},!1)}}}},{path:"/nurse_booking/order-canceled/",component:{render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("f7-page",{attrs:{name:"nurse_booking__order-canceled",id:"nurse_booking__order-canceled","no-navbar":""}},[a("div",{staticClass:"order-status-title"},[t._v(t._s(t.$t("nurse_booking.order_canceled.title")))]),t._v(" "),a("div",{staticClass:"order-status-img"},[a("img",{attrs:{src:t.$addonAssetsUrl+"order-canceled.svg"}})]),t._v(" "),a("div",{staticClass:"order-status-message"},[t._v(t._s(t.$t("nurse_booking.order_canceled.message")))]),t._v(" "),a("div",{staticClass:"order-status-buttons"},[a("a",{attrs:{href:"/nurse_booking/","data-clear-previous-history":"true"}},[t._v(t._s(t.$t("nurse_booking.order_canceled.home_button")))])])])},staticRenderFns:[]}},{path:"/nurse_booking/order-error/",component:{render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("f7-page",{attrs:{name:"nurse_booking__order-error",id:"nurse_booking__order-error","no-navbar":""}},[a("div",{staticClass:"order-status-title"},[t._v(t._s(t.$t("nurse_booking.order_error.title")))]),t._v(" "),a("div",{staticClass:"order-status-img"},[a("img",{attrs:{src:t.$addonAssetsUrl+"order-success.svg"}})]),t._v(" "),a("div",{staticClass:"order-status-buttons"},[a("a",{attrs:{href:"/nurse_booking/order-details/"}},[t._v(t._s(t.$t("nurse_booking.order_error.details_button")))]),t._v(" "),a("a",{attrs:{href:"/nurse_booking/","data-clear-previous-history":"true"}},[t._v(t._s(t.$t("nurse_booking.order_error.home_button")))])])])},staticRenderFns:[]}},{path:"/nurse_booking/order-success/",component:{render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("f7-page",{attrs:{name:"nurse_booking__order-success",id:"nurse_booking__order-success","no-navbar":""}},[a("div",{staticClass:"order-status-title"},[t._v(t._s(t.$t("nurse_booking.order_success.title")))]),t._v(" "),a("div",{staticClass:"order-status-img"},[a("img",{attrs:{src:t.$addonAssetsUrl+"order-success.svg"}})]),t._v(" "),a("div",{staticClass:"order-status-buttons"},[a("a",{attrs:{href:"/nurse_booking/order-details/?backToHome=true&id="+t.$f7route.query.id}},[t._v(t._s(t.$t("nurse_booking.order_success.details_button")))]),t._v(" "),a("a",{attrs:{href:"/nurse_booking/","data-clear-previous-history":"true"}},[t._v(t._s(t.$t("nurse_booking.order_success.home_button")))])])])},staticRenderFns:[]}},{path:"/nurse_booking/history/",component:{render:function(){var a=this,t=a.$createElement,s=a._self._c||t;return s("f7-page",{attrs:{name:"nurse_booking__history",id:"nurse_booking__history"}},[s("f7-navbar",[s("tommy-nav-back"),a._v(" "),s("f7-nav-title",[a._v(a._s(a.$t("nurse_booking.history.title")))])],1),a._v(" "),a.ordersSorted?s("div",{staticClass:"orders-list"},a._l(a.ordersSorted,function(t,e){return s("a",{key:e,staticClass:"order-item",attrs:{href:"/nurse_booking/order-details/?id="+t.id}},[s("div",{staticClass:"order-item-header"},[s("div",{staticClass:"order-item-date"},[a._v(a._s(a.formatDate(t.data.date,"D MMM YYYY")))]),a._v(" "),s("div",{staticClass:"order-item-status"},[a._v(a._s(a.$t(t.statusKey)))])]),a._v(" "),s("div",{staticClass:"order-item-content"},[s("div",{staticClass:"order-item-details"},[s("div",{staticClass:"order-item-details-row"},[a._v(a._s(t.name))]),a._v(" "),s("div",{staticClass:"order-item-details-row order-item-details-date"},[a._v(a._s(a.formatDate(t.data.date,"MMM D, YYYY H:m")))])]),a._v(" "),s("div",{staticClass:"order-item-amount"},[a._v("¥"+a._s(t.total))])])])})):a._e()],1)},staticRenderFns:[],data:function data(){return{orders:null}},computed:{ordersSorted:function ordersSorted(){return this.orders?this.orders.sort(function(t,e){return e.id>t.id?1:e.id<t.id?-1:0}):null}},mounted:function mounted(){var e=this;g.getOrdersHistory(e.$root.team.id).then(function(t){t.forEach(function(t){t.statusKey="nurse_booking.history.status_"+(t.canceled?"canceled":t.status),t.data&&t.data.date&&(Number.isNaN(parseInt(t.data.date,10))||(t.data.date=parseInt(t.data.date,10)))}),e.orders=t})},methods:{formatDate:formatDate}}}]}();