var addon=function(){var t=window.tommy,n=t.api,a={cache:{services:[],coupons:[],locations:[],booking:{}},getServiceList:function getServiceList(e){return n.call({endpoint:"vendors/"+e+"/products",method:"GET",data:{}}).then(function(e){return a.cache.services=e})},getServiceDetails:function getServiceDetails(e,t){return n.call({endpoint:"vendors/"+t+"/products/"+e,method:"GET"}).then(function(e){return e})},getCouponList:function getCouponList(e){return n.call({endpoint:"vendors/"+e+"/coupons",method:"GET",data:{}}).then(function(e){return a.cache.coupons=e})},getLocations:function getLocations(){return n.call({endpoint:"addons/nurse_booking/install/settings/locations",method:"GET"}).then(function(e){return a.cache.locations=e&&e.data&&e.data.locations?e.data.locations:[],a.cache.locations})},saveLocations:function saveLocations(e){return e?a.cache.locations=e:e=a.cache.locations,n.call({endpoint:"addons/nurse_booking/install/settings/locations",method:"PUT",data:{data:JSON.stringify({locations:e})}}).then(function(e){return e.data.locations})},addLocation:function addLocation(e){return e.default?(a.cache.locations.forEach(function(e){e.default=!1}),a.cache.locations.unshift(e)):a.cache.locations.push(e),a.saveLocations(a.cache.locations)},removeLocation:function removeLocation(e){return a.cache.locations.splice(e,1),a.saveLocations(a.cache.locations)},sendOrder:function sendOrder(e){return n.call({endpoint:"vendors/"+t.config.getCurrentTeamId()+"/orders",method:"POST",data:e})},getOrdersHistory:function getOrdersHistory(){return n.call({endpoint:"vendors/"+t.config.getCurrentTeamId()+"/orders/",method:"GET"}).then(function(e){return a.cache.orders=e})},getOrderDetails:function getOrderDetails(e){return n.call({endpoint:"vendors/"+t.config.getCurrentTeamId()+"/orders/"+e+"?with_wallet_transaction=true",method:"GET"}).then(function(e){return e})},cancelOrder:function cancelOrder(e){return n.call({endpoint:"vendors/"+t.config.getCurrentTeamId()+"/orders/"+e,method:"DELETE"})}},e={render:function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("f7-page",{attrs:{name:"nurse_booking__service-list",id:"nurse_booking__service-list"}},[n("f7-navbar",[n("tommy-nav-back"),t._v(" "),n("f7-nav-title",[t._v(t._s(t.$t("nurse_booking.service_list."+t.category.toLowerCase()+"_title")))])],1),t._v(" "),t.services?n("f7-swiper",{staticClass:"service-cards no-swipe-panel",attrs:{params:{centeredSlides:!0,slidesPerView:"auto",touchMoveStopPropagation:!1}}},t._l(t.services,function(e){return n("f7-swiper-slide",{key:e.id},[n("a",{staticClass:"service-card",attrs:{href:"/nurse_booking/service-details/"+e.id+"/"}},[n("div",{staticClass:"service-card-pic",style:"background-image:url("+t.$addonAssetsUrl+"demo-package.png"}),t._v(" "),n("div",{staticClass:"service-card-content"},[n("div",{staticClass:"service-card-title"},[t._v(t._s(e.name))]),t._v(" "),n("div",{staticClass:"service-card-duration"},[t._v(t._s(e.data.duration)+"min")]),t._v(" "),e.coupons.length?n("div",{staticClass:"service-card-coupons"},[t._v(t._s(e.coupons.length)+" Coupons")]):n("div",{staticClass:"service-card-price"},[t._v("¥ "+t._s(e.price))])])])])})):t._e()],1)},staticRenderFns:[],data:function data(){return{services:null,category:this.$f7route.query.category}},mounted:function mounted(){var o=this,e=o.$root.team.id;Promise.all([a.getServiceList(e),a.getCouponList(e)]).then(function(e){var t=e[0],n=e[1],i=t.filter(function(e){return e.category===o.category});i.forEach(function(t){t.coupons=n.filter(function(e){return e.vendor_product_id===t.id})}),o.services=i})}};var d=window.tommy;function couponPicker(t,e,n,i){var o,a,s=window.tommy.app.f7,c=t.map(function(e){return Object.assign({},e,{checked:!!i&&e.id===i.id})}),r=('\n  <div class="nurse_booking-coupon-picker">\n    <div class="coupon-picker-img">\n      <img src="'+d.addons.getAssetsUrl("nurse_booking")+'coupon-picker.svg" height="78">\n    </div>\n    <div class="coupon-picker-text">'+d.i18n.t("nurse_booking.coupon_picker.text")+'</div>\n    <div class="coupon-picker-items">\n      '+c.map(function(e){return('\n      <label>\n        <input type="radio" name="nurse_booking-coupon-picker-radio" value="'+e.id+'" '+(e.checked?"checked":"")+'>\n        <div class="coupon-item-content">\n          <div class="coupon-item-title">¥ '+e.amount+'</div>\n          <div class="coupon-item-name">'+e.name+'</div>\n          <div class="coupon-item-date">'+function formatDate(e,t){var n=window.tommy.moment;return n(n.utc(e).toDate()).format(t)}(e.expires_at,"D MMM YYYY")+'</div>\n        </div>\n        <div class="coupon-item-label">'+d.i18n.t("nurse_booking.coupon_picker.use_label")+"</div>\n      </label>\n      ").trim()}).join("")+"\n    </div>\n  </div>\n  ").trim(),l=s.dialog.create({content:r,cssClass:"nurse_booking-coupon-picker-modal",buttons:[{text:d.i18n.t("nurse_booking.coupon_picker.skip_button","Skip"),onClick:function onClick(){n&&n()}},{text:d.i18n.t("nurse_booking.coupon_picker.confirm_button","Confirm"),bold:!0,onClick:function onClick(){e&&e(a)}}]}).open().$el;l.find(".dialog-button-bold").addClass("dialog-button-disabled"),l.find("input").on("change",function(e){l.find(".dialog-button-bold").removeClass("dialog-button-disabled"),e.target.checked&&(o=e.target.value,t.forEach(function(e){e.id===parseInt(o,10)&&(a=e)}))})}return[{path:"/nurse_booking/",component:{render:function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("f7-page",{attrs:{name:"nurse_booking__index",id:"nurse_booking__index"},on:{"page:beforein":e.onPageBeforeIn,"page:beforeout":e.onPageBeforeOut}},[n("f7-navbar",[n("tommy-nav-menu"),e._v(" "),n("f7-nav-title",[e._v(e._s(e.$t("nurse_booking.index.title","Nurse Booking")))])],1),e._v(" "),n("f7-swiper",{attrs:{pagination:""}},[n("f7-swiper-slide",{staticClass:"swiper-slide",style:"background-image: url("+e.$addonAssetUrl+"demo-slide.jpg)"}),e._v(" "),n("f7-swiper-slide",{staticClass:"swiper-slide",style:"background-image: url("+e.$addonAssetUrl+"demo-slide.jpg)"}),e._v(" "),n("f7-swiper-slide",{staticClass:"swiper-slide",style:"background-image: url("+e.$addonAssetUrl+"demo-slide.jpg)"})],1),e._v(" "),n("div",{staticClass:"sections"},[n("div",{staticClass:"section"},[n("a",{attrs:{href:"/nurse_booking/vip/"}},[n("img",{attrs:{src:e.$addonAssetUrl+"icon-vip.svg"}}),e._v(" "),n("span",[e._v(e._s(e.$t("nurse_booking.index.vip_label","VIP")))])])]),e._v(" "),n("div",{staticClass:"section"},[n("a",{attrs:{href:"/nurse_booking/service-list/?category=Nursing"}},[n("img",{attrs:{src:e.$addonAssetUrl+"icon-nursing.svg"}}),e._v(" "),n("span",[e._v(e._s(e.$t("nurse_booking.index.nursing_label","Nursing")))])])]),e._v(" "),n("div",{staticClass:"section"},[n("a",{attrs:{href:"/nurse_booking/service-list/?category=Cleaning"}},[n("img",{attrs:{src:e.$addonAssetUrl+"icon-cleaning.svg"}}),e._v(" "),n("span",[e._v(e._s(e.$t("nurse_booking.index.cleaning_label","Cleaning")))])])]),e._v(" "),n("div",{staticClass:"section"},[n("a",{attrs:{href:"/nurse_booking/service-list/?category=Massage"}},[n("img",{attrs:{src:e.$addonAssetUrl+"icon-massage.svg"}}),e._v(" "),n("span",[e._v(e._s(e.$t("nurse_booking.index.massage_label","Massage")))])])]),e._v(" "),n("div",{staticClass:"section"},[n("a",{attrs:{href:"/nurse_booking/history/"}},[n("img",{attrs:{src:e.$addonAssetUrl+"icon-booking.svg"}}),e._v(" "),n("span",[e._v(e._s(e.$t("nurse_booking.index.booking_label","Booking")))])])]),e._v(" "),n("div",{staticClass:"section"},[n("a",{staticClass:"external",attrs:{href:"tommy://addon?package=wallet&back=true"}},[n("img",{attrs:{src:e.$addonAssetUrl+"icon-wallet.svg"}}),e._v(" "),n("span",[e._v(e._s(e.$t("nurse_booking.index.wallet_label","Wallet")))])])])])],1)},staticRenderFns:[],methods:{onPageBeforeIn:function onPageBeforeIn(){this.$f7router.view.$navbarEl.addClass("nurse-booking-index-navbar")},onPageBeforeOut:function onPageBeforeOut(){this.$f7router.view.$navbarEl.removeClass("nurse-booking-index-navbar")}}}},{path:"/nurse_booking/vip/",component:{render:function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("f7-page",{attrs:{name:"nurse_booking__vip",id:"nurse_booking__vip"},on:{"page:beforein":e.onPageBeforeIn,"page:beforeout":e.onPageBeforeOut}},[n("f7-navbar",[n("tommy-nav-back")],1),e._v(" "),n("div",{staticClass:"vip-header"},[n("div",{staticClass:"avatar",style:"background-image: url("+e.$addonAssetsUrl+"demo-avatar.png"},[n("div",{staticClass:"medal medal-green"})]),e._v(" "),n("div",{staticClass:"name"},[e._v("Allen Zhang")])]),e._v(" "),n("div",{staticClass:"vip-info"},[e._v(e._s(e.$t("nurse_booking.vip.info")))]),e._v(" "),n("div",{staticClass:"vip-plans"},[n("a",{staticClass:"vip-plan vip-plan-green",attrs:{href:"/nurse_booking/vip-details/"}},[n("div",{staticClass:"vip-plan-badge"},[e._v(e._s(e.$t("nurse_booking.vip.current_plan_badge")))]),e._v(" "),n("div",{staticClass:"vip-plan-title"},[e._v(e._s(e.$t("nurse_booking.vip.plan_green")))])]),e._v(" "),n("a",{staticClass:"vip-plan vip-plan-gold",attrs:{href:"/nurse_booking/vip-details/"}},[n("div",{staticClass:"vip-plan-badge"},[e._v(e._s(e.$t("nurse_booking.vip.recommended_plan_badge")))]),e._v(" "),n("div",{staticClass:"vip-plan-title"},[e._v(e._s(e.$t("nurse_booking.vip.plan_gold")))])]),e._v(" "),n("a",{staticClass:"vip-plan vip-plan-platinum",attrs:{href:"/nurse_booking/vip-details/"}},[n("div",{staticClass:"vip-plan-title"},[e._v(e._s(e.$t("nurse_booking.vip.plan_platinum")))])])])],1)},staticRenderFns:[],methods:{onPageBeforeIn:function onPageBeforeIn(){this.$f7router.view.$navbarEl.addClass("nurse-booking-vip-navbar")},onPageBeforeOut:function onPageBeforeOut(e,t){"previous"!==t.to&&this.$f7router.view.$navbarEl.removeClass("nurse-booking-vip-navbar")}}}},{path:"/nurse_booking/vip-details/",component:{render:function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("f7-page",{attrs:{name:"nurse_booking__vip-details",id:"nurse_booking__vip-details"},on:{"page:beforein":e.onPageBeforeIn,"page:beforeout":e.onPageBeforeOut}},[n("f7-navbar",[n("tommy-nav-back")],1),e._v(" "),n("div",{staticClass:"vip-header"},[n("div",{staticClass:"avatar",style:"background-image: url("+e.$addonAssetsUrl+"demo-avatar.png"},[n("div",{staticClass:"medal medal-green"})]),e._v(" "),n("div",{staticClass:"name"},[e._v("Allen Zhang")])]),e._v(" "),n("div",{staticClass:"vip-plan-details"},[n("div",{staticClass:"vip-plan-current"},[e._v(e._s(e.$t("nurse_booking.vip.plan_green")))]),e._v(" "),n("div",{staticClass:"vip-plan-expiration"},[e._v("Expires 3rd April")])]),e._v(" "),n("div",{staticClass:"list vip-details-list"},[n("ul",[n("li",{staticClass:"item-divider"},[e._v(e._s(e.$t("nurse_booking.vip.details_plan_inclusion")))]),e._v(" "),n("li",{staticClass:"item-content"},[n("div",{staticClass:"item-inner"},[n("div",{staticClass:"item-title"},[n("div",[e._v("Nurse Visit")]),e._v(" "),n("div",{staticClass:"item-subtitle"},[n("b",[e._v("Four")]),e._v(" ("),n("b",[e._v("one")]),e._v(" time left) per month ")])])])]),e._v(" "),n("li",{staticClass:"item-content"},[n("div",{staticClass:"item-inner"},[n("div",{staticClass:"item-title"},[n("div",[e._v("Clean")]),e._v(" "),n("div",{staticClass:"item-subtitle"},[n("b",[e._v("Four+One")]),e._v(" per month ")])])])]),e._v(" "),n("li",{staticClass:"item-content"},[n("div",{staticClass:"item-inner"},[n("div",{staticClass:"item-title"},[n("div",[e._v("Massage")])])])]),e._v(" "),n("li",{staticClass:"item-divider"},[e._v(e._s(e.$t("nurse_booking.vip.details_administration")))]),e._v(" "),n("li",[n("a",{staticClass:"item-content item-link",attrs:{href:"#"}},[n("div",{staticClass:"item-inner"},[n("div",{staticClass:"item-title"},[e._v("Change Subscription")])])])]),e._v(" "),n("li",[n("a",{staticClass:"item-content item-link",attrs:{href:"#"}},[n("div",{staticClass:"item-inner"},[n("div",{staticClass:"item-title"},[e._v("Coupon")]),e._v(" "),n("div",{staticClass:"item-after"},[n("b",[e._v("4 Sheets")])])])])])])])],1)},staticRenderFns:[],methods:{onPageBeforeIn:function onPageBeforeIn(){},onPageBeforeOut:function onPageBeforeOut(){}}}},{path:"/nurse_booking/service-list/",component:e},{path:"/nurse_booking/service-details/:id/",component:{render:function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("f7-page",{attrs:{name:"nurse_booking__service-details",id:"nurse_booking__service-details"}},[n("f7-navbar",[n("tommy-nav-back"),e._v(" "),n("f7-nav-title",[e._v(e._s(e.service.name))])],1),e._v(" "),n("a",{staticClass:"nurse_booking__toolbar-button",attrs:{slot:"fixed"},on:{click:e.book},slot:"fixed"},[e._v(e._s(e.$t("nurse_booking.service_details.book_button")))]),e._v(" "),n("div",{staticClass:"service-details-header"},[n("f7-swiper",{attrs:{pagination:""}},[n("div",{staticClass:"swiper-slide",style:"background-image: url("+e.$addonAssetUrl+"demo-package.png)"}),e._v(" "),n("div",{staticClass:"swiper-slide",style:"background-image: url("+e.$addonAssetUrl+"demo-package.png)"}),e._v(" "),n("div",{staticClass:"swiper-slide",style:"background-image: url("+e.$addonAssetUrl+"demo-package.png)"})])],1),e._v(" "),n("div",{staticClass:"service-details-meta"},[n("div",{staticClass:"service-details-meta-wrap"},[n("div",{staticClass:"service-details-meta-left"},[n("div",{staticClass:"service-details-title"},[e._v(e._s(e.service.name))]),e._v(" "),n("div",{staticClass:"service-details-duration"},[e._v(e._s(e.service.data.duration)+"min")])]),e._v(" "),n("div",{staticClass:"service-details-price"},[e._v("¥ "+e._s(e.service.price))])]),e._v(" "),e.service.coupons.length?n("a",{staticClass:"service-details-coupons-link",on:{click:e.chooseCoupon}},[n("span",[e._v(e._s(e.service.coupons.length)+" coupons available")])]):e._e()]),e._v(" "),n("div",{staticClass:"service-details-content"},[n("div",{staticClass:"service-details-label"},[e._v(e._s(e.$t("nurse_booking.service_details.service_details_label"))+":")]),e._v(" "),n("div",{staticClass:"service-details-text"},[n("p",[e._v(" "+e._s(e.service.description)+" ")])])])],1)},staticRenderFns:[],props:{id:[Number,String]},data:function data(){var t=this,n={};return(a.cache.services||[]).forEach(function(e){e.id===parseInt(t.id,10)&&((n=e).coupons=a.cache.coupons.filter(function(e){return e.vendor_product_id===n.id}))}),{service:n,selectedCoupon:null}},mounted:function mounted(){},methods:{book:function book(){var t=this,n=t.service;(a.cache.booking.service=n).coupons&&n.coupons.length?couponPicker(n.coupons,function(e){t.selectedCoupon=e,a.cache.booking.service=n,a.cache.booking.coupon=t.selectedCoupon,t.$f7router.navigate("/nurse_booking/location/")},function(){a.cache.booking.coupon=null,delete a.cache.booking.coupon,t.selectedCoupon=null,t.$f7router.navigate("/nurse_booking/location/")}):(a.cache.booking.coupon=null,delete a.cache.booking.coupon,t.selectedCoupon=null,t.$f7router.navigate("/nurse_booking/location/"))},chooseCoupon:function chooseCoupon(){var t=this;couponPicker(t.service.coupons,function(e){t.selectedCoupon=e,a.cache.booking.service=t.service,a.cache.booking.coupon=t.selectedCoupon,t.$f7router.navigate("/nurse_booking/location/")},function(){t.selectedCoupon=null})}}}},{path:"/nurse_booking/location/",component:{render:function(){var i=this,e=i.$createElement,o=i._self._c||e;return o("f7-page",{attrs:{name:"nurse_booking__location",id:"nurse_booking__location"}},[o("f7-navbar",[o("tommy-nav-back"),i._v(" "),o("f7-nav-title",[i._v(i._s(i.$t("nurse_booking.location.title")))])],1),i._v(" "),i._l(i.locations,function(t,n){return i.locations&&i.locations.length?o("div",{key:n,staticClass:"location-card"},[o("i",{staticClass:"location-card-icon"}),i._v(" "),o("div",{staticClass:"location-card-title"},[t.default?o("span",{staticClass:"location-card-default-badge"},[i._v("["+i._s(i.$t("nurse_booking.location.default_label"))+"]")]):i._e(),i._v(" "+i._s(t.city)+" "+i._s(t.address)+" ")]),i._v(" "),o("a",{staticClass:"location-delete-button",attrs:{href:"#"},on:{click:function(e){i.deleteLocation(t,n)}}}),i._v(" "),o("a",{staticClass:"location-card-button location-select-button",attrs:{href:"#"},on:{click:function(e){i.selectLocation(t,n)}}},[i._v(i._s(i.$t("nurse_booking.location.select_button")))])]):i._e()}),i._v(" "),i.addMode||i.locations&&!i.locations.length?o("div",{staticClass:"location-card location-add-form"},[o("input",{attrs:{type:"text",placeholder:i.$t("nurse_booking.location.city_placeholder")},domProps:{value:i.city},on:{input:function(e){i.city=e.target.value}}}),i._v(" "),o("textarea",{attrs:{type:"text",placeholder:i.$t("nurse_booking.location.address_placeholder")},domProps:{value:i.address},on:{input:function(e){i.address=e.target.value}}}),i._v(" "),o("label",[o("input",{attrs:{type:"checkbox",name:"default"},domProps:{checked:i.isDefault},on:{change:function(e){i.isDefault=e.target.checked}}}),i._v(" "),o("i",{staticClass:"framework7-icons"},[i._v("check")]),i._v(" "),o("span",[i._v(i._s(i.$t("nurse_booking.location.set_default_label")))])]),i._v(" "),o("a",{staticClass:"location-card-button location-save-button",attrs:{href:"#"},on:{click:function(e){i.saveLocation()}}},[i._v(i._s(i.$t("nurse_booking.location.save_button")))])]):i._e(),i._v(" "),i.locations&&i.locations.length?o("a",{staticClass:"location-add-button",attrs:{href:"#"},on:{click:function(e){i.addLocation()}}},[i._v(i._s(i.$t("nurse_booking.location.add_button")))]):i._e()],2)},staticRenderFns:[],data:function data(){return{service:a.cache.booking.service,locations:null,addMode:!1,city:"",address:"",isDefault:!1}},mounted:function mounted(){var e=this;a.getLocations().then(function(){e.locations=[].concat(a.cache.locations||[])})},methods:{deleteLocation:function deleteLocation(e,t){var n=this;a.removeLocation(t).then(function(){n.locations.splice(t,1)})},selectLocation:function selectLocation(e){var t,n=this,i=e.city,o=n.service;(o.data.available_in||o.data.availabile_in||[]).forEach(function(e){e.toLowerCase()===i.toLowerCase()&&(t=!0)}),t?(a.cache.booking.location=e,n.$f7route.query.back?n.$f7router.back():n.$f7router.navigate("/nurse_booking/date-time/")):n.$f7.dialog.alert(n.$t("nurse_booking.location.not_available"))},saveLocation:function saveLocation(){var e=this,t=e.city,n=e.address,i=e.isDefault;t&&n&&a.addLocation({city:t,address:n,default:i}).then(function(){e.locations=[].concat(a.cache.locations||[]),e.addMode=!1,e.city="",e.address="",e.isDefault=!1})},addLocation:function addLocation(){this.addMode=!0}}}}]}();