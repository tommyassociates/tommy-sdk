var addon=function(){var s=window.tommy.api,p={cache:{services:[],coupons:[],locations:[],booking:{}},getServiceList:function getServiceList(e){return s.call({endpoint:"vendors/"+e+"/products",method:"GET",data:{}}).then(function(e){return p.cache.services=e})},getServiceDetails:function getServiceDetails(e,t){return s.call({endpoint:"vendors/"+e+"/products/"+t,method:"GET"}).then(function(e){return e})},getCouponList:function getCouponList(e){return s.call({endpoint:"vendors/"+e+"/coupons",method:"GET",data:{}}).then(function(e){return p.cache.coupons=e})},getLocations:function getLocations(){return s.call({endpoint:"addons/nurse_booking/install/settings/locations",method:"GET"}).then(function(e){return p.cache.locations=e&&e.data&&e.data.locations?e.data.locations:[],p.cache.locations})},getNurseList:function getNurseList(e){return s.call({endpoint:"teams/"+e+"/members",method:"GET",data:{tags:["Available For Work"]}}).then(function(e){return p.cache.nurses=e,p.cache.nurses})},saveLocations:function saveLocations(e){return e?p.cache.locations=e:e=p.cache.locations,s.call({endpoint:"addons/nurse_booking/install/settings/locations",method:"PUT",data:{data:JSON.stringify({locations:e})}}).then(function(e){return e.data.locations})},addLocation:function addLocation(e){return e.default?(p.cache.locations.forEach(function(e){e.default=!1}),p.cache.locations.unshift(e)):p.cache.locations.push(e),p.saveLocations(p.cache.locations)},removeLocation:function removeLocation(e){return p.cache.locations.splice(e,1),p.saveLocations(p.cache.locations)},createBookingEvent:function createBookingEvent(e,t){return s.createEvent({title:t.name,start_at:new Date(t.data.date).toJSON(),location:t.data.location.city+" "+t.data.location.address,user_id:t.data.nurse.user_id,team_id:e,kind:"Booking",resource_id:t.id,resource_type:"VendorOrder"})},deleteBookingEvent:function deleteBookingEvent(e){return s.getEvents({kind:"Booking",resource_id:e,resource_type:"VendorOrder"}).then(function(e){return Promise.all(e.map(function(e){return s.deleteEvent(e.id)}))})},sendOrder:function sendOrder(e,t){return s.call({endpoint:"vendors/"+e+"/orders",method:"POST",data:t})},updateOrder:function updateOrder(e,t){return s.call({endpoint:"vendors/"+e+"/orders",method:"PUT",data:t})},getOrdersHistory:function getOrdersHistory(e){return s.call({endpoint:"vendors/"+e+"/orders/",method:"GET"}).then(function(e){return p.cache.orders=e})},getOrderDetails:function getOrderDetails(e,t){return s.call({endpoint:"vendors/"+e+"/orders/"+t+"?with_wallet_transaction=true",method:"GET"}).then(function(e){return e})},cancelOrder:function cancelOrder(e,t){return s.call({endpoint:"vendors/"+e+"/orders/"+t,method:"DELETE"})}},e={render:function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("f7-page",{attrs:{name:"nurse_booking__service-list",id:"nurse_booking__service-list"}},[s("f7-navbar",[s("tommy-nav-back"),t._v(" "),s("f7-nav-title",[t._v(t._s(t.$t("nurse_booking.service_list."+t.category.toLowerCase()+"_title")))])],1),t._v(" "),t.services?s("f7-swiper",{staticClass:"service-cards no-swipe-panel",attrs:{params:{centeredSlides:!0,slidesPerView:"auto",touchMoveStopPropagation:!1}}},t._l(t.services,function(e){return s("f7-swiper-slide",{key:e.id},[s("a",{staticClass:"service-card",attrs:{href:"/nurse_booking/service-details/"+e.id+"/"}},[s("div",{staticClass:"service-card-pic",style:"background-image:url("+t.$addonAssetsUrl+"demo-package.png"}),t._v(" "),s("div",{staticClass:"service-card-content"},[s("div",{staticClass:"service-card-title"},[t._v(t._s(e.name))]),t._v(" "),s("div",{staticClass:"service-card-duration"},[t._v(t._s(e.data.duration)+"min")]),t._v(" "),e.coupons.length?s("div",{staticClass:"service-card-coupons"},[t._v(t._s(e.coupons.length)+" Coupons")]):s("div",{staticClass:"service-card-price"},[t._v("¥ "+t._s(e.price))])])])])})):t._e()],1)},staticRenderFns:[],data:function data(){return{services:null,category:this.$f7route.query.category}},mounted:function mounted(){var n=this,e=n.$root.team.id;Promise.all([p.getServiceList(e),p.getCouponList(e)]).then(function(e){var t=e[0],s=e[1],a=t.filter(function(e){return e.category===n.category});a.forEach(function(t){t.coupons=s.filter(function(e){return e.vendor_product_id===t.id})}),n.services=a})}};function formatDate(e,t){var s=window.tommy.moment;return s(s.utc(e).toDate()).format(t)}var l=window.tommy;function couponPicker(t,e,s,a){var n,o,i=window.tommy.app.f7,r=t.map(function(e){return Object.assign({},e,{checked:!!a&&e.id===a.id})}),c=('\n  <div class="nurse_booking-coupon-picker">\n    <div class="coupon-picker-img">\n      <img src="'+l.addons.getAssetsUrl("nurse_booking")+'coupon-picker.svg" height="78">\n    </div>\n    <div class="coupon-picker-text">'+l.i18n.t("nurse_booking.coupon_picker.text")+'</div>\n    <div class="coupon-picker-items">\n      '+r.map(function(e){return('\n      <label>\n        <input type="radio" name="nurse_booking-coupon-picker-radio" value="'+e.id+'" '+(e.checked?"checked":"")+'>\n        <div class="coupon-item-content">\n          <div class="coupon-item-title">¥ '+e.amount+'</div>\n          <div class="coupon-item-name">'+e.name+'</div>\n          <div class="coupon-item-date">'+formatDate(e.expires_at,"D MMM YYYY")+'</div>\n        </div>\n        <div class="coupon-item-label">'+l.i18n.t("nurse_booking.coupon_picker.use_label")+"</div>\n      </label>\n      ").trim()}).join("")+"\n    </div>\n  </div>\n  ").trim(),d=i.dialog.create({content:c,cssClass:"nurse_booking-coupon-picker-modal",buttons:[{text:l.i18n.t("nurse_booking.coupon_picker.skip_button","Skip"),onClick:function onClick(){s&&s()}},{text:l.i18n.t("nurse_booking.coupon_picker.confirm_button","Confirm"),bold:!0,onClick:function onClick(){e&&e(o)}}]}).open().$el;d.find(".dialog-button-bold").addClass("dialog-button-disabled"),d.find("input").on("change",function(e){d.find(".dialog-button-bold").removeClass("dialog-button-disabled"),e.target.checked&&(n=e.target.value,t.forEach(function(e){e.id===parseInt(n,10)&&(o=e)}))})}function payOrder(e,n){void 0===n&&(n=!0);var t=window.tommy,o=t.app.f7,i=e.teamId,r=e.productName,c=e.productId,d=e.total,l=e.discount;void 0===l&&(l=0);var u=e.location,_=e.date,v=e.couponId,g=e.orderId,m=e.nurse;t.initWalletTransaction({addon:"nurse_booking",payee_name:r,currency:"CNY",amount:d},function(t){var s={vendor_product_id:c,vendor_order_items:[c],vendor_coupon_id:v||null,wallet_transaction_id:t.id,name:r,status:"paid",comment:"",data:{location:u,date:_,nurse:m},discount:l,total:d},a="/nurse_booking/order-success/";n?p.sendOrder(i,s).then(function(e){p.createBookingEvent(i,Object.assign({},{id:e.id},s)).then(function(){p.cache.booking.transaction=t,o.views.main.router.navigate(a+"?id="+e.id)})}):p.createBookingEvent(i,Object.assign({},{id:g},s)).then(function(){p.cache.booking.transaction=t,o.views.main.router.navigate(a+"?id="+g)})},function(t){if(t.id){var e={vendor_product_id:c,vendor_order_items:[c],vendor_coupon_id:v||null,wallet_transaction_id:t.id,name:r,status:"pending",comment:"",data:{location:u,date:_,nurse:m},discount:l,total:d},s="/nurse_booking/order-error/";n?p.sendOrder(i,e).then(function(e){p.cache.booking.transaction=t,o.views.main.router.navigate(s+"?id="+e.id)}):(p.cache.booking.transaction=t,o.views.main.router.navigate(s+"?id="+g))}})}return[{path:"/nurse_booking/",component:{render:function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("f7-page",{attrs:{name:"nurse_booking__index",id:"nurse_booking__index"},on:{"page:beforein":e.onPageBeforeIn,"page:beforeout":e.onPageBeforeOut}},[s("f7-navbar",[s("tommy-nav-menu"),e._v(" "),s("f7-nav-title",[e._v(e._s(e.$t("nurse_booking.index.title","Nurse Booking")))])],1),e._v(" "),s("f7-swiper",{attrs:{pagination:""}},[s("f7-swiper-slide",{staticClass:"swiper-slide",style:"background-image: url("+e.$addonAssetUrl+"demo-slide.jpg)"}),e._v(" "),s("f7-swiper-slide",{staticClass:"swiper-slide",style:"background-image: url("+e.$addonAssetUrl+"demo-slide.jpg)"}),e._v(" "),s("f7-swiper-slide",{staticClass:"swiper-slide",style:"background-image: url("+e.$addonAssetUrl+"demo-slide.jpg)"})],1),e._v(" "),s("div",{staticClass:"sections"},[s("div",{staticClass:"section"},[s("a",{attrs:{href:"/nurse_booking/vip/"}},[s("img",{attrs:{src:e.$addonAssetUrl+"icon-vip.svg"}}),e._v(" "),s("span",[e._v(e._s(e.$t("nurse_booking.index.vip_label","VIP")))])])]),e._v(" "),s("div",{staticClass:"section"},[s("a",{attrs:{href:"/nurse_booking/service-list/?category=Nursing"}},[s("img",{attrs:{src:e.$addonAssetUrl+"icon-nursing.svg"}}),e._v(" "),s("span",[e._v(e._s(e.$t("nurse_booking.index.nursing_label","Nursing")))])])]),e._v(" "),s("div",{staticClass:"section"},[s("a",{attrs:{href:"/nurse_booking/service-list/?category=Cleaning"}},[s("img",{attrs:{src:e.$addonAssetUrl+"icon-cleaning.svg"}}),e._v(" "),s("span",[e._v(e._s(e.$t("nurse_booking.index.cleaning_label","Cleaning")))])])]),e._v(" "),s("div",{staticClass:"section"},[s("a",{attrs:{href:"/nurse_booking/service-list/?category=Massage"}},[s("img",{attrs:{src:e.$addonAssetUrl+"icon-massage.svg"}}),e._v(" "),s("span",[e._v(e._s(e.$t("nurse_booking.index.massage_label","Massage")))])])]),e._v(" "),s("div",{staticClass:"section"},[s("a",{attrs:{href:"/nurse_booking/history/"}},[s("img",{attrs:{src:e.$addonAssetUrl+"icon-booking.svg"}}),e._v(" "),s("span",[e._v(e._s(e.$t("nurse_booking.index.booking_label","Booking")))])])]),e._v(" "),s("div",{staticClass:"section"},[s("a",{staticClass:"external",attrs:{href:"tommy://addon?package=wallet&back=true"}},[s("img",{attrs:{src:e.$addonAssetUrl+"icon-wallet.svg"}}),e._v(" "),s("span",[e._v(e._s(e.$t("nurse_booking.index.wallet_label","Wallet")))])])])])],1)},staticRenderFns:[],beforeDestroy:function beforeDestroy(){this.$f7router.view.$navbarEl.removeClass("nurse-booking-index-navbar")},methods:{onPageBeforeIn:function onPageBeforeIn(){this.$f7router.view.$navbarEl.addClass("nurse-booking-index-navbar")},onPageBeforeOut:function onPageBeforeOut(){this.$f7router.view.$navbarEl.removeClass("nurse-booking-index-navbar")}}}},{path:"/nurse_booking/vip/",component:{render:function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("f7-page",{attrs:{name:"nurse_booking__vip",id:"nurse_booking__vip"},on:{"page:beforein":e.onPageBeforeIn,"page:beforeout":e.onPageBeforeOut}},[s("f7-navbar",[s("tommy-nav-back")],1),e._v(" "),s("div",{staticClass:"vip-header"},[s("div",{staticClass:"avatar",style:"background-image: url("+e.$addonAssetsUrl+"demo-avatar.png"},[s("div",{staticClass:"medal medal-green"})]),e._v(" "),s("div",{staticClass:"name"},[e._v("Allen Zhang")])]),e._v(" "),s("div",{staticClass:"vip-info"},[e._v(e._s(e.$t("nurse_booking.vip.info")))]),e._v(" "),s("div",{staticClass:"vip-plans"},[s("a",{staticClass:"vip-plan vip-plan-green",attrs:{href:"/nurse_booking/vip-details/"}},[s("div",{staticClass:"vip-plan-badge"},[e._v(e._s(e.$t("nurse_booking.vip.current_plan_badge")))]),e._v(" "),s("div",{staticClass:"vip-plan-title"},[e._v(e._s(e.$t("nurse_booking.vip.plan_green")))])]),e._v(" "),s("a",{staticClass:"vip-plan vip-plan-gold",attrs:{href:"/nurse_booking/vip-details/"}},[s("div",{staticClass:"vip-plan-badge"},[e._v(e._s(e.$t("nurse_booking.vip.recommended_plan_badge")))]),e._v(" "),s("div",{staticClass:"vip-plan-title"},[e._v(e._s(e.$t("nurse_booking.vip.plan_gold")))])]),e._v(" "),s("a",{staticClass:"vip-plan vip-plan-platinum",attrs:{href:"/nurse_booking/vip-details/"}},[s("div",{staticClass:"vip-plan-title"},[e._v(e._s(e.$t("nurse_booking.vip.plan_platinum")))])])])],1)},staticRenderFns:[],beforeDestroy:function beforeDestroy(){this.$f7router.view.$navbarEl.removeClass("nurse-booking-vip-navbar")},methods:{onPageBeforeIn:function onPageBeforeIn(){this.$f7router.view.$navbarEl.addClass("nurse-booking-vip-navbar")},onPageBeforeOut:function onPageBeforeOut(e,t){"previous"!==t.to&&this.$f7router.view.$navbarEl.removeClass("nurse-booking-vip-navbar")}}}},{path:"/nurse_booking/vip-details/",component:{render:function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("f7-page",{attrs:{name:"nurse_booking__vip-details",id:"nurse_booking__vip-details"},on:{"page:beforein":e.onPageBeforeIn,"page:beforeout":e.onPageBeforeOut}},[s("f7-navbar",[s("tommy-nav-back")],1),e._v(" "),s("div",{staticClass:"vip-header"},[s("div",{staticClass:"avatar",style:"background-image: url("+e.$addonAssetsUrl+"demo-avatar.png"},[s("div",{staticClass:"medal medal-green"})]),e._v(" "),s("div",{staticClass:"name"},[e._v("Allen Zhang")])]),e._v(" "),s("div",{staticClass:"vip-plan-details"},[s("div",{staticClass:"vip-plan-current"},[e._v(e._s(e.$t("nurse_booking.vip.plan_green")))]),e._v(" "),s("div",{staticClass:"vip-plan-expiration"},[e._v("Expires 3rd April")])]),e._v(" "),s("div",{staticClass:"list vip-details-list"},[s("ul",[s("li",{staticClass:"item-divider"},[e._v(e._s(e.$t("nurse_booking.vip.details_plan_inclusion")))]),e._v(" "),s("li",{staticClass:"item-content"},[s("div",{staticClass:"item-inner"},[s("div",{staticClass:"item-title"},[s("div",[e._v("Nurse Visit")]),e._v(" "),s("div",{staticClass:"item-subtitle"},[s("b",[e._v("Four")]),e._v(" ("),s("b",[e._v("one")]),e._v(" time left) per month ")])])])]),e._v(" "),s("li",{staticClass:"item-content"},[s("div",{staticClass:"item-inner"},[s("div",{staticClass:"item-title"},[s("div",[e._v("Clean")]),e._v(" "),s("div",{staticClass:"item-subtitle"},[s("b",[e._v("Four+One")]),e._v(" per month ")])])])]),e._v(" "),s("li",{staticClass:"item-content"},[s("div",{staticClass:"item-inner"},[s("div",{staticClass:"item-title"},[s("div",[e._v("Massage")])])])]),e._v(" "),s("li",{staticClass:"item-divider"},[e._v(e._s(e.$t("nurse_booking.vip.details_administration")))]),e._v(" "),s("li",[s("a",{staticClass:"item-content item-link",attrs:{href:"#"}},[s("div",{staticClass:"item-inner"},[s("div",{staticClass:"item-title"},[e._v("Change Subscription")])])])]),e._v(" "),s("li",[s("a",{staticClass:"item-content item-link",attrs:{href:"#"}},[s("div",{staticClass:"item-inner"},[s("div",{staticClass:"item-title"},[e._v("Coupon")]),e._v(" "),s("div",{staticClass:"item-after"},[s("b",[e._v("4 Sheets")])])])])])])])],1)},staticRenderFns:[],methods:{onPageBeforeIn:function onPageBeforeIn(){},onPageBeforeOut:function onPageBeforeOut(){}}}},{path:"/nurse_booking/service-list/",component:e},{path:"/nurse_booking/service-details/:id/",component:{render:function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("f7-page",{attrs:{name:"nurse_booking__service-details",id:"nurse_booking__service-details"}},[s("f7-navbar",[s("tommy-nav-back"),e._v(" "),s("f7-nav-title",[e._v(e._s(e.service.name))])],1),e._v(" "),s("a",{staticClass:"nurse_booking__toolbar-button",attrs:{slot:"fixed"},on:{click:e.book},slot:"fixed"},[e._v(e._s(e.$t("nurse_booking.service_details.book_button")))]),e._v(" "),s("div",{staticClass:"service-details-header"},[s("f7-swiper",{attrs:{pagination:""}},[s("div",{staticClass:"swiper-slide",style:"background-image: url("+e.$addonAssetUrl+"demo-package.png)"}),e._v(" "),s("div",{staticClass:"swiper-slide",style:"background-image: url("+e.$addonAssetUrl+"demo-package.png)"}),e._v(" "),s("div",{staticClass:"swiper-slide",style:"background-image: url("+e.$addonAssetUrl+"demo-package.png)"})])],1),e._v(" "),s("div",{staticClass:"service-details-meta"},[s("div",{staticClass:"service-details-meta-wrap"},[s("div",{staticClass:"service-details-meta-left"},[s("div",{staticClass:"service-details-title"},[e._v(e._s(e.service.name))]),e._v(" "),s("div",{staticClass:"service-details-duration"},[e._v(e._s(e.service.data.duration)+"min")])]),e._v(" "),s("div",{staticClass:"service-details-price"},[e._v("¥ "+e._s(e.service.price))])]),e._v(" "),e.service.coupons.length?s("a",{staticClass:"service-details-coupons-link",on:{click:e.chooseCoupon}},[s("span",[e._v(e._s(e.service.coupons.length)+" coupons available")])]):e._e()]),e._v(" "),s("div",{staticClass:"service-details-content"},[s("div",{staticClass:"service-details-label"},[e._v(e._s(e.$t("nurse_booking.service_details.service_details_label"))+":")]),e._v(" "),s("div",{staticClass:"service-details-text"},[s("p",[e._v(" "+e._s(e.service.description)+" ")])])])],1)},staticRenderFns:[],props:{id:[Number,String]},data:function data(){var t=this,s={};return(p.cache.services||[]).forEach(function(e){e.id===parseInt(t.id,10)&&((s=e).coupons=p.cache.coupons.filter(function(e){return e.vendor_product_id===s.id}))}),{service:s,selectedCoupon:null}},mounted:function mounted(){},methods:{book:function book(){var t=this,s=t.service;(p.cache.booking.service=s).coupons&&s.coupons.length?couponPicker(s.coupons,function(e){t.selectedCoupon=e,p.cache.booking.service=s,p.cache.booking.coupon=t.selectedCoupon,t.$f7router.navigate("/nurse_booking/order-select-location/")},function(){p.cache.booking.coupon=null,delete p.cache.booking.coupon,t.selectedCoupon=null,t.$f7router.navigate("/nurse_booking/order-select-location/")}):(p.cache.booking.coupon=null,delete p.cache.booking.coupon,t.selectedCoupon=null,t.$f7router.navigate("/nurse_booking/order-select-location/"))},chooseCoupon:function chooseCoupon(){var t=this;couponPicker(t.service.coupons,function(e){t.selectedCoupon=e,p.cache.booking.service=t.service,p.cache.booking.coupon=t.selectedCoupon,t.$f7router.navigate("/nurse_booking/order-select-location/")},function(){t.selectedCoupon=null})}}}},{path:"/nurse_booking/order-select-location/",component:{render:function(){var a=this,e=a.$createElement,n=a._self._c||e;return n("f7-page",{attrs:{name:"nurse_booking__location",id:"nurse_booking__location"}},[n("f7-navbar",[n("tommy-nav-back"),a._v(" "),n("f7-nav-title",[a._v(a._s(a.$t("nurse_booking.location.title")))])],1),a._v(" "),a._l(a.locations,function(t,s){return a.locations&&a.locations.length?n("div",{key:s,staticClass:"location-card"},[n("i",{staticClass:"location-card-icon"}),a._v(" "),n("div",{staticClass:"location-card-title"},[t.default?n("span",{staticClass:"location-card-default-badge"},[a._v("["+a._s(a.$t("nurse_booking.location.default_label"))+"]")]):a._e(),a._v(" "+a._s(t.city)+" "+a._s(t.address)+" ")]),a._v(" "),n("a",{staticClass:"location-delete-button",attrs:{href:"#"},on:{click:function(e){a.deleteLocation(t,s)}}}),a._v(" "),n("a",{staticClass:"location-card-button location-select-button",attrs:{href:"#"},on:{click:function(e){a.selectLocation(t,s)}}},[a._v(a._s(a.$t("nurse_booking.location.select_button")))])]):a._e()}),a._v(" "),a.addMode||a.locations&&!a.locations.length?n("div",{staticClass:"location-card location-add-form"},[n("input",{attrs:{type:"text",placeholder:a.$t("nurse_booking.location.city_placeholder")},domProps:{value:a.city},on:{input:function(e){a.city=e.target.value}}}),a._v(" "),n("textarea",{attrs:{type:"text",placeholder:a.$t("nurse_booking.location.address_placeholder")},domProps:{value:a.address},on:{input:function(e){a.address=e.target.value}}}),a._v(" "),n("label",[n("input",{attrs:{type:"checkbox",name:"default"},domProps:{checked:a.isDefault},on:{change:function(e){a.isDefault=e.target.checked}}}),a._v(" "),n("i",{staticClass:"framework7-icons"},[a._v("check")]),a._v(" "),n("span",[a._v(a._s(a.$t("nurse_booking.location.set_default_label")))])]),a._v(" "),n("a",{staticClass:"location-card-button location-save-button",attrs:{href:"#"},on:{click:function(e){a.saveLocation()}}},[a._v(a._s(a.$t("nurse_booking.location.save_button")))])]):a._e(),a._v(" "),a.locations&&a.locations.length?n("a",{staticClass:"location-add-button",attrs:{href:"#"},on:{click:function(e){a.addLocation()}}},[a._v(a._s(a.$t("nurse_booking.location.add_button")))]):a._e()],2)},staticRenderFns:[],data:function data(){return{service:p.cache.booking.service,locations:null,addMode:!1,city:"",address:"",isDefault:!1}},mounted:function mounted(){var e=this;p.getLocations().then(function(){e.locations=[].concat(p.cache.locations||[])})},methods:{deleteLocation:function deleteLocation(e,t){var s=this;p.removeLocation(t).then(function(){s.locations.splice(t,1)})},selectLocation:function selectLocation(e){var t,s=this,a=e.city,n=s.service;(n.data.available_in||n.data.availabile_in||[]).forEach(function(e){e.toLowerCase()===a.toLowerCase()&&(t=!0)}),t?(p.cache.booking.location=e,s.$f7route.query.back?s.$f7router.back():s.$f7router.navigate("/nurse_booking/order-select-date/")):s.$f7.dialog.alert(s.$t("nurse_booking.location.not_available"))},saveLocation:function saveLocation(){var e=this,t=e.city,s=e.address,a=e.isDefault;t&&s&&p.addLocation({city:t,address:s,default:a}).then(function(){e.locations=[].concat(p.cache.locations||[]),e.addMode=!1,e.city="",e.address="",e.isDefault=!1})},addLocation:function addLocation(){this.addMode=!0}}}},{path:"/nurse_booking/order-select-date/",component:{render:function(){var s=this,e=s.$createElement,a=s._self._c||e;return a("f7-page",{attrs:{name:"nurse_booking__date-time",id:"nurse_booking__date-time"}},[a("f7-navbar",[a("tommy-nav-back"),s._v(" "),a("f7-nav-title",[s._v(s._s(s.$t("nurse_booking.date_time.title")))])],1),s._v(" "),a("a",{staticClass:"nurse_booking__toolbar-button",class:{disabled:!s.selectedDate||!s.selectedHours},attrs:{slot:"fixed",href:"#"},on:{click:s.selectDateTime},slot:"fixed"},[s._v(s._s(s.$t("nurse_booking.date_time.determine_button")))]),s._v(" "),a("div",{staticClass:"date-time-dates"},s._l(s.dates,function(t,e){return a("label",{key:e,staticClass:"date-time-date",class:{"date-time-date-disabled":t.disabled}},[a("input",{attrs:{type:"radio",disabled:t.disabled},domProps:{checked:s.selectedDate===t.value},on:{change:function(e){s.selectedDate=t.value}}}),s._v(" "),a("div",{staticClass:"date-time-date-num"},[s._v(s._s(t.day)+"."+s._s(t.month))]),s._v(" "),t.today?a("div",{staticClass:"date-time-date-day"},[s._v("Today")]):a("div",{staticClass:"date-time-date-day"},[s._v(s._s(t.weekDay))])])})),s._v(" "),a("div",{staticClass:"date-time-hours"},s._l(s.hours,function(t,e){return a("label",{key:e,staticClass:"date-time-hour",class:{disabled:t.disabled}},[a("input",{attrs:{type:"radio",disabled:t.disabled},domProps:{checked:s.selectedHours===t.value},on:{change:function(e){s.selectedHours=t.value}}}),s._v(" "),a("span",[s._v(s._s(t.hour))])])}))],1)},staticRenderFns:[],data:function data(){for(var e,t=new Date,s=t.getTime(),a=[],n=0;n<=13;n+=1){var o=new Date(s+24*n*60*60*1e3),i=o.getMonth()+1,r=o.getDate();r<10&&(r="0"+r),i<10&&(i="0"+i);var c=o.getDay(),d=!!(0===n)&&19<=t.getHours();d&&(e=!0),a.push({disabled:d,value:new Date(o.getFullYear(),o.getMonth(),o.getDate()).getTime(),day:r,month:i,weekDay:this.$t("nurse_booking.date_time.week_days."+c)})}var l,u,_=this.$f7route.query.date&&new Date(parseInt(this.$f7route.query.date,10));return _&&(l=new Date(_.getFullYear(),_.getMonth(),_.getDate()).getTime(),u=_.getHours()),{service:p.cache.booking.service,dates:a,selectedDate:l||(e?a[1].value:a[0].value),selectedHours:u||null}},watch:{selectedDate:function selectedDate(){this.selectedHours=null}},computed:{hours:function hours(){var e,t=new Date(this.selectedDate),hours=[],s=new Date;s.getFullYear()===t.getFullYear()&&s.getMonth()===t.getMonth()&&s.getDate()===t.getDate()&&(e=!0);for(var a=10;a<=19;a+=1){var n=!!e&&s.getHours()>=a;hours.push({value:a,disabled:n,hour:a+":00"})}return hours}},methods:{selectDateTime:function selectDateTime(){var e=this,t=e.selectedDate,s=e.selectedHours;p.cache.booking.date=new Date(parseInt(t,10)).getTime()+60*s*60*1e3,e.$f7route.query.back?e.$f7router.back():e.$f7router.navigate("/nurse_booking/order-select-nurse/")}}}},{path:"/nurse_booking/order-select-nurse/",component:{render:function(){var s=this,e=s.$createElement,a=s._self._c||e;return a("f7-page",{attrs:{name:"nurse_booking__nurse-list",id:"nurse_booking__nurse-list"}},[a("f7-navbar",[a("tommy-nav-back"),s._v(" "),a("f7-nav-title",[s._v(s._s(s.$t("nurse_booking.nurse_list.title")))])],1),s._v(" "),s.nurses?a("div",{staticClass:"nurse-list"},[a("ul",s._l(s.nurses,function(t){return a("li",{key:t.id,class:{"nurse-selected":s.selectedNurseId===t.id}},[a("a",{staticClass:"nurse-content-wrap",on:{click:function(e){s.selectNurse(t)}}},[a("div",{staticClass:"nurse-media",style:"background-image: url("+(t.icon_url||"")+")"}),s._v(" "),a("div",{staticClass:"nurse-content"},[a("div",{staticClass:"nurse-name"},[s._v(s._s(t.first_name)+" "+s._s(t.last_name))])])])])}))]):s._e()],1)},staticRenderFns:[],data:function data(){return{service:p.cache.booking.service,nurses:null,selectedNurseId:this.$f7route.query.nurse_id?parseInt(this.$f7route.query.nurse_id,10):void 0}},mounted:function mounted(){var t=this;p.getNurseList(t.$root.team.id).then(function(e){e.length===t.$root.teamMembers.length?t.nurses=t.$root.teamMembers.filter(function(e){return 0<=e.tags.indexOf("Available For Work")}):t.nurses=e})},methods:{selectNurse:function selectNurse(e){this.selectedNurseId=e.id,p.cache.booking.nurse=e,this.$f7route.query.back?this.$f7router.back():this.$f7router.navigate("/nurse_booking/order-confirm/")}}}},{path:"/nurse_booking/order-confirm/",component:{render:function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("f7-page",{attrs:{name:"nurse_booking__order-confirm",id:"nurse_booking__order-confirm"},on:{"page:beforein":e.onPageBeforeIn}},[s("f7-navbar",[s("tommy-nav-back"),e._v(" "),s("f7-nav-title",[e._v(e._s(e.$t("nurse_booking.order_confirm.title")))])],1),e._v(" "),s("a",{staticClass:"nurse_booking__toolbar-button service-book-button",attrs:{slot:"fixed",href:"#"},on:{click:e.payOrder},slot:"fixed"},[e._v(e._s(e.$t("nurse_booking.order_confirm.pay_button")))]),e._v(" "),s("div",{staticClass:"service-details-block"},[s("div",{staticClass:"service-image",style:"background-image: url("+e.$addonAssetUrl+"demo-package.png)"}),e._v(" "),s("div",{staticClass:"service-details"},[s("div",{staticClass:"service-title"},[e._v(e._s(e.service.name))]),e._v(" "),s("div",{staticClass:"service-price"},[e._v("¥"+e._s(e.service.price))])])]),e._v(" "),s("f7-list",{attrs:{"no-hairlines":""}},[e.nurse?s("f7-list-item",{attrs:{title:e.nurse.first_name+" "+e.nurse.last_name,link:"/nurse_booking/order-select-nurse/?nurse_id="+e.nurse.id+"&back=true"}},[s("img",{attrs:{slot:"media",src:e.$addonAssetsUrl+"icon-nurse.svg"},slot:"media"})]):e._e(),e._v(" "),s("f7-list-item",{attrs:{title:e.formatDate(e.date,"MMMM D, YYYY HH:mm"),link:"/nurse_booking/order-select-date/?date="+new Date(e.date).getTime()+"&back=true"}},[s("img",{attrs:{slot:"media",src:e.$addonAssetsUrl+"icon-time.svg"},slot:"media"})])],1),e._v(" "),s("f7-list",{attrs:{"no-hairlines":""}},[s("f7-list-item",{attrs:{title:e.user.first_name+" "+e.user.last_name}},[s("img",{attrs:{slot:"media",src:e.$addonAssetsUrl+"icon-user.svg"},slot:"media"})]),e._v(" "),e.user.mobile?s("f7-list-item",{attrs:{title:e.user.mobile}},[s("img",{attrs:{slot:"media",src:e.$addonAssetsUrl+"icon-phone.svg"},slot:"media"})]):e._e(),e._v(" "),s("f7-list-item",{attrs:{link:"/nurse_booking/order-select-location/?back=true"}},[s("span",{staticClass:"location-default-badge",attrs:{slot:"title"},slot:"title"},[e._v("["+e._s(e.$t("nurse_booking.location.default_label"))+"]")]),e._v(" "),s("span",{attrs:{slot:"title"},slot:"title"},[e._v(e._s(e.location.city)+" "+e._s(e.location.address))]),e._v(" "),s("img",{attrs:{slot:"media",src:e.$addonAssetsUrl+"icon-location.svg"},slot:"media"})])],1),e._v(" "),s("f7-list",{staticClass:"list-prices",attrs:{"no-hairlines":""}},[e.coupon?s("f7-list-item",{attrs:{link:"#",title:e.$t("nurse_booking.order_confirm.coupons_label"),after:"-¥"+e.coupon.amount},on:{click:e.selectCoupon}}):e._e(),e._v(" "),s("f7-list-item",{staticClass:"item-total-price",attrs:{title:e.$t("nurse_booking.order_confirm.total_label"),after:"¥"+e.total}})],1)],1)},staticRenderFns:[],data:function data(){return{service:p.cache.booking.service,coupon:p.cache.booking.coupon,user:this.$root.user,location:p.cache.booking.location,date:p.cache.booking.date,nurse:p.cache.booking.nurse}},computed:{total:function total(){var e=this.service,t=this.coupon;return e.price-(t?t.amount:0)}},methods:{formatDate:formatDate,selectCoupon:function selectCoupon(){var t=this;couponPicker(t.service.coupons,function(e){p.cache.booking.coupon=e,t.coupon=e},function(){},t.coupon)},onPageBeforeIn:function onPageBeforeIn(e,t){"previous"===t.from&&(this.location=p.cache.booking.location,this.date=p.cache.booking.date,this.nurse=p.cache.booking.nurse)},payOrder:function payOrder$1(){var e=this,t=e.service,s=e.coupon,a=e.location,n=e.date,o=e.total,i=e.nurse;payOrder({teamId:e.$root.team.id,productName:t.name,productId:t.id,total:o,couponId:s?s.id:null,discount:s?s.amount:0,location:a,date:n,nurse:i})}}}},{path:"/nurse_booking/order-details/",component:{render:function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("f7-page",{attrs:{name:"nurse_booking__order-details",id:"nurse_booking__order-details"}},[s("f7-navbar",[e.$f7route.query.backToHome?s("tommy-nav-back",{attrs:{href:"/nurse_booking/",force:""}}):s("tommy-nav-back"),e._v(" "),s("f7-nav-title",[e._v(e._s(e.$t("nurse_booking.order_details.title")))])],1),e._v(" "),e.status?[e.status.canceled?s("div",{staticClass:"order-details-status"},[s("div",{staticClass:"order-details-status-title"},[e._v(e._s(e.$t("nurse_booking.order_details.status_canceled")))]),e._v(" "),s("div",{staticClass:"order-details-status-date"},[e._v(e._s(e.formatDate(e.date,"D MMM. YYYY")))]),e._v(" "),s("img",{attrs:{src:e.$addonAssetsUrl+"icon-status-canceled.svg"}})]):e._e(),e._v(" "),e.status.pending?s("div",{staticClass:"order-details-status"},[s("div",{staticClass:"order-details-status-title"},[e._v(e._s(e.$t("nurse_booking.order_details.status_pending")))]),e._v(" "),s("div",{staticClass:"order-details-status-date"},[e._v(e._s(e.formatDate(e.date,"D MMM. YYYY")))]),e._v(" "),s("img",{attrs:{src:e.$addonAssetsUrl+"icon-status-pending.svg"}})]):e._e(),e._v(" "),e.status.progress?s("div",{staticClass:"order-details-status"},[s("div",{staticClass:"order-details-status-title"},[e._v(e._s(e.$t("nurse_booking.order_details.status_progress")))]),e._v(" "),s("div",{staticClass:"order-details-status-date"},[e._v(e._s(e.formatDate(e.date,"D MMM. YYYY")))]),e._v(" "),s("img",{attrs:{src:e.$addonAssetsUrl+"icon-status-progress.svg"}})]):e._e(),e._v(" "),e.status.complete?s("div",{staticClass:"order-details-status"},[s("div",{staticClass:"order-details-status-title"},[e._v(e._s(e.$t("nurse_booking.order_details.status_complete")))]),e._v(" "),s("div",{staticClass:"order-details-status-date"},[e._v(e._s(e.formatDate(e.date,"D MMM. YYYY")))]),e._v(" "),s("img",{attrs:{src:e.$addonAssetsUrl+"icon-status-complete.svg"}})]):e._e()]:e._e(),e._v(" "),e.service?s("f7-list",{staticClass:"order-details-list",attrs:{"no-hairlines":""}},[e.nurse?s("f7-list-item",{attrs:{title:e.nurse.first_name+" "+e.nurse.last_name}},[s("span",{staticClass:"order-details-list-nurse-avatar",style:"background-image: url("+(e.nurse.icon_url||"")+")",attrs:{slot:"media"},slot:"media"})]):e._e(),e._v(" "),s("f7-list-item",{attrs:{title:e.$t("nurse_booking.order_details.service_label")+":",after:e.service.name}}),e._v(" "),s("f7-list-item",{attrs:{title:e.$t("nurse_booking.order_details.time_label")+":",after:e.formatDate(e.date,"MMMM D, YYYY HH:mm")}}),e._v(" "),e.coupon?s("li",{staticClass:"item-content"},[s("div",{staticClass:"item-inner"},[s("div",{staticClass:"item-title"},[e._v(e._s(e.$t("nurse_booking.order_details.coupons_label"))+":")]),e._v(" "),s("div",{staticClass:"item-after price"},[e._v("-¥"+e._s(e.coupon.amount))])])]):e._e(),e._v(" "),s("li",{staticClass:"item-content item-total-price"},[s("div",{staticClass:"item-inner"},[s("div",{staticClass:"item-title"},[e._v(e._s(e.$t("nurse_booking.order_details.total_label"))+":")]),e._v(" "),s("div",{staticClass:"item-after price"},[e._v("¥"+e._s(e.total))])])]),e._v(" "),s("f7-list-item",{staticClass:"item-total-price",attrs:{title:e.$t("nurse_booking.order_details.payment_label")+":",after:e.transaction?e.transaction.card_name:null}}),e._v(" "),e.status?[e.status.progress?s("a",{staticClass:"order-details-white-button",attrs:{href:"#"},on:{click:e.cancelOrder}},[e._v(e._s(e.$t("nurse_booking.order_details.cancel_button")))]):e._e(),e._v(" "),e.status.pending?s("a",{staticClass:"order-details-red-button",attrs:{href:"#"},on:{click:e.payOrder}},[e._v(e._s(e.$t("nurse_booking.order_details.pay_button")))]):e._e(),e._v(" "),e.status.complete||e.status.canceled?s("a",{staticClass:"order-details-red-button",attrs:{href:"#"},on:{click:e.repeatOrder}},[e._v(e._s(e.$t("nurse_booking.order_details.repeat_button")))]):e._e()]:e._e()],2):e._e()],2)},staticRenderFns:[],data:function data(){var e=p.cache.booking,t=e.transaction,s=e.service,a=e.coupon,n=e.location,o=e.date,i=e.nurse,data={transaction:null,service:null,coupon:null,location:null,date:null,order:null,status:null,total:null,preventCancel:!1,nurse:null};return this.$f7route.query.id||Object.assign(data,{transaction:t,service:s,coupon:a,location:n,date:o,nurse:i}),data},computed:{totalComputed:function totalComputed(){var e=this.service,t=this.coupon;return this.total||e.price-(t?t.amount:0)}},mounted:function mounted(){var s=this;s.$f7route.query.id&&p.getOrderDetails(s.$root.team.id,s.$f7route.query.id).then(function(e){var t=(s.order=e).canceled;s.status={pending:!t&&"pending"===e.status,canceled:t,progress:!t&&("paid"===e.status||"processing"===e.status),complete:!t&&"complete"===e.status},s.date=parseInt(e.data.date,10),s.nurse=e.data.nurse,s.service={name:e.name,id:e.vendor_product_id||e.vendor_order_items[0]},s.transaction={card_name:e.wallet_transaction.card_name},s.total=e.total,e.vendor_coupon_id&&(s.coupon={id:e.vendor_coupon_id,amount:e.discount})})},methods:{formatDate:formatDate,repeatOrder:function repeatOrder(){var t=this,e=t.order;e&&(p.cache.booking.date=parseInt(e.data.date,10),p.cache.booking.location=e.data.location,p.cache.booking.nurse=e.data.nurse,delete p.cache.booking.coupon,p.getServiceDetails(t.$root.team.id,e.vendor_product_id||e.vendor_order_items[0]).then(function(e){p.cache.booking.service=e,t.$f7router.navigate("/nurse_booking/order-confirm/")}))},cancelOrder:function cancelOrder(){var e=this,t=e.order;t&&(e.preventCancel||(e.preventCancel=!0,e.$f7.dialog.confirm('\n        <div class="order-details-cancel-order-icon"></div>\n        <div>'+e.$t("nurse_booking.order_details.cancel_confirm")+"</div>\n        ",function(){p.cancelOrder(e.$root.team.id,t.id).then(function(){return p.deleteBookingEvent(t.id)}).then(function(){e.preventCancel=!1,e.$f7router.navigate("/nurse_booking/order-canceled/")}).catch(function(){e.preventCancel=!1})},function(){e.preventCancel=!1})))},payOrder:function payOrder$1(){var e=this.order;payOrder({teamId:this.$root.team.id,orderId:e.id,productName:e.name,productId:e.vendor_product_id||e.vendor_order_items[0],total:e.total,couponId:e.vendor_coupon_id,discount:e.discount,location:e.data.location,date:e.data.date},!1)}}}},{path:"/nurse_booking/order-canceled/",component:{render:function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("f7-page",{attrs:{name:"nurse_booking__order-canceled",id:"nurse_booking__order-canceled","no-navbar":""}},[s("div",{staticClass:"order-status-title"},[e._v(e._s(e.$t("nurse_booking.order_canceled.title")))]),e._v(" "),s("div",{staticClass:"order-status-img"},[s("img",{attrs:{src:e.$addonAssetsUrl+"order-canceled.svg"}})]),e._v(" "),s("div",{staticClass:"order-status-message"},[e._v(e._s(e.$t("nurse_booking.order_canceled.message")))]),e._v(" "),s("div",{staticClass:"order-status-buttons"},[s("a",{attrs:{href:"/nurse_booking/","data-clear-previous-history":"true"}},[e._v(e._s(e.$t("nurse_booking.order_canceled.home_button")))])])])},staticRenderFns:[]}},{path:"/nurse_booking/order-error/",component:{render:function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("f7-page",{attrs:{name:"nurse_booking__order-error",id:"nurse_booking__order-error","no-navbar":""}},[s("div",{staticClass:"order-status-title"},[e._v(e._s(e.$t("nurse_booking.order_error.title")))]),e._v(" "),s("div",{staticClass:"order-status-img"},[s("img",{attrs:{src:e.$addonAssetsUrl+"order-success.svg"}})]),e._v(" "),s("div",{staticClass:"order-status-buttons"},[s("a",{attrs:{href:"/nurse_booking/order-details/"}},[e._v(e._s(e.$t("nurse_booking.order_error.details_button")))]),e._v(" "),s("a",{attrs:{href:"/nurse_booking/","data-clear-previous-history":"true"}},[e._v(e._s(e.$t("nurse_booking.order_error.home_button")))])])])},staticRenderFns:[]}},{path:"/nurse_booking/order-success/",component:{render:function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("f7-page",{attrs:{name:"nurse_booking__order-success",id:"nurse_booking__order-success","no-navbar":""}},[s("div",{staticClass:"order-status-title"},[e._v(e._s(e.$t("nurse_booking.order_success.title")))]),e._v(" "),s("div",{staticClass:"order-status-img"},[s("img",{attrs:{src:e.$addonAssetsUrl+"order-success.svg"}})]),e._v(" "),s("div",{staticClass:"order-status-buttons"},[s("a",{attrs:{href:"/nurse_booking/order-details/?backToHome=true&id="+e.$f7route.query.id}},[e._v(e._s(e.$t("nurse_booking.order_success.details_button")))]),e._v(" "),s("a",{attrs:{href:"/nurse_booking/","data-clear-previous-history":"true"}},[e._v(e._s(e.$t("nurse_booking.order_success.home_button")))])])])},staticRenderFns:[]}},{path:"/nurse_booking/history/",component:{render:function(){var s=this,e=s.$createElement,a=s._self._c||e;return a("f7-page",{attrs:{name:"nurse_booking__history",id:"nurse_booking__history"}},[a("f7-navbar",[a("tommy-nav-back"),s._v(" "),a("f7-nav-title",[s._v(s._s(s.$t("nurse_booking.history.title")))])],1),s._v(" "),s.ordersSorted?a("div",{staticClass:"orders-list"},s._l(s.ordersSorted,function(e,t){return a("a",{key:t,staticClass:"order-item",attrs:{href:"/nurse_booking/order-details/?id="+e.id}},[a("div",{staticClass:"order-item-header"},[a("div",{staticClass:"order-item-date"},[s._v(s._s(s.formatDate(e.data.date,"D MMM YYYY")))]),s._v(" "),a("div",{staticClass:"order-item-status"},[s._v(s._s(s.$t(e.statusKey)))])]),s._v(" "),a("div",{staticClass:"order-item-content"},[a("div",{staticClass:"order-item-details"},[a("div",{staticClass:"order-item-details-row"},[s._v(s._s(e.name))]),s._v(" "),a("div",{staticClass:"order-item-details-row order-item-details-date"},[s._v(s._s(s.formatDate(e.data.date,"MMM D, YYYY H:m")))])]),s._v(" "),a("div",{staticClass:"order-item-amount"},[s._v("¥"+s._s(e.total))])])])})):s._e()],1)},staticRenderFns:[],data:function data(){return{orders:null}},computed:{ordersSorted:function ordersSorted(){return this.orders?this.orders.sort(function(e,t){return t.id>e.id?1:t.id<e.id?-1:0}):null}},mounted:function mounted(){var t=this;p.getOrdersHistory(t.$root.team.id).then(function(e){e.forEach(function(e){e.statusKey="nurse_booking.history.status_"+(e.canceled?"canceled":e.status),e.data&&e.data.date&&(Number.isNaN(parseInt(e.data.date,10))||(e.data.date=parseInt(e.data.date,10)))}),t.orders=e})},methods:{formatDate:formatDate}}}]}();