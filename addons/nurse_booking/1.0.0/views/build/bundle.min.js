!function i(r,c,l){function u(n,e){if(!c[n]){if(!r[n]){var t="function"==typeof require&&require;if(!e&&t)return t(n,!0);if(d)return d(n,!0);var o=new Error("Cannot find module '"+n+"'");throw o.code="MODULE_NOT_FOUND",o}var a=c[n]={exports:{}};r[n][0].call(a.exports,function(e){return u(r[n][1][e]||e)},a,a.exports,i,r,c,l)}return c[n].exports}for(var d="function"==typeof require&&require,e=0;e<l.length;e++)u(l[e]);return u}({1:[function(e,n,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=window.tommy,a=o.api,i={cache:{services:[],coupons:[],locations:[],booking:{}},getServiceList:function(e){return a.call({endpoint:"vendors/"+o.config.getCurrentTeamId()+"/products",method:"GET",data:{}}).then(function(e){return i.cache.services=e})},getCouponList:function(e){return a.call({endpoint:"vendors/"+o.config.getCurrentTeamId()+"/coupons",method:"GET",data:{}}).then(function(e){return i.cache.coupons=e})},getLocations:function(){return a.call({endpoint:"addons/nurse_booking/install/settings/locations",method:"GET"}).then(function(e){return i.cache.locations=e&&e.data&&e.data.locations?e.data.locations:[],i.cache.locations})},saveLocations:function(e){return e?i.cache.locations=e:e=i.cache.locations,a.call({endpoint:"addons/nurse_booking/install/settings/locations",method:"PUT",data:{data:JSON.stringify({locations:e})}}).then(function(e){return e.data.locations})},addLocation:function(e){return e.default?(i.cache.locations.forEach(function(e){e.default=!1}),i.cache.locations.unshift(e)):i.cache.locations.push(e),i.saveLocations(i.cache.locations)},removeLocation:function(e){return i.cache.locations.splice(e,1),i.saveLocations(i.cache.locations)},sendOrder:function(e){return a.call({endpoint:"vendors/"+o.config.getCurrentTeamId()+"/orders",method:"POST",data:e})}};t.default=i},{}],2:[function(e,n,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o,a=e("../api"),i=(o=a)&&o.__esModule?o:{default:o};var f=window.tommy,l={init:function(e){l.renderDates(),l.renderHours(),l.bind(e)},bind:function(e){l.page=e;var a=$$(e.container);a.on("change",'input[name="date-time-date"]',function(e){l.renderHours(new Date(parseInt(e.target.value,10)))}),a.on("click",".date-time-select-button",function(e){var n=a.find('input[name="date-time-date"]:checked').val(),t=a.find('input[name="date-time-hours"]:checked').val();i.default.cache.booking.date=new Date(parseInt(n,10)).getTime()+60*t*60*1e3;var o=f.util.addonAssetUrl(Template7.global.currentAddonInstall.package,Template7.global.currentAddonInstall.version,"views/order-confirm.html",!0);f.app.f7.views.main.loadPage({url:o})})},renderDates:function(){for(var e=new Date,n=e.getTime(),t=[],o=void 0,a=0;a<=13;a+=1){var i=new Date(n+24*a*60*60*1e3),r=i.getMonth()+1,c=i.getDate();c<10&&(c="0"+c),r<10&&(r="0"+r);var l=i.getDay(),u=0===a,d=!!u&&19<=e.getHours();d&&(o=!0);var s=o?1===a:u;t.push({disabled:d,value:new Date(i.getFullYear(),i.getMonth(),i.getDate()).getTime(),day:c,month:r,weekDay:f.i18n.t("date_time.week_days."+l),today:u,checked:s})}f.tplManager.renderInline("nurse_booking__dateTimeDatesTemplate",{dates:t})},renderHours:function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:new Date,n=[],t=new Date,o=void 0,a=void 0;if(t.getFullYear()===e.getFullYear()&&t.getMonth()===e.getMonth()&&t.getDate()===e.getDate()&&(o=!0),o&&19<=t.getHours())l.renderHours(new Date(t.getTime()+864e5));else{for(var i=10;i<=19;i+=1){var r=!!o&&t.getHours()>=i,c=!1;r||a||(a=c=!0),n.push({value:i,disabled:r,checked:c,hour:i+":00"})}f.tplManager.renderInline("nurse_booking__dateTimeHoursTemplate",{hours:n})}},uninit:function(){l.page=null,delete l.page}};t.default=l},{"../api":1}],3:[function(e,n,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o,a=e("../api");(o=a)&&o.__esModule;var i={init:function(e){console.log("initialize nurse booking addon"),i.bind(e);var n=$$(e.container);window.tommy.app.f7.swiper(n.find(".swiper-container"),{pagination:".swiper-pagination"})},bind:function(e){i.page=e},uninit:function(){i.page=null,delete i.page,console.log("uninitialize nurse booking addon")}};t.default=i},{"../api":1}],4:[function(e,n,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o,a=e("../api"),u=(o=a)&&o.__esModule?o:{default:o};var d=window.tommy,i={init:function(e){i.loadLocations(),i.bind(e)},bind:function(r){i.page=r;var n=$$(r.container),c=d.app.f7,l=u.default.cache.booking.service;n.on("click",".location-delete-button",function(){var e=parseInt($$(this).attr("data-location-index"),10);u.default.removeLocation(e).then(function(){i.render()})}),n.on("click",".location-save-button",function(e){var n=$$(this).parents(".location-add-form"),t=n.find('input[name="city"]').val().trim(),o=n.find('textarea[name="address"]').val().trim(),a=n.find('input[name="default"]').prop("checked");if(t&&o){(l.data.available_in||l.data.availabile_in||[]).forEach(function(e){e.toLowerCase()===t.toLowerCase()&&!0}),u.default.addLocation({city:t,address:o,default:a}).then(function(){i.render()})}}),n.on("click",".location-add-button",function(e){n.find(".page-content").append(d.tplManager.render("nurse_booking__locationsTemplate",{locations:[]})),n.find(".location-add-button").hide()}),n.on("click",".location-select-button",function(e){var n=parseInt($$(this).attr("data-location-index"),10),t=u.default.cache.locations[n],o=t.city,a=void 0;if((l.data.available_in||l.data.availabile_in||[]).forEach(function(e){e.toLowerCase()===o.toLowerCase()&&(a=!0)}),a)if(u.default.cache.booking.location=t,r.query.back)c.views.main.back();else{var i=d.util.addonAssetUrl(Template7.global.currentAddonInstall.package,Template7.global.currentAddonInstall.version,"views/date-time.html",!0);c.views.main.loadPage({url:i})}else c.alert(d.i18n.t("location.not_available"))})},loadLocations:function(){u.default.getLocations().then(function(){i.render()})},render:function(){d.tplManager.renderInline("nurse_booking__locationsTemplate",{locations:u.default.cache.locations})},uninit:function(){i.page=null,delete i.page}};t.default=i},{"../api":1}],5:[function(e,n,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var u=o(e("../api")),i=o(e("../coupon-picker"));function o(e){return e&&e.__esModule?e:{default:e}}var d=window.tommy,r={init:function(e){r.bind(e),r.render()},bind:function(e){r.page=e;var n=$$(e.container),t=d.app.f7,o=u.default.cache.booking.service,a=d.util.addonAssetUrl(Template7.global.currentAddonInstall.package,Template7.global.currentAddonInstall.version,"views/location.html",!0);n.on("click","a.order-confirm-select-location",function(){t.views.main.loadPage({url:a+"&back=true"})}),n.on("click","a.order-confirm-select-coupon",function(){(0,i.default)(o.coupons,function(e){u.default.cache.booking.coupon=e,r.render()},function(){},u.default.cache.booking.coupon)}),n.on("click","a.order-confirm-pay-button",function(){r.pay()})},onBeforeIn:function(e){"left"===e.from&&setTimeout(function(){r.render()},0)},render:function(){var e=u.default.cache.booking,n=e.service,t=e.coupon,o=e.location,a=e.date;d.tplManager.renderInline("nurse_booking__orderConfirmTemplate",{user:window.tommy.config.getCurrentUser(),service:n,coupon:t,total:n.price-(t?t.amount:0),location:o,date:a})},pay:function(){var e=u.default.cache.booking,o=e.service,a=e.coupon,i=e.location,r=e.date,c=d.app.f7,l=o.price-(a?a.amount:0);d.initWalletTransaction({addon:"nurse_booking",payee_name:o.name,currency:"CNY",amount:l},function(e){var n={vendor_product_id:o.id,vendor_coupon_id:a?a.id:null,wallet_transaction_id:e.id,name:o.name,comment:"",data:{location:i,date:r},discount:a?a.amount:0,total:l};u.default.sendOrder(n),u.default.cache.booking.transaction=e;var t=d.util.addonAssetUrl(Template7.global.currentAddonInstall.package,Template7.global.currentAddonInstall.version,"views/order-success.html",!0);c.views.main.loadPage({url:t})})},uninit:function(){r.page=null,delete r.page}};t.default=r},{"../api":1,"../coupon-picker":9}],6:[function(e,n,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o,a=e("../api"),r=(o=a)&&o.__esModule?o:{default:o};var c=window.tommy,i={init:function(e){i.bind(e),i.render()},bind:function(e){i.page=e},render:function(){var e=r.default.cache.booking,n=e.transaction,t=e.service,o=e.coupon,a=e.location,i=e.date;c.tplManager.renderInline("nurse_booking__orderDetailsTemplate",{service:t,coupon:o,total:t.price-(o?o.amount:0),location:a,date:i,transaction:n})},uninit:function(){i.page=null,delete i.page}};t.default=i},{"../api":1}],7:[function(e,n,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var c=o(e("../api")),l=o(e("../coupon-picker"));function o(e){return e&&e.__esModule?e:{default:e}}var u=window.tommy,d={init:function(e){d.bind(e)},bind:function(e){d.page=e;var n=$$(e.container),t=u.app.f7,o=e.query.id,a={},i=void 0;(c.default.cache.services||[]).forEach(function(e){e.id===parseInt(o,10)&&((a=e).coupons=c.default.cache.coupons.filter(function(e){return e.vendor_product_id===a.id}))}),$$(e.navbarInnerContainer).find(".center").text(a.name),t.sizeNavbars();var r=u.util.addonAssetUrl(Template7.global.currentAddonInstall.package,Template7.global.currentAddonInstall.version,"views/location.html",!0);u.tplManager.renderTarget("nurse_booking__serviceDetailsTemplate",{service:a},e.container),t.swiper(n.find(".swiper-container"),{pagination:".swiper-pagination"}),$$(e.container).on("click",".service-details-coupons-link",function(){(0,l.default)(a.coupons,function(e){i=e,c.default.cache.booking.service=a,c.default.cache.booking.coupon=i,t.views.main.loadPage({url:r})},function(){i=void 0})}),$$(e.container).on("click",".service-book-button",function(){(c.default.cache.booking.service=a).coupons&&a.coupons.length?(0,l.default)(a.coupons,function(e){i=e,c.default.cache.booking.service=a,c.default.cache.booking.coupon=i,t.views.main.loadPage({url:r})},function(){c.default.cache.booking.coupon=null,delete c.default.cache.booking.coupon,i=void 0,t.views.main.loadPage({url:r})}):(c.default.cache.booking.coupon=null,delete c.default.cache.booking.coupon,i=void 0,t.views.main.loadPage({url:r}))})},uninit:function(){d.page=null,delete d.page}};t.default=d},{"../api":1,"../coupon-picker":9}],8:[function(e,n,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o,l=function(e,n){if(Array.isArray(e))return e;if(Symbol.iterator in Object(e))return function(e,n){var t=[],o=!0,a=!1,i=void 0;try{for(var r,c=e[Symbol.iterator]();!(o=(r=c.next()).done)&&(t.push(r.value),!n||t.length!==n);o=!0);}catch(e){a=!0,i=e}finally{try{!o&&c.return&&c.return()}finally{if(a)throw i}}return t}(e,n);throw new TypeError("Invalid attempt to destructure non-iterable instance")},a=e("../api"),u=(o=a)&&o.__esModule?o:{default:o};var d=window.tommy,s={init:function(e){s.bind(e),s.loadServices()},bind:function(e){s.page=e},loadServices:function(){var e=s.page,i=$$(e.container),r=d.app.f7,c=e.query.category;$$(e.navbarInnerContainer).find(".center").text(d.i18n.t("service_list."+c.toLowerCase()+"_title")),r.sizeNavbars(),Promise.all([u.default.getServiceList(),u.default.getCouponList()]).then(function(e){var n=l(e,2),t=n[0],o=n[1],a=t.filter(function(e){return e.category===c});a.forEach(function(n){n.coupons=o.filter(function(e){return e.vendor_product_id===n.id})}),d.tplManager.renderInline("nurse_booking__serviceListTemplate",{services:a}),r.swiper(i.find(".swiper-container"),{centeredSlides:!0,slidesPerView:"auto"})})},uninit:function(){s.page=null,delete s.page}};t.default=s},{"../api":1}],9:[function(e,n,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(n,e,t,o){var a=window.tommy.app.f7,i=void 0,r=void 0,c=n.map(function(e){return Object.assign({},e,{checked:!!o&&e.id===o.id})}),l=tommy.tplManager.render("nurse_bookink__couponPickerTemplate",{coupons:c}),u=a.modal({afterText:l,buttons:[{text:tommy.i18n.t("coupon_picker.skip_button",{defaultValue:"Skip"}),onClick:function(){t&&t()}},{text:tommy.i18n.t("coupon_picker.confirm_button",{defaultValue:"Confirm"}),bold:!0,onClick:function(){e&&e(r)}}]}),d=$$(u);d.addClass("nurse_booking-coupon-picker-modal"),d.find(".modal-button-bold").addClass("modal-button-disabled"),d.find("input").on("change",function(e){d.find(".modal-button-bold").removeClass("modal-button-disabled"),e.target.checked&&(i=e.target.value,n.forEach(function(e){e.id==parseInt(i,10)&&(r=e)}))})}},{}],10:[function(e,n,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){return e&&o[e]?o[e]:""};var o={AED:"د.إ",AFN:"؋",ALL:"L",AMD:"֏",ANG:"ƒ",AOA:"Kz",ARS:"$",AUD:"$",AWG:"ƒ",AZN:"₼",BAM:"KM",BBD:"$",BDT:"৳",BGN:"лв",BHD:".د.ب",BIF:"FBu",BMD:"$",BND:"$",BOB:"$b",BRL:"R$",BSD:"$",BTC:"฿",BTN:"Nu.",BWP:"P",BYR:"Br",BYN:"Br",BZD:"BZ$",CAD:"$",CDF:"FC",CHF:"CHF",CLP:"$",CNY:"¥",COP:"$",CRC:"₡",CUC:"$",CUP:"₱",CVE:"$",CZK:"Kč",DJF:"Fdj",DKK:"kr",DOP:"RD$",DZD:"دج",EEK:"kr",EGP:"£",ERN:"Nfk",ETB:"Br",ETH:"Ξ",EUR:"€",FJD:"$",FKP:"£",GBP:"£",GEL:"₾",GGP:"£",GHC:"₵",GHS:"GH₵",GIP:"£",GMD:"D",GNF:"FG",GTQ:"Q",GYD:"$",HKD:"$",HNL:"L",HRK:"kn",HTG:"G",HUF:"Ft",IDR:"Rp",ILS:"₪",IMP:"£",INR:"₹",IQD:"ع.د",IRR:"﷼",ISK:"kr",JEP:"£",JMD:"J$",JOD:"JD",JPY:"¥",KES:"KSh",KGS:"лв",KHR:"៛",KMF:"CF",KPW:"₩",KRW:"₩",KWD:"KD",KYD:"$",KZT:"лв",LAK:"₭",LBP:"£",LKR:"₨",LRD:"$",LSL:"M",LTC:"Ł",LTL:"Lt",LVL:"Ls",LYD:"LD",MAD:"MAD",MDL:"lei",MGA:"Ar",MKD:"ден",MMK:"K",MNT:"₮",MOP:"MOP$",MRO:"UM",MRU:"UM",MUR:"₨",MVR:"Rf",MWK:"MK",MXN:"$",MYR:"RM",MZN:"MT",NAD:"$",NGN:"₦",NIO:"C$",NOK:"kr",NPR:"₨",NZD:"$",OMR:"﷼",PAB:"B/.",PEN:"S/.",PGK:"K",PHP:"₱",PKR:"₨",PLN:"zł",PYG:"Gs",QAR:"﷼",RMB:"￥",RON:"lei",RSD:"Дин.",RUB:"₽",RWF:"R₣",SAR:"﷼",SBD:"$",SCR:"₨",SDG:"ج.س.",SEK:"kr",SGD:"$",SHP:"£",SLL:"Le",SOS:"S",SRD:"$",SSP:"£",STD:"Db",STN:"Db",SVC:"$",SYP:"£",SZL:"E",THB:"฿",TJS:"SM",TMT:"T",TND:"د.ت",TOP:"T$",TRL:"₤",TRY:"₺",TTD:"TT$",TVD:"$",TWD:"NT$",TZS:"TSh",UAH:"₴",UGX:"USh",USD:"$",UYU:"$U",UZS:"лв",VEF:"Bs",VND:"₫",VUV:"VT",WST:"WS$",XAF:"FCFA",XBT:"Ƀ",XCD:"$",XOF:"CFA",XPF:"₣",YER:"﷼",ZAR:"R",ZWD:"Z$"}},{}],11:[function(e,n,t){"use strict";var o=s(e("./currency-map")),a=(s(e("./coupon-picker")),s(e("./controllers/index"))),i=s(e("./controllers/service-list")),r=s(e("./controllers/service-details")),c=s(e("./controllers/location")),l=s(e("./controllers/date-time")),u=s(e("./controllers/order-confirm")),d=s(e("./controllers/order-details"));function s(e){return e&&e.__esModule?e:{default:e}}var f=window.tommy.app,p=f.f7,g=f.t7;p.onPageInit("nurse_booking__index",a.default.init),p.onPageBeforeRemove("nurse_booking__index",a.default.uninit),p.onPageInit("nurse_booking__service-list",i.default.init),p.onPageBeforeRemove("nurse_booking__service-list",i.default.uninit),p.onPageInit("nurse_booking__service-details",r.default.init),p.onPageBeforeRemove("nurse_booking__service-details",r.default.uninit),p.onPageInit("nurse_booking__location",c.default.init),p.onPageBeforeRemove("nurse_booking__location",c.default.uninit),p.onPageInit("nurse_booking__date-time",l.default.init),p.onPageBeforeRemove("nurse_booking__date-time",l.default.uninit),p.onPageInit("nurse_booking__order-confirm",u.default.init),p.onPageBeforeAnimation("nurse_booking__order-confirm",u.default.onBeforeIn),p.onPageBeforeRemove("nurse_booking__order-confirm",u.default.uninit),p.onPageInit("nurse_booking__order-details",d.default.init),p.onPageBeforeRemove("nurse_booking__order-details",d.default.uninit),g.registerHelper("nurse_booking__currencySymbol",function(e){return(0,o.default)(e)})},{"./controllers/date-time":2,"./controllers/index":3,"./controllers/location":4,"./controllers/order-confirm":5,"./controllers/order-details":6,"./controllers/service-details":7,"./controllers/service-list":8,"./coupon-picker":9,"./currency-map":10}]},{},[11]);