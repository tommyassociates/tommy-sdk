var addon=function(){var e=window.tommy,n=e.api,i={actor:void 0,actorId:void 0,loadListTransactions:function loadListTransactions(t,a){if(void 0===a&&(a=[]),t.data&&t.filters)for(var e=0;e<t.filters.length;e+=1)a.push(t.filters[e].name);var s={tags:a,with_filters:!0,with_permission_to:!0};return t.data.date_range&&(s.date_range=t.data.date_range),t.data.amount_min&&(s.amount_min=t.data.amount_min),t.data.amount_max&&(s.amount_max=t.data.amount_max),t.data.statuses&&(s.status=t.data.statuses),(i.actorId||t.actorId)&&(s.executor_id=i.actorId||t.actorId),n.call({endpoint:"wallet/manager/transactions",data:s})},saveTransaction:function saveTransaction(t){return n.call({endpoint:"wallet/manager/transactions",method:"POST",data:t})},loadTransaction:function loadTransaction(t){return n.call({endpoint:"wallet/manager/transactions/"+t,method:"GET"})},loadList:function loadList(t){return n.getFragment(t,{data:{addon:"wallet_accounts",kind:"TransactionList",with_filters:!0,with_permission_to:!0}})},loadLists:function loadLists(t){return void 0===t&&(t={}),i.actorId?new Promise(function(t){t([{actorId:i.actorId,data:{active:!0,default:!0,position:0,statuses:[]},id:"actor-"+i.actorId,kind:"TransactionList",name:"Transactions",permission_to:["create","read","update","delete"]}])}):n.getFragments(Object.assign({addon:"wallet_accounts",kind:"TransactionList",with_filters:!0,with_permission_to:!0},t))},deleteList:function deleteList(t){return n.deleteFragment(t)},saveList:function saveList(t){t.addon="wallet_accounts",t.kind="TransactionList",t.with_filters=!0,t.with_permission_to=!0,t.data||(t.data={}),void 0===t.data.position&&(t.data.position=0),void 0===t.data.active&&(t.data.active=!0),t.id||(t.with_permissions=["wallet_accounts_transaction_list_read_access","wallet_accounts_transaction_list_edit_access"]);var a=Object.assign({},t,{data:JSON.stringify(t.data),filters:JSON.stringify(t.filters)});return t.id?n.updateFragment(t.id,a):n.createFragment(a)},createDefaultList:function createDefaultList(t){var a={name:e.i18n.t("wallet_accounts.index.default-list-name"),data:{default:!0},filters:[]};return i.saveList(a)},getCards:function getCards(){return n.call({endpoint:"wallet/manager/cards?with_holder=true"})},getActorCard:function getActorCard(){return n.call({endpoint:"wallet/manager/cards?with_holder=true"}).then(function(t){var a;return t.forEach(function(t){t&&t.holder&&parseInt(t.holder.id,10)===parseInt(i.actorId,10)&&(a=t)}),a})},saveBalance:function saveBalance(t,a,e){return n.call({endpoint:"wallet/manager/cards/"+t,method:"PUT",data:{balance:a,credit_limit:e}}).then(function(t){return t[0]})}};function formatTransactionDate(t){if(!t)return"";var a=new Date(t),e=a.getFullYear(),s=a.getMonth()+1;s<10&&(s="0"+s);var n=a.getDate();n<10&&(n="0"+n);var i=a.getHours();i<10&&(i="0"+i);var o=a.getMinutes();return o<10&&(o="0"+o),e+"-"+s+"-"+n+" "+i+":"+o}var a={AED:"د.إ",AFN:"؋",ALL:"L",AMD:"֏",ANG:"ƒ",AOA:"Kz",ARS:"$",AUD:"$",AWG:"ƒ",AZN:"₼",BAM:"KM",BBD:"$",BDT:"৳",BGN:"лв",BHD:".د.ب",BIF:"FBu",BMD:"$",BND:"$",BOB:"$b",BRL:"R$",BSD:"$",BTC:"฿",BTN:"Nu.",BWP:"P",BYR:"Br",BYN:"Br",BZD:"BZ$",CAD:"$",CDF:"FC",CHF:"CHF",CLP:"$",CNY:"¥",COP:"$",CRC:"₡",CUC:"$",CUP:"₱",CVE:"$",CZK:"Kč",DJF:"Fdj",DKK:"kr",DOP:"RD$",DZD:"دج",EEK:"kr",EGP:"£",ERN:"Nfk",ETB:"Br",ETH:"Ξ",EUR:"€",FJD:"$",FKP:"£",GBP:"£",GEL:"₾",GGP:"£",GHC:"₵",GHS:"GH₵",GIP:"£",GMD:"D",GNF:"FG",GTQ:"Q",GYD:"$",HKD:"$",HNL:"L",HRK:"kn",HTG:"G",HUF:"Ft",IDR:"Rp",ILS:"₪",IMP:"£",INR:"₹",IQD:"ع.د",IRR:"﷼",ISK:"kr",JEP:"£",JMD:"J$",JOD:"JD",JPY:"¥",KES:"KSh",KGS:"лв",KHR:"៛",KMF:"CF",KPW:"₩",KRW:"₩",KWD:"KD",KYD:"$",KZT:"лв",LAK:"₭",LBP:"£",LKR:"₨",LRD:"$",LSL:"M",LTC:"Ł",LTL:"Lt",LVL:"Ls",LYD:"LD",MAD:"MAD",MDL:"lei",MGA:"Ar",MKD:"ден",MMK:"K",MNT:"₮",MOP:"MOP$",MRO:"UM",MRU:"UM",MUR:"₨",MVR:"Rf",MWK:"MK",MXN:"$",MYR:"RM",MZN:"MT",NAD:"$",NGN:"₦",NIO:"C$",NOK:"kr",NPR:"₨",NZD:"$",OMR:"﷼",PAB:"B/.",PEN:"S/.",PGK:"K",PHP:"₱",PKR:"₨",PLN:"zł",PYG:"Gs",QAR:"﷼",RMB:"￥",RON:"lei",RSD:"Дин.",RUB:"₽",RWF:"R₣",SAR:"﷼",SBD:"$",SCR:"₨",SDG:"ج.س.",SEK:"kr",SGD:"$",SHP:"£",SLL:"Le",SOS:"S",SRD:"$",SSP:"£",STD:"Db",STN:"Db",SVC:"$",SYP:"£",SZL:"E",THB:"฿",TJS:"SM",TMT:"T",TND:"د.ت",TOP:"T$",TRL:"₤",TRY:"₺",TTD:"TT$",TVD:"$",TWD:"NT$",TZS:"TSh",UAH:"₴",UGX:"USh",USD:"$",UYU:"$U",UZS:"лв",VEF:"Bs",VND:"₫",VUV:"VT",WST:"WS$",XAF:"FCFA",XBT:"Ƀ",XCD:"$",XOF:"CFA",XPF:"₣",YER:"﷼",ZAR:"R",ZWD:"Z$"};function formatTransactionAmount(t){return("paid"===t.status||"failed"===t.status?"-":"+")+" "+function currencyMap(t){return t&&a[t]?a[t]:""}(t.currency)+t.amount}var t={render:function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"tag-select wallet_accounts-tag-select wallet_accounts-list-tags-select"},[s("ul",[s("li",{staticClass:"item-divider"},[e._v(e._s(e.$t("wallet_accounts.permissions."+e.data.name+".title")))]),e._v(" "),s("li",[s("a",{staticClass:"item-link tag-search",attrs:{href:"#"},on:{click:e.openSelector}},[s("div",{staticClass:"item-content"},[e._m(0),e._v(" "),s("div",{staticClass:"item-inner"},[s("div",{staticClass:"item-title"},[e._v(e._s(e.$t("wallet_accounts.common.search_members_tags","Search Members, Tags")))])])])])])]),e._v(" "),s("ul",{staticClass:"tag-items"},e._l(e.data.filters,function(a,t){return s("li",{key:t,staticClass:"tag-item"},[s("div",{staticClass:"item-content"},[s("div",{staticClass:"item-inner"},[s("div",{staticClass:"item-title"},[e._v(e._s(a.name))]),e._v(" "),s("div",{staticClass:"item-after"},[s("a",{staticClass:"item-link",staticStyle:{height:"24px"},attrs:{href:"#"},on:{click:function(t){e.removeTag(a)}}},[s("i",{staticClass:"material-icons"},[e._v("close")])])])])])])}))])},staticRenderFns:[function(){var t=this.$createElement,a=this._self._c||t;return a("div",{staticClass:"item-media"},[a("i",{staticClass:"material-icons md-36"},[this._v("search")])])}],props:{data:Object,listId:[String,Number]},data:function data(){return{teamTags:null}},mounted:function mounted(){var a=this;a.$api.getCurrentTeamTags({cache:!0}).then(function(t){a.teamTags=t})},methods:{openSelector:function openSelector(){var e=this;e.$f7router.navigate("/wallet_accounts/tag-select/",{props:{filters:e.data.filters,pageTitle:e.$t("wallet_accounts.permissions."+e.data.name+".title"),teamTags:e.teamTags,onChange:function onChange(t,a){a?e.$emit("tagAdd",t):e.$emit("tagRemove",t)}}})},removeTag:function removeTag(t){this.$emit("tagRemove",t)}}};function formatDate(t){var a=new Date(t),e=a.getFullYear(),s=a.getMonth()+1,n=a.getDate();return s<10&&(s="0"+s),n<10&&(n="0"+n),e+"-"+s+"-"+n}return[{path:"/wallet_accounts/",component:{render:function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("f7-page",{staticClass:"wallet_accounts__page",attrs:{id:"wallet_accounts__index",name:"wallet_accounts__index"}},[s("f7-navbar",[s("tommy-nav-menu"),e._v(" "),s("f7-nav-title",[e._v(e._s(e.$t("wallet_accounts.index.title","Wallet Accounts")))]),e._v(" "),s("f7-nav-right",[s("f7-link",{attrs:{href:"/wallet_accounts/board-settings/","icon-f7":"gear"}}),e._v(" "),s("f7-link",{attrs:{"icon-f7":"add","popover-open":"#wallet_accounts__index-popover"}})],1)],1),e._v(" "),e.orderedLists&&e.orderedLists.length?s("f7-swiper",{attrs:{params:{slidesPerView:"auto",breakpointsInverse:!0,centeredSlides:!1,touchMoveStopPropagation:!1,on:{tap:e.onSlideClick},breakpoints:{768:{centeredSlides:!0}}}}},e._l(e.orderedLists,function(t){return s("f7-swiper-slide",{key:t.id},[s("div",{staticClass:"tasks-list",class:{hasScroll:e.listWithScroll[t.id]},attrs:{"data-id":t.id}},[s("div",{staticClass:"tasks-list-header"},[s("div",[e._v(e._s(t.name))]),e._v(" "),e.actorId?e._e():s("div",[s("a",{attrs:{"data-url":"/wallet_accounts/list-edit/"+t.id+"/"}},[s("img",{attrs:{src:e.$addonAssetsUrl+"slice6.png",srcset:e.$addonAssetsUrl+"slice6@2x.png 2x, "+e.$addonAssetsUrl+"slice6@3x.png 3x"}})])])]),e._v(" "),s("div",{staticClass:"tasks-list-content"},[s("div",{staticClass:"card transactions-card"},[t.transactions&&t.transactions.length?s("f7-list",{staticClass:"transactions-list no-chevron",attrs:{"media-list":""}},e._l(t.transactions,function(t,a){return s("li",{key:a},[s("a",{staticClass:"item-content item-link",attrs:{"data-url":"/wallet_accounts/transaction-details/"+t.id+"/"}},[s("div",{staticClass:"item-media"},[t.icon_url?s("img",{attrs:{src:t.icon_url}}):s("i",{staticClass:"wallet-icon-placeholder"})]),e._v(" "),s("div",{staticClass:"item-inner"},[s("div",{staticClass:"item-details"},[s("div",{staticClass:"item-title-row"},[s("div",{staticClass:"item-title"},[e._v(e._s(t.payee_name))])]),e._v(" "),s("div",{staticClass:"item-text"},[e._v(e._s(e.formatTransactionDate(t.paid_at)))])]),e._v(" "),s("div",{staticClass:"item-after"},[e._v(e._s(e.formatTransactionAmount(t)))])])])])})):e._e(),e._v(" "),t.transactions&&!t.transactions.length?s("div",{staticStyle:{padding:"15px"}},[e._v(e._s(e.$t("wallet_accounts.index.no_transactions_found","No transactions found")))]):e._e()],1)])])])})):e._e(),e._v(" "),s("f7-popover",{attrs:{id:"wallet_accounts__index-popover"}},[s("f7-list",[s("f7-list-button",{attrs:{"popover-close":"",href:"/wallet_accounts/list-add/"}},[e._v(e._s(e.$t("wallet_accounts.list-add.title","Add List")))]),e._v(" "),s("f7-list-button",{attrs:{"popover-close":"",href:"/wallet_accounts/transaction-add/"}},[e._v(e._s(e.$t("wallet_accounts.transaction-add.title","New Transaction")))])],1)],1)],1)},staticRenderFns:[],data:function data(){return{lists:null,actorId:this.$f7route.query.actor_id,listWithScroll:{}}},created:function created(){this.actorId?(i.actorId=parseInt(this.actorId,10),i.actor=this.actor):(delete i.actorId,delete i.actor)},computed:{actor:function actor(){var a=this;return a.actorId?a.$root.teamMembers.filter(function(t){return t.user_id===parseInt(a.actorId,10)})[0]:null},orderedLists:function orderedLists(){return this.lists?this.lists.sort(function(t,a){return t.data.position-a.data.position}).filter(function(t){return t.data.active}):null}},methods:{onSlideClick:function onSlideClick(t){var a=this.$$(t.target).closest("a").eq(0).attr("data-url");a&&this.$f7router.navigate(a)},formatTransactionDate:formatTransactionDate,formatTransactionAmount:formatTransactionAmount,listHasScroll:function listHasScroll(t){if(!t.tasks||0===t.tasks.length)return!1;var a=this.$$('.tasks-list[data-id="'+t.id+'"] .tasks-list-content')[0];return!!a&&a.scrollHeight>a.offsetHeight},loadListTransactions:function loadListTransactions(a){var e=this;e.actor||e.$root.user;i.loadListTransactions(a).then(function(t){a.transactions=t,e.$nextTick(function(){e.listHasScroll(a)?e.$set(e.listWithScroll,a.id,!0):e.$set(e.listWithScroll,a.id,!1)})})},reloadListTransactions:function reloadListTransactions(){var a=this;a.lists&&a.lists.forEach(function(t){a.loadListTransactions(t)})},loadLists:function loadLists(t){var a=this;i.loadLists({},{cache:!t}).then(function(t){t.forEach(function(t){t.transactions=[]}),a.lists=t,0<a.lists.filter(function(t){return t.data.default}).length||a.actorId?a.lists.forEach(function(t){t.data.active&&a.loadListTransactions(t)}):i.createDefaultList(a.$root.user).then(function(){a.loadLists()})})},reloadLists:function reloadLists(){this.loadLists(!0)}},beforeDestroy:function beforeDestroy(){this.$events.$off("wallet_accounts:reloadListsTransactions",this.reloadListsTransactions),this.$events.$off("wallet_accounts:reloadLists",this.reloadLists)},mounted:function mounted(){var t=this;t.loadLists(),t.$events.$on("wallet_accounts:reloadListsTransactions",t.reloadListsTransactions),t.$events.$on("wallet_accounts:reloadLists",t.reloadLists)}}},{path:"/wallet_accounts/transaction-add/",component:{render:function(){var a=this,t=a.$createElement,e=a._self._c||t;return e("f7-page",{staticClass:"with-toggle-save wallet_accounts__page",attrs:{id:"wallet_accounts__transaction-add",name:"wallet_accounts__transaction-add"}},[e("f7-navbar",[e("tommy-nav-back"),a._v(" "),e("f7-nav-title",[a._v(a._s(a.$t("wallet_accounts.transaction-add.title","New Transaction")))]),a._v(" "),a.showSave?e("f7-nav-right",[e("f7-link",{attrs:{"icon-f7":"check"},on:{click:a.save}})],1):a._e()],1),a._v(" "),e("f7-list",{staticClass:"list-custom"},[e("f7-list-input",{attrs:{type:"number",min:"0",value:a.amount,placeholder:a.$t("wallet_accounts.transaction-add.amount_placeholder","Amount")},on:{input:function(t){a.amount=parseFloat(t.target.value)}}}),a._v(" "),e("f7-list-input",{attrs:{type:"text",value:a.payee_name,placeholder:a.$t("wallet_accounts.transaction-add.payee_placeholder","Payee")},on:{input:function(t){a.payee_name=t.target.value}}}),a._v(" "),a.cards&&a.cards.length?e("f7-list-item",{attrs:{"smart-select":"","smart-select-params":{searchbar:!0,pageBackLinkText:a.$t("label.back"),searchbarPlaceholder:a.$t("label.search"),searchbarDisableText:a.$t("label.cancel")},title:a.$t("wallet_accounts.transaction-add.wallet_account_placeholder")}},[e("select",{domProps:{value:a.wallet_card_id},on:{change:function(t){a.wallet_card_id=parseInt(t.target.value,10)}}},a._l(a.cards,function(t){return e("option",{key:t.id,attrs:{"data-option-class":"wallet_accounts_smart-select-option","data-option-image":t.holder.icon_url},domProps:{value:t.id}},[a._v(a._s(t.holder.first_name||"")+" "+a._s(t.holder.last_name||""))])}))]):a._e()],1)],1)},staticRenderFns:[],data:function data(){return{saving:!1,amount:"",payee_name:"",wallet_card_id:null,cards:null}},computed:{showSave:function showSave(){var t=this.saving,a=this.amount,e=this.payee_name;return!t&&a&&0<a&&e&&e.trim().length}},mounted:function mounted(){var a=this;i.getCards().then(function(t){a.wallet_card_id=t[0].id,a.cards=t})},methods:{save:function save(){var t=this;t.saving=!0;var a=this.amount,e=this.payee_name,s=this.wallet_card_id;a?e?i.saveTransaction({amount:a,wallet_card_id:s,payee_name:e,status:"paid",addon:"wallet_accounts",addon_id:void 0,addon_install_id:void 0}).then(function(){t.$events.$emit("wallet_accounts:reloadLists"),t.$f7router.back()}):t.$f7.dialog.alert(t.$t("wallet_accounts.transaction-add.no_payee_error")):t.$f7.dialog.alert(t.$t("wallet_accounts.transaction-add.no_amount_error"))}}}},{path:"/wallet_accounts/board-settings/",component:{render:function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("f7-page",{staticClass:"wallet_accounts__page",attrs:{id:"wallet_accounts__board-settings",name:"wallet_accounts__board-settings"}},[s("f7-navbar",[s("tommy-nav-back"),e._v(" "),s("f7-nav-title",[e._v(e._s(e.$t("wallet_accounts.board-settings.title","Settings")))])],1),e._v(" "),s("f7-list",{staticClass:"list-custom"},[e.hasActorId?s("f7-list-item",{attrs:{link:"/wallet_accounts/wallet-balance/",title:e.$t("wallet_accounts.board-settings.wallet-balance","Wallet Balance")}}):s("f7-list-item",{attrs:{link:"/wallet_accounts/list-management/",title:e.$t("wallet_accounts.board-settings.list-management","List Management")}}),e._v(" "),e._l(e.permissions,function(a,t){return e.hasActorId?e._e():s("tag-select",{key:t,attrs:{data:a},on:{tagAdd:function(t){return e.addListPermission(a,t)},tagRemove:function(t){return e.removeListPermission(a,t)}}})})],2)],1)},staticRenderFns:[],components:{tagSelect:t},data:function data(){return{hasActorId:i.actorId,permissions:[]}},mounted:function mounted(){var a=this;a.$api.getInstalledAddonPermission("wallet_accounts","wallet_accounts_transaction_create_access",{resource_id:void 0,with_filters:!0}).then(function(t){t.resource_id=void 0,a.permissions.push(t)}),a.$api.getInstalledAddonPermission("wallet_accounts","wallet_accounts_transaction_edit_access",{resource_id:void 0,with_filters:!0}).then(function(t){t.resource_id=void 0,a.permissions.push(t)})},methods:{saveListPermission:function saveListPermission(t){this.$api.updateInstalledAddonPermission("wallet_accounts",t.name,{resource_id:t.resource_id,with_filters:!0,filters:JSON.stringify(t.filters)})},addListPermission:function addListPermission(t,a){t.filters.push(a),this.saveListPermission(t)},removeListPermission:function removeListPermission(t,a){t.filters.splice(t.filters.indexOf(a),1),this.saveListPermission(t)}}}},{path:"/wallet_accounts/list-management/",component:{render:function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("f7-page",{staticClass:"wallet_accounts__page",attrs:{name:"wallet_accounts__list-management",id:"wallet_accounts__list-management"}},[s("f7-navbar",[s("tommy-nav-back"),e._v(" "),s("f7-nav-title",[e._v(e._s(e.$t("wallet_accounts.list-management.title","List Management")))]),e._v(" "),s("f7-nav-right",[e.showSave?s("f7-link",{attrs:{"icon-f7":"check"},on:{click:e.save}}):e._e()],1)],1),e._v(" "),e.lists?s("f7-list",{staticClass:"list-custom",attrs:{sortable:"",sortableEnabled:"",inset:""},on:{"sortable:sort":e.onSort}},e._l(e.orderedLists,function(a){return s("f7-list-item",{key:a.id,attrs:{checkbox:"",checked:a.data.active,title:a.name},on:{change:function(t){e.toggleListActive(a,t.target.checked)}}})})):e._e(),e._v(" "),s("f7-list",{staticClass:"list-custom margin-bottom",attrs:{inset:""}},[s("f7-list-item",{attrs:{link:"/wallet_accounts/list-add/",title:e.$t("wallet_accounts.list-management.create_new_list")}})],1)],1)},staticRenderFns:[],data:function data(){return{saving:!1,showSave:!1,lists:null}},mounted:function mounted(){var a=this;i.loadLists({},{cache:!1}).then(function(t){a.lists=t})},computed:{orderedLists:function orderedLists(){return this.lists?this.lists.sort(function(t,a){return t.data.position-a.data.position}):null}},methods:{onSort:function onSort(t,a){void 0===a&&(a={});var e=a.from,s=a.to,n=this;n.saving||(n.showSave=!0,n.$nextTick(function(){var t;n.lists[e].data.position=s,(t=n.lists).splice.apply(t,[s,0].concat(n.lists.splice(e,1))),n.$forceUpdate()}))},toggleListActive:function toggleListActive(t,a){this.saving||(this.showSave=!0,t.data.active=a)},save:function save(){var t=this;t.showSave=!1;var e=[];t.lists.forEach(function(t,a){t.data.position=a,e.push(i.saveList(t))}),Promise.all(e).then(function(){t.$events.$emit("wallet_accounts:reloadLists"),t.$f7router.back()})}}}},{path:"/wallet_accounts/list-add/",component:{render:function(){var a=this,t=a.$createElement,e=a._self._c||t;return e("f7-page",{staticClass:"wallet_accounts__page",attrs:{name:"wallet_accounts__list-add",id:"wallet_accounts__list-add"}},[e("f7-navbar",[e("tommy-nav-back"),a._v(" "),e("f7-nav-title",[a._v(a._s(a.$t("wallet_accounts.list-add.title","Add List")))]),a._v(" "),e("f7-nav-right",[a.showSave?e("f7-link",{attrs:{"icon-f7":"check"},on:{click:a.save}}):a._e()],1)],1),a._v(" "),e("f7-list",{staticClass:"top-0 list-custom"},[e("f7-list-item",[e("f7-input",{attrs:{type:"text",placeholder:a.$t("label.name"),value:a.name},on:{input:function(t){a.name=t.target.value}}})],1)],1)],1)},staticRenderFns:[],data:function data(){return{saving:!1,name:""}},computed:{showSave:function showSave(){return this.name.trim().length}},methods:{save:function save(){var t=this;t.saving||(t.saving=!0,i.saveList({name:t.name}).then(function(){t.$events.$emit("wallet_accounts:reloadLists"),t.$f7router.back("/wallet_accounts/"+(i.actorId?"?actor_id="+i.actorId:""),{force:!0})}))}}}},{path:"/wallet_accounts/wallet-balance/",component:{render:function(){var a=this,t=a.$createElement,e=a._self._c||t;return e("f7-page",{staticClass:"wallet_accounts__page",attrs:{name:"wallet_accounts__wallet-balance",id:"wallet_accounts__wallet-balance"}},[e("f7-navbar",[e("tommy-nav-back"),a._v(" "),e("f7-nav-title",[a._v(a._s(a.$t("wallet_accounts.wallet-balance.title","Wallet Balance")))]),a._v(" "),e("f7-nav-right",[a.showSave?e("f7-link",{attrs:{"icon-f7":"check"},on:{click:a.save}}):a._e()],1)],1),a._v(" "),null!==a.balance&&a.hasActorCard?e("f7-list",{staticClass:"list-custom"},[e("f7-list-item",{attrs:{divider:"",title:a.$t("wallet_accounts.wallet-balance.balance","Balance")}}),a._v(" "),e("f7-list-input",{attrs:{type:"number",min:"0",value:a.balance,placeholder:a.$t("wallet_accounts.wallet-balance.balance","Balance")},on:{input:function(t){a.balance=parseFloat(t.target.value)}}}),a._v(" "),e("f7-list-item",{attrs:{divider:"",title:a.$t("wallet_accounts.wallet-balance.credit_limit","Credit Limit")}}),a._v(" "),e("f7-list-input",{attrs:{type:"number",min:"0",value:a.credit_limit,placeholder:a.$t("wallet_accounts.wallet-balance.credit_limit","Credit Limit")},on:{input:function(t){a.credit_limit=parseFloat(t.target.value)}}})],1):a._e(),a._v(" "),!1===a.hasActorCard?e("f7-block",{staticClass:"text-align-center",attrs:{strong:""}},[a._v(" "+a._s(a.$t("wallet_accounts.wallet-balance.no_wallet_card"))+" ")]):a._e()],1)},staticRenderFns:[],data:function data(){return{saving:!1,balance:null,credit_limit:null,hasActorCard:null,cardId:null}},computed:{showSave:function showSave(){return null!==this.balance&&0<=this.balance&&null!==this.credit_limit&&0<=this.credit_limit}},mounted:function mounted(){var a=this;i.getActorCard().then(function(t){t?(a.hasActorCard=!0,a.balance=t.balance,a.credit_limit=t.credit_limit,a.cardId=t.id):a.hasActorCard=!1})},methods:{save:function save(){var t=this;if(!t.saving){t.saving=!0;var a=t.balance,e=t.credit_limit,s=t.cardId;i.saveBalance(s,a,e).then(function(){t.$f7router.back("/wallet_accounts/"+(i.actorId?"?actor_id="+i.actorId:""),{force:!0})})}}}}},{path:"/wallet_accounts/tag-select/",component:{render:function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("f7-page",{staticClass:"wallet_accounts__page"},[s("f7-navbar",[s("tommy-nav-back"),e._v(" "),s("f7-nav-title",[e._v(e._s(e.pageTitle))]),e._v(" "),s("f7-subnavbar",{attrs:{inner:!1}},[s("f7-searchbar",{attrs:{"search-container":"#list-edit-tag-select","search-in":".item-title"}})],1)],1),e._v(" "),s("f7-list",{staticClass:"no-margin no-hairlines wallet_accounts-tag-select-tags-list",attrs:{id:"list-edit-tag-select"}},e._l(e.teamTags,function(a,t){return s("f7-list-item",{key:t,attrs:{checkbox:"",checked:e.isTagSelected(a),title:a.name},on:{change:function(t){e.toggleTag(a,t.target.checked)}}},["members"===a.context?s("span",{staticClass:"tag-select-list-avatar",style:"background-image: url("+(a.icon||"")+")",attrs:{slot:"media"},slot:"media"}):s("span",{staticClass:"tag-select-list-icon",attrs:{slot:"media"},slot:"media"},[s("img",{attrs:{src:e.contextIconSrc(a),srcset:e.contextIconSrcset(a)}})])])}))],1)},staticRenderFns:[],props:{listId:[String,Number],pageTitle:String,filters:Array,teamTags:Array,onChange:Function},methods:{isTagSelected:function isTagSelected(a){return 0<this.filters.filter(function(t){return t.name===a.name&&t.id===a.id&&t.type===a.type}).length},contextIconSrc:function contextIconSrc(t){return this.$addonAssetsUrl+"icons/"+t.context.slice(0,-1)+".png"},contextIconSrcset:function contextIconSrcset(t){var a=this.$addonAssetsUrl;return a+"icons/"+t.context.slice(0,-1)+"@2x.png 2x,"+a+"icons/"+t.context.slice(0,-1)+"@3x.png 3x"},toggleTag:function toggleTag(t,a){this.onChange&&this.onChange(t,a)}}}},{path:"/wallet_accounts/list-edit/:listId/",component:{render:function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("f7-page",{staticClass:"wallet_accounts__page",attrs:{name:"wallet_accounts__list-edit",id:"wallet_accounts__list-edit"}},[s("f7-navbar",[s("tommy-nav-back"),e._v(" "),s("f7-nav-title",[e._v(e._s(e.$t("wallet_accounts.list-edit.title","Edit List")))]),e._v(" "),s("f7-nav-right",[e.showSave?s("f7-link",{attrs:{"icon-f7":"check"},on:{click:e.save}}):e._e()],1)],1),e._v(" "),e.list?s("f7-list",{staticClass:"list-custom"},[s("f7-list-item",[s("f7-label",[e._v(e._s(e.$t("wallet_accounts.list-edit.name","Name")))]),e._v(" "),s("f7-input",{attrs:{type:"text",value:e.list.name},on:{input:function(t){e.onNameChange(t.target.value)}}})],1),e._v(" "),s("f7-list-item",{attrs:{"smart-select":"",title:e.$t("wallet_accounts.list-edit.filter-status","Filter Status")}},[s("select",{attrs:{name:"statuses",multiple:"multiple"},on:{change:e.onStatusChange}},e._l(e.statuses,function(t,a){return s("option",{key:a,domProps:{value:t,selected:0<=e.list.data.statuses.indexOf(t)}},[e._v(e._s(e.$t("wallet_accounts.transaction_status."+t.toLowerCase().replace(/ /g,"_"))))])}))]),e._v(" "),s("f7-list-item",{attrs:{link:"#",title:e.$t("wallet_accounts.list-edit.filter-amount","Transaction Amount"),after:e.formatAmountRange(e.list.data.amount_min,e.list.data.amount_max)},on:{click:e.showAmountSelect}}),e._v(" "),s("f7-list-item",{attrs:{link:"#",title:e.$t("wallet_accounts.common.date_range","Date Range"),after:e.formatDateRange(e.list.data.date_range)},on:{click:e.showDateRange}}),e._v(" "),e._l(e.permissions,function(a,t){return s("tag-select",{key:t,attrs:{listId:e.list.id,data:a},on:{tagAdd:function(t){return e.addListPermission(a,t)},tagRemove:function(t){return e.removeListPermission(a,t)}}})}),e._v(" "),s("tag-select",{attrs:{listId:e.list.id,data:{title:e.$t("wallet_accounts.permissions.filter_transactions.title"),name:"filter_transactions",filters:e.list.filters}},on:{tagAdd:e.addListFilter,tagRemove:e.removeListFilter}})],2):e._e(),e._v(" "),e.list&&!e.list.data.default?s("f7-list",{staticClass:"margin-top"},[s("f7-list-button",{staticClass:"color-custom",attrs:{color:"custom"},on:{click:e.deleteList}},[e._v(e._s(e.$t("wallet_accounts.list-edit.delete-list","Delete List")))])],1):e._e()],1)},staticRenderFns:[],components:{tagSelect:t},props:{listId:[String,Number]},data:function data(){return{showSave:!1,id:parseInt(this.listId,10),list:null,permissions:[],statuses:["failed","paid"]}},beforeDestroy:function beforeDestroy(){this.$events.$off("wallet_accounts:setListDateRange",this.updateListDateRange),this.$events.$off("wallet_accounts:setListAmount",this.updateListAmount)},mounted:function mounted(){var e=this;i.loadList(e.id).then(function(a){a.data||(a.data={}),a.data.statuses||(a.data.statuses=[]),e.list=a,e.$api.getInstalledAddonPermission("wallet_accounts","wallet_accounts_transaction_list_read_access",{resource_id:a.id,with_filters:!0}).then(function(t){t.resource_id=a.id,e.permissions.push(t)}),e.$api.getInstalledAddonPermission("wallet_accounts","wallet_accounts_transaction_list_edit_access",{resource_id:a.id,with_filters:!0}).then(function(t){t.resource_id=a.id,e.permissions.push(t)})}),e.$events.$on("wallet_accounts:setListDateRange",e.updateListDateRange),e.$events.$on("wallet_accounts:setListAmount",e.updateListAmount)},methods:{formatDateRange:function formatDateRange(t){return t?"string"==typeof t?window.tommy.i18n.t("tasks.date_range."+t):Array.isArray(t)?formatDate(t[0])+" - "+formatDate(t[1]):t||"":""},formatAmountRange:function formatAmountRange(t,a){return t=parseFloat(t),a=parseFloat(a),Number.isNaN(t)&&(t=0),Number.isNaN(a)&&(a=0),t||a?t&&!a?"&ge; "+t:a&&!t?"&le; "+a:t&&a&&t===a?t:a&&t?t+" - "+a:"":""},updateListDateRange:function updateListDateRange(t,a){this.list.id===t&&(this.list.data.date_range=a)},updateListAmount:function updateListAmount(t,a,e){this.list.id===t&&(this.list.data.amount_min=a,this.list.data.amount_max=e,this.$forceUpdate())},onNameChange:function onNameChange(t){this.saving||(this.list.name=t,this.showSave=!0)},onStatusChange:function onStatusChange(t){this.saving||(this.list.data.statuses=this.$$(t.target).val(),this.showSave=!0)},showDateRange:function showDateRange(){this.$f7router.navigate("/wallet_accounts/list-edit/"+this.list.id+"/date-range/",{props:{list:this.list}})},showAmountSelect:function showAmountSelect(){this.$f7router.navigate("/wallet_accounts/list-edit/"+this.list.id+"/amount-select/",{props:{list:this.list}})},save:function save(){var t=this;t.saving||(t.saving=!0,t.showSave=!1,i.saveList(t.list).then(function(){t.$events.$emit("wallet_accounts:reloadLists"),t.$f7router.back()}))},deleteList:function deleteList(){var t=this;t.saving||(t.saving=!0,t.showSave=!1,i.deleteList(t.list.id).then(function(){t.$events.$emit("wallet_accounts:reloadLists"),t.$f7router.back()}))},addListFilter:function addListFilter(t){this.saving||(this.showSave=!0,this.list.filters.push(t))},removeListFilter:function removeListFilter(t){this.saving||(this.showSave=!0,this.list.filters.splice(this.list.filters.indexOf(t),1))},saveListPermission:function saveListPermission(t){this.$api.updateInstalledAddonPermission("wallet_accounts",t.name,{resource_id:t.resource_id,with_filters:!0,filters:JSON.stringify(t.filters)})},addListPermission:function addListPermission(t,a){t.filters.push(a),this.saveListPermission(t)},removeListPermission:function removeListPermission(t,a){t.filters.splice(t.filters.indexOf(a),1),this.saveListPermission(t)}}}},{path:"/wallet_accounts/list-edit/:listId/date-range/",component:{render:function(){var a=this,t=a.$createElement,e=a._self._c||t;return e("f7-page",{staticClass:"wallet_accounts__page",attrs:{name:"wallet_accounts__date-range-select",id:"wallet_accounts__date-range-select"}},[e("f7-navbar",[e("tommy-nav-back"),a._v(" "),e("f7-nav-title",[a._v(a._s(a.$t("wallet_accounts.common.date_range","Date Range")))]),a._v(" "),e("f7-nav-right",[a.showSave?e("f7-link",{attrs:{"icon-f7":"check"},on:{click:a.save}}):a._e()],1)],1),a._v(" "),e("f7-list",[e("f7-list-item",{attrs:{radio:"",value:"",checked:!(a.isCustomRange||""!==a.range&&a.range),title:a.$t("wallet_accounts.date_range.none","None")},on:{change:function(t){a.setPlainRange("")}}}),a._v(" "),e("f7-list-item",{attrs:{radio:"",value:"today",checked:!a.isCustomRange&&"today"===a.range,title:a.$t("wallet_accounts.date_range.today","Today")},on:{change:function(t){a.setPlainRange("today")}}}),a._v(" "),e("f7-list-item",{attrs:{radio:"",value:"week",checked:!a.isCustomRange&&"week"===a.range,title:a.$t("wallet_accounts.date_range.week","This Week")},on:{change:function(t){a.setPlainRange("week")}}}),a._v(" "),e("f7-list-item",{attrs:{radio:"",value:"month",checked:!a.isCustomRange&&"month"===a.range,title:a.$t("wallet_accounts.date_range.month","This Month")},on:{change:function(t){a.setPlainRange("month")}}})],1),a._v(" "),e("f7-list",{staticClass:"top-10 list-custom"},[e("f7-list-item",{attrs:{title:a.$t("wallet_accounts.common.choose_range","Choose Range")}},[e("f7-toggle",{attrs:{slot:"after",checked:a.isCustomRange},on:{change:function(t){a.toggleCustomRange(t.target.checked)}},slot:"after"})],1),a._v(" "),e("f7-list-item",{directives:[{name:"show",rawName:"v-show",value:a.isCustomRange,expression:"isCustomRange"}]},[e("f7-label",[a._v(a._s(a.$t("wallet_accounts.common.start_date","Start Date")))]),a._v(" "),e("f7-input",{ref:"rangeStart",attrs:{type:"text"}})],1),a._v(" "),e("f7-list-item",{directives:[{name:"show",rawName:"v-show",value:a.isCustomRange,expression:"isCustomRange"}]},[e("f7-label",[a._v(a._s(a.$t("wallet_accounts.common.end_date","End Date")))]),a._v(" "),e("f7-input",{ref:"rangeEnd",attrs:{type:"text"}})],1)],1)],1)},staticRenderFns:[],props:{list:Object},data:function data(){var t=this.list.data.date_range;return{showSave:!1,dateFrom:Array.isArray(t)&&t[0]?t:(new Date).getTime(),dateTo:Array.isArray(t)&&t[1]?t:(new Date).getTime(),range:t}},computed:{isCustomRange:function isCustomRange(){var t=this.range;return Array.isArray(t)||!(!t||"string"==typeof t)}},mounted:function mounted(){var e=this,s=!1,n=!1;e.calendarFrom=e.$f7.calendar.create({inputEl:e.$$(e.$refs.rangeStart.$el).find("input"),closeOnSelect:!0,value:[e.dateFrom],on:{change:function change(t,a){s&&(e.showSave=!0),s=!0,e.dateFrom=new Date(a[0]).getTime(),Array.isArray(e.range)&&e.range[0]&&(e.range[0]=e.dateFrom),e.dateFrom>e.dateTo&&e.calendarTo.setValue([e.dateFrom])}}}),e.calendarTo=e.$f7.calendar.create({inputEl:e.$$(e.$refs.rangeEnd.$el).find("input"),closeOnSelect:!0,value:[e.dateTo],on:{change:function change(t,a){n&&(e.showSave=!0),n=!0,e.dateTo=new Date(a[0]).getTime(),Array.isArray(e.range)&&e.range[1]&&(e.range[1]=e.dateTo),e.dateTo<e.dateFrom&&e.calendarFrom.setValue([e.dateTo])}}})},methods:{setPlainRange:function setPlainRange(t){this.range=t,this.showSave=!0},toggleCustomRange:function toggleCustomRange(t){var a=this;a.showSave=!0,a.range=t?[a.dateFrom,a.dateTo]:""},save:function save(){var t=this;if(!t.saving){t.saving=!0,t.showSave=!1;var a=Object.assign({},t.list);a.data.date_range=t.range,i.saveList(a).then(function(){t.$events.$emit("wallet_accounts:setListDateRange",t.list.id,t.range),t.$f7router.back()})}}}}},{path:"/wallet_accounts/list-edit/:listId/amount-select/",component:{render:function(){var a=this,t=a.$createElement,e=a._self._c||t;return e("f7-page",{staticClass:"wallet_accounts__page",attrs:{name:"wallet_accounts__amount-select",id:"wallet_accounts__amount-select"}},[e("f7-navbar",[e("tommy-nav-back"),a._v(" "),e("f7-nav-title",[a._v(a._s(a.$t("wallet_accounts.list-edit.filter-amount","Transaction Amount")))]),a._v(" "),e("f7-nav-right",[a.showSave?e("f7-link",{attrs:{"icon-f7":"check"},on:{click:a.save}}):a._e()],1)],1),a._v(" "),e("f7-list",{staticClass:"list-custom"},[e("f7-list-item",{attrs:{title:a.$t("wallet_accounts.common.choose_range","Choose Range")}},[e("f7-toggle",{attrs:{slot:"after",checked:a.isCustomRange},on:{change:function(t){a.toggleCustomRange(t.target.checked)}},slot:"after"})],1),a._v(" "),a.isCustomRange?e("f7-list-input",{attrs:{label:a.$t("wallet_accounts.common.amount_min","From"),type:"number",value:a.amount_min},on:{input:function(t){a.setMin(t.target.value)}}}):a._e(),a._v(" "),a.isCustomRange?e("f7-list-input",{attrs:{label:a.$t("wallet_accounts.common.amount_max","To"),type:"number",value:a.amount_max},on:{input:function(t){a.setMax(t.target.value)}}}):a._e()],1)],1)},staticRenderFns:[],props:{list:Object},data:function data(){var t=this.list.data,a=t.amount_min,e=t.amount_max;return{showSave:!1,amount_min:a,amount_max:e,isCustomRange:void 0!==a||void 0!==e}},methods:{save:function save(){var t=this;if(!t.saving){t.saving=!0,t.showSave=!1;var a=Object.assign({},t.list),e=t.amount_min,s=t.amount_max;t.isCustomRange?(a.data.amount_min=e,a.data.amount_max=s,a.data.amount_min||delete a.data.amount_min,a.data.amount_max||delete a.data.amount_max,a.data.amount_min&&a.data.amount_max&&a.data.amount_max<a.data.amount_min&&(a.data.amount_max=a.data.amount_min)):(delete a.data.amount_min,delete a.data.amount_max),i.saveList(a).then(function(){t.$events.$emit("wallet_accounts:setListAmount",t.list.id,a.data.amount_min,a.data.amount_max),t.$f7router.back()})}},setMin:function setMin(t){this.amount_min=t,this.showSave=!0},setMax:function setMax(t){this.amount_max=t,this.showSave=!0},toggleCustomRange:function toggleCustomRange(t){var a=this;a.showSave=!0,a.amount_max=t?(a.isCustomRange=!0,a.amount_min=a.list.data.amount_min,a.list.data.amount_max):(a.isCustomRange=!1,void(a.amount_min=void 0))}}}},{path:"/wallet_accounts/transaction-details/:id/",component:{render:function(){var t=this,a=t.$createElement,e=t._self._c||a;return e("f7-page",{attrs:{name:"wallet_accounts__transaction_details",id:"wallet_accounts__transaction_details"}},[e("f7-navbar",[e("tommy-nav-back"),t._v(" "),e("f7-nav-title",[t._v(t._s(t.$t("wallet_accounts.transaction_details.title","Transaction Details")))])],1),t._v(" "),t.transaction?[e("div",{staticClass:"wallet_accounts-transaction-header"},[e("div",{staticClass:"wallet_accounts-transaction-header-wrap"},[e("div",{staticClass:"wallet_accounts-transaction-icon"},[t.transaction.icon_url?e("img",{attrs:{src:t.transaction.icon_url}}):e("i",{staticClass:"wallet_accounts-transaction-icon-placeholder"})]),t._v(" "),e("div",{staticClass:"wallet_accounts-transaction-payment-info"},[e("div",{staticClass:"wallet_accounts-transaction-payment-name"},[t._v(t._s(t.transaction.payee_name))]),t._v(" "),e("div",{staticClass:"wallet_accounts-transaction-payment-amount"},[t._v(t._s(t.formatTransactionAmount(t.transaction)))])])]),t._v(" "),e("div",{staticClass:"wallet_accounts-transaction-status"},[t._v(t._s(t.formatTransactionStatus(t.transaction.status)))])]),t._v(" "),e("f7-list",{staticClass:"wallet_accounts-transaction-details-list",attrs:{"no-hairlines":""}},[t.transaction.card_name?e("f7-list-item",{attrs:{title:t.$t("wallet_accounts.transaction_details.payment_label","Payment"),after:t.transaction.card_name}}):t._e(),t._v(" "),e("f7-list-item",{attrs:{title:t.$t("wallet_accounts.transaction_details.time_label","Time"),after:t.formatTransactionDate(t.transaction.paid_at)}}),t._v(" "),e("f7-list-item",{attrs:{title:t.$t("wallet_accounts.transaction_details.payee_label","Payee"),after:t.transaction.payee_name}})],1)]:t._e()],2)},staticRenderFns:[],props:{id:[String,Number]},data:function data(){return{transaction:null}},mounted:function mounted(){var a=this;i.loadTransaction(a.id).then(function(t){a.transaction=t})},methods:{formatTransactionAmount:formatTransactionAmount,formatTransactionStatus:function formatTransactionStatus(t){return t[0].toUpperCase()+t.substr(1)},formatTransactionDate:formatTransactionDate}}}]}();