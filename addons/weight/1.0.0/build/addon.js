var addon=function(){var o=window.tommy.api,i=function getRecords(t,e){void 0===e&&(e={});var a,i=e.page,n=e.limit,s=e.dateFrom,r=e.dateTo;return s&&r&&(a=[new Date(s).toJSON(),new Date(r).toJSON()]),o.getFragments({addon:"weight",kind:"WeightRecord",with_filters:!0,with_permission_to:!0,user_id:t.id,page:i||1,limit:n||50,date_range:a},{cache:!1})},n=function addRecord(t){var e=t.value,a=t.date,i=t.time,n=t.user,s=t.unit,r=new Date(a);r.setHours(parseInt(i.split(":")[0],10),parseInt(i.split(":")[1],10));var d={addon:"weight",kind:"WeightRecord",with_filters:!0,start_at:r.toJSON(),tags:[{context:"members",name:n.first_name+" "+n.last_name,user_id:n.id}],filters:[{context:"members",name:n.first_name+" "+n.last_name,user_id:n.id}],data:JSON.stringify({value:e,date:a,time:i,unit:s})};return o.createFragment(d)},t=function getSettings(){return o.call({endpoint:"addons/weight/install/settings/addonSettings",method:"GET",cache:!1}).then(function(t){return t?t.data?t.data:null:t})},e=function saveSettings(t){return void 0===t&&(t={}),o.call({endpoint:"addons/weight/install/settings/addonSettings",method:"PUT",data:{data:JSON.stringify(t)}})},a={receiveMessage:!1};return[{path:"/weight/",component:{render:function(){var a=this,t=a.$createElement,i=a._self._c||t;return i("f7-page",{attrs:{id:"weight__index"},on:{"page:beforein":a.onPageBeforeIn,"page:beforeout":a.onPageBeforeOut},nativeOn:{"!scroll":function(t){return a.onPageScroll(t)}}},[i("f7-navbar",[i("tommy-nav-menu"),a._v(" "),i("f7-nav-title",[a._v(a._s(a.t("title","Weight")))]),a._v(" "),i("f7-nav-right",[i("f7-link",{attrs:{href:"/weight/settings/","icon-only":""}},[i("i",{staticClass:"icon weight-icon-settings"})]),a._v(" "),i("f7-link",{attrs:{href:"/weight/history/","icon-only":""}},[i("i",{staticClass:"icon weight-icon-chart"})])],1)],1),a._v(" "),i("f7-fab",{staticClass:"weight-fab",attrs:{href:"/weight/add/"}},[i("f7-icon",{attrs:{f7:"add"}})],1),a._v(" "),i("div",{staticClass:"weight-index-header"},[i("div",{staticClass:"weight-index-header-icon"}),a._v(" "),a.data&&a.data.length?i("div",{staticClass:"weight-index-header-content"},[i("div",{staticClass:"weight-index-header-data"},[a._v(a._s(a.data[0].data.value)),i("span",[a._v(a._s(a.$t("weight.index.vital_unit."+(a.data[0].data.unit||0))))])]),a._v(" "),i("div",{staticClass:"weight-index-header-date"},[a._v(a._s(a.$moment(a.data[0].data.date).format("DD MMM YYYY"))+" "+a._s(a.data[0].data.time))])]):a._e(),a._v(" "),a.data&&!a.data.length?i("div",{staticClass:"weight-index-header-content"},[i("div",{staticClass:"weight-index-header-data"},[a._v(a._s(a.$t("weight.index.vital_label")))])]):a._e()]),a._v(" "),a.data&&!a.data.length?i("div",{staticClass:"weight-index-no-data"},[i("i",{staticClass:"weight-index-no-data-img"}),a._v(" "),i("span",[a._v(a._s(a.t("not_available")))])]):a._e(),a._v(" "),a.data&&a.data.length?i("div",{staticClass:"weight-index-cards"},a._l(a.data,function(t,e){return i("div",{key:e,staticClass:"weight-vitals-card"},[i("div",{staticClass:"weight-vitals-card-title"},[a._v(a._s(a.$moment(t.data.date).format("DD MMM YYYY"))+" "+a._s(t.data.time))]),a._v(" "),i("div",{staticClass:"weight-vitals-card-content"},[i("div",{staticClass:"weight-vitals-card-icon"},[i("img",{attrs:{src:a.$addonAssetsUrl+"card-icon.svg"}})]),a._v(" "),i("div",{staticClass:"weight-vitals-card-value"},[a._v(a._s(t.data.value)+" "),i("sub",[a._v(a._s(a.$t("weight.index.vital_unit."+(t.data.unit||0))))])])])])})):a._e()],1)},staticRenderFns:[],data:function data(){return{data:null}},mounted:function mounted(){var t=this;t.getData(),t.$events.$on("weight:updateRecords",t.getData)},beforeDestroy:function beforeDestroy(){this.$events.$off("weight:updateRecords",this.getData)},methods:{t:function t(e,a){return this.$t("weight.index."+e,a)},getData:function getData(){var e=this;i(e.$root.user).then(function(t){e.data=t.filter(function(t){return t.data&&t.data.value}).sort(function(t,e){var a=new Date(t.data.date),i=t.data.time.split(":"),n=i[0],s=i[1];a.setHours(parseInt(n,10),parseInt(s,10));var r=new Date(e.data.date),d=e.data.time.split(":"),o=d[0],l=d[1];return r.setHours(parseInt(o,10),parseInt(l,10)),r-a})})},onPageScroll:function onPageScroll(t){var e=this,a=e.$$(t.target).closest(".page-content");a.length&&(100<a[0].scrollTop?e.$f7router.view.$navbarEl.removeClass("weight-index-navbar"):e.$f7router.view.$navbarEl.addClass("weight-index-navbar"))},onPageBeforeIn:function onPageBeforeIn(t,e){this.$f7router.view.$navbarEl.addClass("weight-index-navbar"),e.from},onPageBeforeOut:function onPageBeforeOut(){this.$f7router.view.$navbarEl.removeClass("weight-index-navbar")}}}},{path:"/weight/add/",component:{render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("f7-page",{staticClass:"weight-manual-add-page",attrs:{id:"weight__add"}},[a("f7-navbar",[a("tommy-nav-back"),e._v(" "),a("f7-nav-title",[e._v(e._s(e.$t("weight.manual_enter.title")))]),e._v(" "),a("f7-nav-right",[e.allowSave?a("f7-link",{attrs:{href:"#","icon-only":""},on:{click:e.save}},[a("i",{staticClass:"icon f7-icons"},[e._v("check")])]):e._e()],1)],1),e._v(" "),a("f7-list",[a("f7-list-input",{attrs:{type:"number","inline-label":"",value:e.value,min:"1",label:e.$t("weight.manual_enter.vital_label")},on:{input:function(t){e.value=t.target.value}}},[a("span",{staticClass:"weight-input-unit",attrs:{slot:"inner"},slot:"inner"},[e._v(e._s(e.$t("weight.manual_enter.vital_unit.0")))])]),e._v(" "),a("f7-list-input",{attrs:{type:"text","inline-label":"","input-id":"date-input",label:e.$t("weight.manual_enter.date_label")}}),e._v(" "),a("f7-list-input",{attrs:{type:"text","inline-label":"","input-id":"time-input",label:e.$t("weight.manual_enter.time_label")}})],1)],1)},staticRenderFns:[],data:function data(){return{value:"",date:"",time:""}},computed:{allowSave:function allowSave(){return this.value&&0<this.value}},mounted:function mounted(){var a=this;a.$f7.calendar.create({inputEl:a.$el.querySelector("#date-input"),value:[new Date],on:{change:function change(t,e){a.date=new Date(e[0]),a.date.setHours(0,0,0,0)}}});var t=(new Date).getHours();t<10&&(t="0"+t);var e=(new Date).getMinutes();e<10&&(e="0"+e),a.$f7.picker.create({inputEl:a.$el.querySelector("#time-input"),value:[t.toString(),e.toString()],formatValue:function formatValue(t){return t[0]+":"+t[1]},cols:[{values:function(){for(var t=[],e=0;e<24;e+=1)e<10?t.push("0"+e):t.push(e.toString());return t}()},{values:function(){for(var t=[],e=0;e<60;e+=1)e<10?t.push("0"+e):t.push(e.toString());return t}()}],on:{change:function change(t,e){a.time=e.join(":")}}})},methods:{save:function save(){var t=this,e=t.value,a=t.date,i=t.time;n({value:e,date:new Date(a).toJSON(),time:i,user:t.$root.user,unit:0}).then(function(){t.$events.$emit("weight:updateRecords"),t.$f7router.back()})}}}},{path:"/weight/settings/",component:{render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("f7-page",{staticClass:"weight-settings-page",attrs:{id:"weight__settings"}},[a("f7-navbar",[a("tommy-nav-back"),t._v(" "),a("f7-nav-title",[t._v(t._s(t.$t("weight.settings.title")))])],1),t._v(" "),a("div",{staticClass:"weight-settings-header"},[a("div",{staticClass:"weight-settings-icon"}),t._v(" "),a("div",{staticClass:"weight-settings-center-icon"})]),t._v(" "),a("div",{staticClass:"weight-settings-text"},[a("p",[t._v(t._s(t.$t("weight.settings.vital_text")))])]),t._v(" "),a("f7-list",{staticClass:"no-hairlines"},[a("f7-list-item",{attrs:{title:t.$t("weight.settings.chat_label")}},[a("f7-toggle",{attrs:{slot:"after",checked:t.settings.receiveMessage},on:{"toggle:change":t.onMessagesChanges},slot:"after"})],1)],1)],1)},staticRenderFns:[],data:function data(){return{settings:a}},mounted:function mounted(){var e=this;t().then(function(t){t&&(e.settings=t,a=e.settings)})},methods:{onMessagesChanges:function onMessagesChanges(t){this.settings.receiveMessage=t,a=this.settings,e(this.settings)}}}},{path:"/weight/history/",component:{render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("f7-page",{staticClass:"weight-history-page",attrs:{id:"weight__history"}},[a("f7-navbar",[a("tommy-nav-back"),e._v(" "),a("f7-nav-title",[e._v(e._s(e.$t("weight.history.title")))])],1),e._v(" "),a("f7-block",[a("f7-segmented",[a("f7-button",{attrs:{active:"day"===e.range},on:{click:function(t){e.range="day"}}},[e._v(e._s(e.$t("weight.history.date_options.0")))]),e._v(" "),a("f7-button",{attrs:{active:"week"===e.range},on:{click:function(t){e.range="week"}}},[e._v(e._s(e.$t("weight.history.date_options.1")))]),e._v(" "),a("f7-button",{attrs:{active:"month"===e.range},on:{click:function(t){e.range="month"}}},[e._v(e._s(e.$t("weight.history.date_options.2")))])],1)],1),e._v(" "),a("div",{staticClass:"weight-chart-clicked"},[a("span",[e._v(e._s(e.clickedDate))]),e._v(" "),a("span",[e._v(e._s(e.clickedValue))])]),e._v(" "),e.data&&e.data.length?["day"===e.range?a("div",{key:"weight-chart-day",staticClass:"weight-chart"},[a("div",{ref:"weightChartDay"})]):e._e(),e._v(" "),"week"===e.range?a("div",{key:"weight-chart-week",staticClass:"weight-chart"},[a("div",{ref:"weightChartWeek"})]):e._e(),e._v(" "),"month"===e.range?a("div",{key:"weight-chart-month",staticClass:"weight-chart"},[a("div",{ref:"weightChartMonth"})]):e._e()]:e._e()],2)},staticRenderFns:[],data:function data(){return{data:null,clicked:null,range:"day"}},mounted:function mounted(){var e=this,t=(new Date).setMonth((new Date).getMonth()-1),a=new Date;i(e.$root.user,{dateFrom:t,dateTo:a}).then(function(t){e.data=(t||[]).sort(function(t,e){var a=new Date(t.data.date),i=t.data.time.split(":"),n=i[0],s=i[1];a.setHours(parseInt(n,10),parseInt(s,10));var r=new Date(e.data.date),d=e.data.time.split(":"),o=d[0],l=d[1];return r.setHours(parseInt(o,10),parseInt(l,10)),r-a}),e.$nextTick(function(){e.initChart()})})},watch:{range:function range(){var t=this;t.clicked=null,t.$nextTick(function(){t.initChart()})}},computed:{clickedDate:function clickedDate(){return this.clicked?this.$moment(this.clicked.x).format("DD MMM YYYY HH:mm"):""},clickedValue:function clickedValue(){var t=this;if(!t.clicked)return"";var e=t.data[t.clicked.id];return t.clicked.y+" "+t.$t("weight.history.vital_unit."+e.data.unit)},todayValues:function todayValues(){if(!this.data)return null;var n=new Date;return n.setHours(0,0,0,0),this.data.filter(function(t){var e=parseInt(t.data.time.split(":")[0],10),a=parseInt(t.data.time.split(":")[1],10),i=new Date(t.data.date);return i.setHours(e,a),i.getTime()>n.getTime()})},weekValues:function weekValues(){if(!this.data)return null;var n=new Date;return n.setHours(0,0,0,0),n.setMonth(n.getMonth(),n.getDate()-7),this.data.filter(function(t){var e=parseInt(t.data.time.split(":")[0],10),a=parseInt(t.data.time.split(":")[1],10),i=new Date(t.data.date);return i.setHours(e,a),i.getTime()>n.getTime()})},monthValues:function monthValues(){if(!this.data)return null;var n=new Date;return n.setHours(0,0,0,0),n.setMonth(n.getMonth()-1,n.getDate()),this.data.filter(function(t){var e=parseInt(t.data.time.split(":")[0],10),a=parseInt(t.data.time.split(":")[1],10),i=new Date(t.data.date);return i.setHours(e,a),i.getTime()>n.getTime()})}},methods:{initChart:function initChart(){var a=this,t=a.range,e={credits:{enabled:!1},legend:{enabled:!1},title:null,tooltip:{enabled:!1},xAxis:{type:"datetime"},yAxis:{title:null}},i={color:"#5FA81A",cursor:"pointer",point:{events:{click:function click(){a.clicked=this},select:function select(){a.clicked=this}}}};"day"===t&&a.$highcharts.chart(a.$refs.weightChartDay,Object.assign({},e,{series:[Object.assign({},i,{data:a.todayValues.map(function(t){var e=new Date(t.data.date);return e.setHours(parseInt(t.data.time.split(":")[0],10),parseInt(t.data.time.split(":")[1],10)),{y:parseInt(t.data.value,10),x:e,id:a.data.indexOf(t)}})})]})),"week"===t&&a.$highcharts.chart(a.$refs.weightChartWeek,Object.assign({},e,{series:[Object.assign({},i,{data:a.weekValues.map(function(t){var e=new Date(t.data.date);return e.setHours(parseInt(t.data.time.split(":")[0],10),parseInt(t.data.time.split(":")[1],10)),{y:parseInt(t.data.value,10),x:e,id:a.data.indexOf(t)}})})]})),"month"===t&&a.$highcharts.chart(a.$refs.weightChartMonth,Object.assign({},e,{series:[Object.assign({},i,{data:a.monthValues.map(function(t){var e=new Date(t.data.date);return e.setHours(parseInt(t.data.time.split(":")[0],10),parseInt(t.data.time.split(":")[1],10)),{y:parseInt(t.data.value,10),x:e,id:a.data.indexOf(t)}})})]}))}}}}]}();