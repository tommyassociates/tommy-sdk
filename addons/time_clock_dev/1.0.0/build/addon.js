var addon=function(t){var e={};function a(n){if(e[n])return e[n].exports;var o=e[n]={i:n,l:!1,exports:{}};return t[n].call(o.exports,o,o.exports,a),o.l=!0,o.exports}return a.m=t,a.c=e,a.d=function(t,e,n){a.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:n})},a.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},a.t=function(t,e){if(1&e&&(t=a(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var n=Object.create(null);if(a.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var o in t)a.d(n,o,function(e){return t[e]}.bind(null,o));return n},a.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return a.d(e,"a",e),e},a.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},a.p="",a(a.s=3)}([function(t,e,a){"use strict";(function(t){function n(t){return(n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}
/*!
 * vuex v3.5.1
 * (c) 2020 Evan You
 * @license MIT
 */a.d(e,"a",(function(){return b}));var o=("undefined"!=typeof window?window:void 0!==t?t:{}).__VUE_DEVTOOLS_GLOBAL_HOOK__;function i(t,e){Object.keys(t).forEach((function(a){return e(t[a],a)}))}function r(t){return null!==t&&"object"===n(t)}var c=function(t,e){this.runtime=e,this._children=Object.create(null),this._rawModule=t;var a=t.state;this.state=("function"==typeof a?a():a)||{}},s={namespaced:{configurable:!0}};s.namespaced.get=function(){return!!this._rawModule.namespaced},c.prototype.addChild=function(t,e){this._children[t]=e},c.prototype.removeChild=function(t){delete this._children[t]},c.prototype.getChild=function(t){return this._children[t]},c.prototype.hasChild=function(t){return t in this._children},c.prototype.update=function(t){this._rawModule.namespaced=t.namespaced,t.actions&&(this._rawModule.actions=t.actions),t.mutations&&(this._rawModule.mutations=t.mutations),t.getters&&(this._rawModule.getters=t.getters)},c.prototype.forEachChild=function(t){i(this._children,t)},c.prototype.forEachGetter=function(t){this._rawModule.getters&&i(this._rawModule.getters,t)},c.prototype.forEachAction=function(t){this._rawModule.actions&&i(this._rawModule.actions,t)},c.prototype.forEachMutation=function(t){this._rawModule.mutations&&i(this._rawModule.mutations,t)},Object.defineProperties(c.prototype,s);var l=function(t){this.register([],t,!1)};l.prototype.get=function(t){return t.reduce((function(t,e){return t.getChild(e)}),this.root)},l.prototype.getNamespace=function(t){var e=this.root;return t.reduce((function(t,a){return t+((e=e.getChild(a)).namespaced?a+"/":"")}),"")},l.prototype.update=function(t){!function t(e,a,n){0;if(a.update(n),n.modules)for(var o in n.modules){if(!a.getChild(o))return void 0;t(e.concat(o),a.getChild(o),n.modules[o])}}([],this.root,t)},l.prototype.register=function(t,e,a){var n=this;void 0===a&&(a=!0);var o=new c(e,a);0===t.length?this.root=o:this.get(t.slice(0,-1)).addChild(t[t.length-1],o);e.modules&&i(e.modules,(function(e,o){n.register(t.concat(o),e,a)}))},l.prototype.unregister=function(t){var e=this.get(t.slice(0,-1)),a=t[t.length-1],n=e.getChild(a);n&&n.runtime&&e.removeChild(a)},l.prototype.isRegistered=function(t){var e=this.get(t.slice(0,-1)),a=t[t.length-1];return e.hasChild(a)};var d;var u=function(t){var e=this;void 0===t&&(t={}),!d&&"undefined"!=typeof window&&window.Vue&&k(window.Vue);var a=t.plugins;void 0===a&&(a=[]);var n=t.strict;void 0===n&&(n=!1),this._committing=!1,this._actions=Object.create(null),this._actionSubscribers=[],this._mutations=Object.create(null),this._wrappedGetters=Object.create(null),this._modules=new l(t),this._modulesNamespaceMap=Object.create(null),this._subscribers=[],this._watcherVM=new d,this._makeLocalGettersCache=Object.create(null);var i=this,r=this.dispatch,c=this.commit;this.dispatch=function(t,e){return r.call(i,t,e)},this.commit=function(t,e,a){return c.call(i,t,e,a)},this.strict=n;var s=this._modules.root.state;m(this,s,[],this._modules.root),_(this,s),a.forEach((function(t){return t(e)})),(void 0!==t.devtools?t.devtools:d.config.devtools)&&function(t){o&&(t._devtoolHook=o,o.emit("vuex:init",t),o.on("vuex:travel-to-state",(function(e){t.replaceState(e)})),t.subscribe((function(t,e){o.emit("vuex:mutation",t,e)}),{prepend:!0}),t.subscribeAction((function(t,e){o.emit("vuex:action",t,e)}),{prepend:!0}))}(this)},f={state:{configurable:!0}};function h(t,e,a){return e.indexOf(t)<0&&(a&&a.prepend?e.unshift(t):e.push(t)),function(){var a=e.indexOf(t);a>-1&&e.splice(a,1)}}function p(t,e){t._actions=Object.create(null),t._mutations=Object.create(null),t._wrappedGetters=Object.create(null),t._modulesNamespaceMap=Object.create(null);var a=t.state;m(t,a,[],t._modules.root,!0),_(t,a,e)}function _(t,e,a){var n=t._vm;t.getters={},t._makeLocalGettersCache=Object.create(null);var o=t._wrappedGetters,r={};i(o,(function(e,a){r[a]=function(t,e){return function(){return t(e)}}(e,t),Object.defineProperty(t.getters,a,{get:function(){return t._vm[a]},enumerable:!0})}));var c=d.config.silent;d.config.silent=!0,t._vm=new d({data:{$$state:e},computed:r}),d.config.silent=c,t.strict&&function(t){t._vm.$watch((function(){return this._data.$$state}),(function(){0}),{deep:!0,sync:!0})}(t),n&&(a&&t._withCommit((function(){n._data.$$state=null})),d.nextTick((function(){return n.$destroy()})))}function m(t,e,a,n,o){var i=!a.length,r=t._modules.getNamespace(a);if(n.namespaced&&(t._modulesNamespaceMap[r],t._modulesNamespaceMap[r]=n),!i&&!o){var c=v(e,a.slice(0,-1)),s=a[a.length-1];t._withCommit((function(){d.set(c,s,n.state)}))}var l=n.context=function(t,e,a){var n=""===e,o={dispatch:n?t.dispatch:function(a,n,o){var i=g(a,n,o),r=i.payload,c=i.options,s=i.type;return c&&c.root||(s=e+s),t.dispatch(s,r)},commit:n?t.commit:function(a,n,o){var i=g(a,n,o),r=i.payload,c=i.options,s=i.type;c&&c.root||(s=e+s),t.commit(s,r,c)}};return Object.defineProperties(o,{getters:{get:n?function(){return t.getters}:function(){return function(t,e){if(!t._makeLocalGettersCache[e]){var a={},n=e.length;Object.keys(t.getters).forEach((function(o){if(o.slice(0,n)===e){var i=o.slice(n);Object.defineProperty(a,i,{get:function(){return t.getters[o]},enumerable:!0})}})),t._makeLocalGettersCache[e]=a}return t._makeLocalGettersCache[e]}(t,e)}},state:{get:function(){return v(t.state,a)}}}),o}(t,r,a);n.forEachMutation((function(e,a){!function(t,e,a,n){(t._mutations[e]||(t._mutations[e]=[])).push((function(e){a.call(t,n.state,e)}))}(t,r+a,e,l)})),n.forEachAction((function(e,a){var n=e.root?a:r+a,o=e.handler||e;!function(t,e,a,n){(t._actions[e]||(t._actions[e]=[])).push((function(e){var o,i=a.call(t,{dispatch:n.dispatch,commit:n.commit,getters:n.getters,state:n.state,rootGetters:t.getters,rootState:t.state},e);return(o=i)&&"function"==typeof o.then||(i=Promise.resolve(i)),t._devtoolHook?i.catch((function(e){throw t._devtoolHook.emit("vuex:error",e),e})):i}))}(t,n,o,l)})),n.forEachGetter((function(e,a){!function(t,e,a,n){if(t._wrappedGetters[e])return void 0;t._wrappedGetters[e]=function(t){return a(n.state,n.getters,t.state,t.getters)}}(t,r+a,e,l)})),n.forEachChild((function(n,i){m(t,e,a.concat(i),n,o)}))}function v(t,e){return e.reduce((function(t,e){return t[e]}),t)}function g(t,e,a){return r(t)&&t.type&&(a=e,e=t,t=t.type),{type:t,payload:e,options:a}}function k(t){d&&t===d||function(t){if(Number(t.version.split(".")[0])>=2)t.mixin({beforeCreate:a});else{var e=t.prototype._init;t.prototype._init=function(t){void 0===t&&(t={}),t.init=t.init?[a].concat(t.init):a,e.call(this,t)}}function a(){var t=this.$options;t.store?this.$store="function"==typeof t.store?t.store():t.store:t.parent&&t.parent.$store&&(this.$store=t.parent.$store)}}(d=t)}f.state.get=function(){return this._vm._data.$$state},f.state.set=function(t){0},u.prototype.commit=function(t,e,a){var n=this,o=g(t,e,a),i=o.type,r=o.payload,c=(o.options,{type:i,payload:r}),s=this._mutations[i];s&&(this._withCommit((function(){s.forEach((function(t){t(r)}))})),this._subscribers.slice().forEach((function(t){return t(c,n.state)})))},u.prototype.dispatch=function(t,e){var a=this,n=g(t,e),o=n.type,i=n.payload,r={type:o,payload:i},c=this._actions[o];if(c){try{this._actionSubscribers.slice().filter((function(t){return t.before})).forEach((function(t){return t.before(r,a.state)}))}catch(t){0}var s=c.length>1?Promise.all(c.map((function(t){return t(i)}))):c[0](i);return new Promise((function(t,e){s.then((function(e){try{a._actionSubscribers.filter((function(t){return t.after})).forEach((function(t){return t.after(r,a.state)}))}catch(t){0}t(e)}),(function(t){try{a._actionSubscribers.filter((function(t){return t.error})).forEach((function(e){return e.error(r,a.state,t)}))}catch(t){0}e(t)}))}))}},u.prototype.subscribe=function(t,e){return h(t,this._subscribers,e)},u.prototype.subscribeAction=function(t,e){return h("function"==typeof t?{before:t}:t,this._actionSubscribers,e)},u.prototype.watch=function(t,e,a){var n=this;return this._watcherVM.$watch((function(){return t(n.state,n.getters)}),e,a)},u.prototype.replaceState=function(t){var e=this;this._withCommit((function(){e._vm._data.$$state=t}))},u.prototype.registerModule=function(t,e,a){void 0===a&&(a={}),"string"==typeof t&&(t=[t]),this._modules.register(t,e),m(this,this.state,t,this._modules.get(t),a.preserveState),_(this,this.state)},u.prototype.unregisterModule=function(t){var e=this;"string"==typeof t&&(t=[t]),this._modules.unregister(t),this._withCommit((function(){var a=v(e.state,t.slice(0,-1));d.delete(a,t[t.length-1])})),p(this)},u.prototype.hasModule=function(t){return"string"==typeof t&&(t=[t]),this._modules.isRegistered(t)},u.prototype.hotUpdate=function(t){this._modules.update(t),p(this,!0)},u.prototype._withCommit=function(t){var e=this._committing;this._committing=!0,t(),this._committing=e},Object.defineProperties(u.prototype,f);C((function(t,e){var a={};return y(e).forEach((function(e){var n=e.key,o=e.val;a[n]=function(){var e=this.$store.state,a=this.$store.getters;if(t){var n=w(this.$store,"mapState",t);if(!n)return;e=n.context.state,a=n.context.getters}return"function"==typeof o?o.call(this,e,a):e[o]},a[n].vuex=!0})),a})),C((function(t,e){var a={};return y(e).forEach((function(e){var n=e.key,o=e.val;a[n]=function(){for(var e=[],a=arguments.length;a--;)e[a]=arguments[a];var n=this.$store.commit;if(t){var i=w(this.$store,"mapMutations",t);if(!i)return;n=i.context.commit}return"function"==typeof o?o.apply(this,[n].concat(e)):n.apply(this.$store,[o].concat(e))}})),a}));var b=C((function(t,e){var a={};return y(e).forEach((function(e){var n=e.key,o=e.val;o=t+o,a[n]=function(){if(!t||w(this.$store,"mapGetters",t))return this.$store.getters[o]},a[n].vuex=!0})),a}));C((function(t,e){var a={};return y(e).forEach((function(e){var n=e.key,o=e.val;a[n]=function(){for(var e=[],a=arguments.length;a--;)e[a]=arguments[a];var n=this.$store.dispatch;if(t){var i=w(this.$store,"mapActions",t);if(!i)return;n=i.context.dispatch}return"function"==typeof o?o.apply(this,[n].concat(e)):n.apply(this.$store,[o].concat(e))}})),a}));function y(t){return function(t){return Array.isArray(t)||r(t)}(t)?Array.isArray(t)?t.map((function(t){return{key:t,val:t}})):Object.keys(t).map((function(e){return{key:e,val:t[e]}})):[]}function C(t){return function(e,a){return"string"!=typeof e?(a=e,e=""):"/"!==e.charAt(e.length-1)&&(e+="/"),t(e,a)}}function w(t,e,a){return t._modulesNamespaceMap[a]}}).call(this,a(1))},function(t,e){function a(t){return(a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}var n;n=function(){return this}();try{n=n||new Function("return this")()}catch(t){"object"===("undefined"==typeof window?"undefined":a(window))&&(n=window)}t.exports=n},,function(t,e,a){"use strict";a.r(e);var n={baseUrl:"/time-clock-dev/",package:"time_clock_dev"},o=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("f7-page",{staticClass:"time-clock-main-page",attrs:{"page-content":!1,ptr:""},on:{"ptr:refresh":t.onPtrRefresh}},[a("f7-navbar",[a("tommy-nav-menu"),t._v(" "),a("f7-nav-title",[t._v(t._s(t.$t(t.addonConfig.package+".index.title")))]),t._v(" "),a("f7-nav-right",{staticClass:"time-clock-navbar-links"},[a("f7-link",{attrs:{href:t.addonConfig.baseUrl+"add/","icon-only":""}},[a("f7-icon",{attrs:{f7:"plus"}})],1),t._v(" "),a("f7-link",{attrs:{href:t.addonConfig.baseUrl+"search/","icon-only":""}},[a("f7-icon",{attrs:{f7:"search"}})],1),t._v(" "),a("f7-link",{attrs:{href:t.addonConfig.baseUrl+"settings/","icon-only":""}},[a("f7-icon",{attrs:{f7:"gear"}})],1)],1)],1),t._v(" "),a("f7-toolbar",{staticClass:"time-clock-main-toolbar",style:t.toolbarStyle},[t.clock_on||t.break_on?t._e():a("f7-button",{staticClass:"time-clock-toolbar-button clock-on",attrs:{raised:"",fill:""},on:{click:t.clockOnClick}},[t._v(t._s(t.$t(t.addonConfig.package+".index.clock_on_button"))+"\n    ")]),t._v(" "),t.clock_on&&!t.break_on?a("f7-button",{staticClass:"time-clock-toolbar-button clock-off",attrs:{raised:"",fill:""},on:{click:t.clockOffClick}},[t._v(t._s(t.$t(t.addonConfig.package+".index.clock_off_button"))+" "+t._s(t.formatDuration())+"\n    ")]):t._e(),t._v(" "),t.clock_on&&!t.break_on?a("f7-button",{staticClass:"time-clock-toolbar-button break-on",attrs:{raised:"",fill:""},on:{click:t.breakOnClick}},[t._v(t._s(t.$t(t.addonConfig.package+".index.break_on_button"))+"\n    ")]):t._e(),t._v(" "),t.break_on?a("f7-button",{staticClass:"time-clock-toolbar-button break-off",attrs:{raised:"",fill:""},on:{click:t.breakOffClick}},[t._v(t._s(t.$t(t.addonConfig.package+".index.break_off_button"))+" "+t._s(t.formatDuration())+"\n    ")]):t._e()],1),t._v(" "),a("f7-page-content",{style:t.pageContentStyle},[t.viewOthers||null===t.activeData?t._e():a("div",{staticClass:"time-clock-active"},[a("Events",{attrs:{data:t.formattedActiveData,skeleton:1,loaded:t.loaded.active}})],1),t._v(" "),t.viewOthers&&null!==t.activeData?a("div",{staticClass:"time-clock-active"},[a("div",{staticClass:"time-clock-avatars-container"},[a("Active-avatar",{attrs:{data:t.formattedActiveData,loaded:t.loaded.active}})],1)]):t._e(),t._v(" "),t.loaded.attendance?a("Events",{attrs:{data:t.formattedAttendanceData,loaded:t.loaded.attendance}}):t._e(),t._v(" "),a("Geo",{ref:"geo",attrs:{dialog:!1}})],1)],1)};o._withStripped=!0;var i=window.tommy.api,r={actorId:void 0,actor:void 0,shifts_active_id:void 0,attendances_active_id:void 0,getTest:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,e=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];return i.call({endpoint:"workforce/attendances/active",method:"GET",cache:e,data:t}).then((function(t){return t}))},getShiftActive:function(){return i.call({endpoint:"workforce/shifts/active",method:"GET",cache:!1}).then((function(t){return t}))},getAttendances:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=t.cache,a=void 0!==e&&e,n=t.others,o=void 0!==n&&n,c=t.otherOptions,s=void 0===c?{}:c,l={endpoint:"workforce/attendances",method:"GET",with_permission_to:!0,with_filters:!0,cache:a};return o||(s.user_id=r.actorId),l.data=s,i.call(l).then((function(t){return t}))},getAttendancesActive:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=t.cache,a=void 0!==e&&e,n=t.others,o=void 0!==n&&n,c=t.otherOptions,s=void 0===c?{}:c,l={endpoint:"workforce/attendances/active",method:"GET",cache:a};return o||(s.user_id=r.actorId),l.data=s,i.call(l).then((function(t){return t}))},getAttendancesDetail:function(t){return i.call({endpoint:"workforce/attendances/"+t,method:"GET",cache:!1}).then((function(t){return t}))},editAttendance:function(t,e){return i.call({endpoint:"workforce/attendances/"+t,method:"PUT",cache:!1,data:e}).then((function(t){return t}))},deleteAttendance:function(t){return i.call({endpoint:"workforce/attendances/"+t,method:"DELETE",cache:!1}).then((function(t){return t}))},setAttendances:function(t){return i.call({endpoint:"workforce/attendances",method:"POST",cache:!1,data:t}).then((function(t){return t}))},getUserId:function(t){var e=t.$f7route.query.actor_id;return Number(e||t.$store.state.account.account.user_id)},getActor:function(t){return t.$f7route.query.actor_id?t.$store.state.teamMembers.teamMembers.filter((function(e){return e.user_id===parseInt(t.userId,10)}))[0]:t.$store.state.account.account},checkPermision:function(t,e){var a=this;return void 0!==t.filters.find((function(t){if("members"===t.context){if(t.user_id===a.actorId)return!0}else if("roles"===t.context&&a.actor.roles.indexOf(t.name)>0)return!0}))}};var c=r;function s(t,e,a){return e in t?Object.defineProperty(t,e,{value:a,enumerable:!0,configurable:!0,writable:!0}):t[e]=a,t}var l={test:void 0,prepareAttendances:function(t,e){return console.log("TIMECLOCK - prepareAttendances"),null===t?null:(console.log("TIMECLOCK - prepareAttendances - after data check."),t.forEach((function(t){console.log("TIMECLOCK - prepareAttendances - after data check. data - e",JSON.stringify(t));var a=e.$store.state.teamMembers.teamMembers.find((function(e){return e.user_id===t.user_id}));console.log("TIMECLOCK - prepareAttendances - after data check. data - user",JSON.stringify(a)),a?(t.user_name="".concat(a.first_name," ").concat(a.last_name),t.icon_url=t.image?t.image.url:a.icon_url):console.log("TIMECLOCK - prepareAttendances - after data check. data - user not found.")})),t)},prepareAttendance:function(t,e){if(console.log("TIMECLOCK - prepareAttendance"),null===t)return null;console.log("TIMECLOCK - prepareAttendance - after data check.");var a=e.$store.state.teamMembers.teamMembers.find((function(e){return e.user_id===t.user_id}));return t.user_name="".concat(a.first_name," ").concat(a.last_name),t.icon_url=t.image?t.image.url:a.icon_url,t},splitAttendanceIntoDays:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],e=arguments.length>1?arguments[1]:void 0,a=e.$moment(new Date).format("YYYY-MM-DD"),o=e.$moment(a).subtract(1,"day").format("YYYY-MM-DD"),i=t.reduce((function(t,i){var r=i.timestamp,c=e.$moment(r).format("YYYY-MM-DD");if(!t[c]){var s="";s=e.$moment(r).format("YYYY-MM-DD")===a?e.$t("".concat(n.package,".index.today_title")):e.$moment(r).format("YYYY-MM-DD")===o?e.$t("".concat(n.package,".index.yesterday_title")):e.$moment(r).format("ddd Do MMM, YYYY"),t[c]={title:s,attendances:[]}}return t[c].attendances.push(i),t}),{});return i},formatAttendanceActive:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],e=arguments.length>1?arguments[1]:void 0,a=e.$t("".concat(n.package,".index.active_title"));return s({},"active",{title:a,attendances:t?[t]:null})}},d=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",t._l(t.data,(function(e,n){return a("div",{key:"days_"+n,attrs:{title:n}},[a("f7-block-title",{staticClass:"time-clock-divider"},[t._v(t._s(e.title))]),t._v(" "),t.loaded?a("div",{staticClass:"time-clock-circle-avatar"},[t._l(e.attendances,(function(e,n){return a("div",{directives:[{name:"show",rawName:"v-show",value:n<=2||t.more_clicked,expression:"index <=2 || more_clicked"}],key:"avatar_"+n,staticClass:"container",on:{click:function(e){return t.goSearch(t.item.name)}}},[a("div",{staticClass:"image",style:{backgroundImage:"url("+e.icon_url+")"}}),t._v(" "),a("div",{staticClass:"name"},[t._v(t._s(e.user_name))])])})),t._v(" "),!t.more_clicked&&e.attendances.length>3?a("div",{staticClass:"container",on:{click:t.clickMore}},[a("div",{staticClass:"image more"}),t._v(" "),a("div",{staticClass:"name more"},[t._v(t._s(t.$t(t.addonConfig.package+".index.more_button")))])]):t._e(),t._v(" "),0===e.attendances.length?a("div",{staticClass:"container"},[a("div",{staticClass:"no-activity"},[t._v(t._s(t.$t(t.addonConfig.package+".index.no_activity")))])]):t._e(),t._v(" "),t.loaded?t._e():a("div",{staticClass:"time-clock-circle-avatar skeleton-text skeleton-effect-blink"},t._l(4,(function(e){return a("div",{key:"avatar_skeleton_"+e,staticClass:"container"},[a("div",{staticClass:"image skeleton-element"}),t._v(" "),a("div",{staticClass:"name"},[t._v("______")])])})),0)],2):t._e()],1)})),0)};function u(t,e,a,n,o,i,r,c){var s,l="function"==typeof t?t.options:t;if(e&&(l.render=e,l.staticRenderFns=a,l._compiled=!0),n&&(l.functional=!0),i&&(l._scopeId="data-v-"+i),r?(s=function(t){(t=t||this.$vnode&&this.$vnode.ssrContext||this.parent&&this.parent.$vnode&&this.parent.$vnode.ssrContext)||"undefined"==typeof __VUE_SSR_CONTEXT__||(t=__VUE_SSR_CONTEXT__),o&&o.call(this,t),t&&t._registeredComponents&&t._registeredComponents.add(r)},l._ssrRegister=s):o&&(s=c?function(){o.call(this,this.$root.$options.shadowRoot)}:o),s)if(l.functional){l._injectStyles=s;var d=l.render;l.render=function(t,e){return s.call(e),d(t,e)}}else{var u=l.beforeCreate;l.beforeCreate=u?[].concat(u,s):[s]}return{exports:t,options:l}}d._withStripped=!0;var f=u({name:"CircleAvatar",props:{data:{type:Object,default:{}},loaded:Boolean},methods:{clickMore:function(){this.more_clicked=!0},goSearch:function(t){this.$f7router.navigate("/time-clock/search/",{props:{start_search:t}})}},data:function(){return{addonConfig:n,more_clicked:!1}}},d,[],!1,null,null,null);f.options.__file="addons/time_clock_dev/1.0.0/src/components/circle-avatar.vue";var h=f.exports,p=function(){var t=this,e=t.$createElement,a=t._self._c||e;return t.data?a("div",[t._l(t.data,(function(e,n){return a("div",{key:"days_"+n,attrs:{title:n}},[a("f7-block-title",{staticClass:"time-clock-divider"},[t._v(t._s(e.title))]),t._v(" "),t.loaded?a("f7-list",{staticClass:"time-clock-list",attrs:{"media-list":""}},t._l(e.attendances,(function(e,n){return a("f7-list-item",{key:"event_data_"+n,attrs:{title:e.user_name,link:t.addonConfig.baseUrl+"detail/"+e.id,"no-chevron":""}},[a("div",{staticClass:"time-clock-item-image",style:{backgroundImage:"url("+e.icon_url+")"},attrs:{slot:"media"},slot:"media"}),t._v(" "),a("div",{staticClass:"description"},[t._v(t._s(e.address))]),t._v(" "),a("div",{staticClass:"time",attrs:{slot:"content-end"},slot:"content-end"},[t._v("\n          "+t._s(t.$moment(new Date(e.timestamp)).format("HH:mm"))+"\n          "),a("br"),t._v("\n          "+t._s(t.$t(t.addonConfig.package+".index.clock_event_options."+e.status))+"\n        ")])])})),1):t._e()],1)})),t._v(" "),0===t.data.length?a("div",{staticClass:"no-attendances"},[t._v(t._s(t.$t(t.addonConfig.package+".index.no_attendances")))]):t._e(),t._v(" "),t.loaded?t._e():a("f7-list",{staticClass:"time-clock-list",attrs:{"media-list":""}},[a("f7-block-title",{staticClass:"time-clock-divider"}),t._v(" "),t._l(t.skeleton,(function(e){return a("f7-list-item",{key:"event_"+e,staticClass:"skeleton-effect-blink skeleton-text",attrs:{title:"________ ________"}},[a("div",{staticClass:"time-clock-item-image",attrs:{slot:"media"},slot:"media"}),t._v(" "),a("div",{staticClass:"description"},[t._v("_________")]),t._v(" "),a("div",{staticClass:"time",attrs:{slot:"content-end"},slot:"content-end"},[t._v("\n        _______\n        "),a("br"),t._v("___________\n      ")])])}))],2)],2):t._e()};p._withStripped=!0;var _=u({nane:"Events",props:{data:{type:Object,default:{}},skeleton:{type:Number,default:4},loaded:{type:Boolean,default:!1}},data:function(){return{addonConfig:n}},mounted:function(){}},p,[],!1,null,null,null);_.options.__file="addons/time_clock_dev/1.0.0/src/components/events.vue";var m=_.exports,v=function(){var t=this.$createElement;return(this._self._c||t)("div")};v._withStripped=!0;var g=u({name:"Geo",props:{dialog:{type:Boolean,default:!0},getStret:{type:Boolean,default:!0}},methods:{takeGeo:function(){this.dialog&&(this.dialogProgress=this.$f7.dialog.progress(this.$t("".concat(n.package,".index.geo_loading")))),navigator.geolocation.getCurrentPosition(this.onSuccess,this.onError,{maximumAge:6e5,timeout:3e4,enableHighAccuracy:!0})},takeGeoAsync:function(){var t=this;return t.dialog&&(t.dialogProgress=t.$f7.dialog.progress(t.$t("".concat(n.package,".index.geo_loading")))),new Promise((function(e,a){navigator.geolocation.getCurrentPosition((function(n){t.onSuccess(n,e,a)}),t.onError,{maximumAge:6e5,timeout:5e3,enableHighAccuracy:!0})}))},onSuccess:function(t,e,a){this.dialog&&this.dialogProgress.close(),this.getStret?(t.coords.name="",this.getStreetName(t.coords,e,a)):(this.$emit("geo:taken",t.coords),"function"==typeof e&&e(t.coords))},onError:function(t,e,a){this.dialog&&this.dialogProgress.close(),this.$emit("geo:error",t),this.$app.notify(t.message),console.debug("Take geocordinates error: "+t.message),"function"==typeof a&&a(t.message)},getStreetName:function(t,e,a){var n=this;n.$f7.request({url:"https://nominatim.openstreetmap.org/reverse",dataType:"json",cache:!1,data:{lat:t.latitude,lon:t.longitude,format:"json","accept-language":n.$tommy.config.locale},success:function(a){var o=[];a.address.city&&o.push(a.address.city),a.address.village&&o.push(a.address.village),a.address.road&&o.push(a.address.road),a.address.house_number&&o.push(a.address.house_number),o=o.length>0?o.join(", "):"",t.name=o,n.$emit("geo:taken",t),"function"==typeof e&&e(t)},error:function(e){t.name="",n.$emit("geo:error",e),"function"==typeof a&&a(e)}})}},data:function(){return{addonConfig:n,isCordova:this.$f7.device.cordova}}},v,[],!1,null,null,null);g.options.__file="addons/time_clock_dev/1.0.0/src/components/geo.vue";var k=g.exports,b=u({methods:{dataURLToBlob:function(t){console.log("dataURLToBlob");if(-1===t.indexOf(";base64,")){for(var e=window.atob(t),a=e.length,n=new Uint8Array(a),o=0;o<a;o+=1)n[o]=e.charCodeAt(o);return new Blob([n],{type:"image/jpeg"})}for(var i=t.split(";base64,"),r=i[0].split(":")[1],c=window.atob(i[1]),s=c.length,l=new Uint8Array(s),d=0;d<s;d+=1)l[d]=c.charCodeAt(d);return new Blob([l],{type:r})}}},void 0,void 0,!1,null,null,null);b.options.__file="addons/time_clock_dev/1.0.0/src/mixins/baseToBlob.vue";var y=b.exports,C=u({name:"TimeClock",data:function(){return{addonConfig:n,viewOthers:!1,clock_on:!1,break_on:!1,activeData:[],attendanceData:[],loaded:{first:!1,active:!1,attendance:!1,duration:0,timestamp:!1,interval:!1}}},components:{ActiveAvatar:h,Events:m,Geo:k},mixins:[y],created:function(){c.actorId=c.getUserId(this),c.actor=c.getActor(this),this.$events.$on("".concat(this.addonConfig.package,":attedance_edit"),this.updateAll),this.$events.$on("".concat(this.addonConfig.package,":attedance_delete"),this.updateAll)},computed:{pageContentStyle:function(){return this.clock_on&&!this.break_on?{paddingBottom:"136px"}:{paddingBottom:"74px"}},toolbarStyle:function(){return this.clock_on&&!this.break_on?{height:"136px"}:{height:"74px"}},formattedAttendanceData:function(){return l.splitAttendanceIntoDays(this.attendanceData,this)},formattedActiveData:function(){return l.formatAttendanceActive(this.activeData,this)}},methods:{clockOnClick:function(){var t=this;console.log("TIME CLOCK: clockOnClick"),window.cordova?t.$f7router.navigate("".concat(t.addonConfig.baseUrl,"take-photo/")):(t.$f7.preloader.show(),t.$refs.geo.takeGeoAsync().then((function(e){var a=new FormData;a.append("event_id",c.shifts_active_id),a.append("latitude",e.latitude),a.append("longitude",e.longitude),a.append("accuracy",e.accuracy),a.append("status","start"),a.append("address",e.name),c.setAttendances(a).then((function(){t.updateAll(),t.clock_on=!0,t.$f7.preloader.hide()}))})))},clockOffClick:function(){var t=this;console.log("TIME CLOCK: clockOffClick"),window.cordova?t.$f7router.navigate("".concat(t.addonConfig.baseUrl,"take-photo/")):(t.$f7.preloader.show(),t.$refs.geo.takeGeoAsync().then((function(e){var a=new FormData;a.append("event_id",c.shifts_active_id),a.append("latitude",e.latitude),a.append("longitude",e.longitude),a.append("accuracy",e.accuracy),a.append("status","stop"),a.append("address",e.name),t.loaded.duration=0,c.setAttendances(a).then((function(){t.updateAll(),t.clock_on=!1,t.$f7.preloader.hide()}))})))},breakOnClick:function(){var t=this;t.$refs.geo.takeGeoAsync().then((function(e){var a={event_id:c.shifts_active_id,latitude:e.latitude,longitude:e.longitude,accuracy:e.accuracy,status:"pause",address:e.name};t.loaded.duration=0,t.loaded.timestamp=t.$moment(new Date).format(),c.setAttendances(a).then((function(){t.updateAttendances(),t.break_on=!0}))}))},breakOffClick:function(){var t=this;t.$refs.geo.takeGeoAsync().then((function(e){var a={event_id:c.shifts_active_id,latitude:e.latitude,longitude:e.longitude,accuracy:e.accuracy,status:"resume",address:e.name};t.loaded.duration=0,t.loaded.timestamp=t.$moment(t.activeData.timestamp).format(),c.setAttendances(a).then((function(){t.updateAttendances(),t.break_on=!1}))}))},updateAll:function(){var t=this;return t.updateAttendances().then((function(){return t.updateAttendancesActive()}))},updateAttendances:function(){var t=this;t.loaded.attendance=!1;var e={others:t.viewOthers};return c.getAttendances({otherOptions:e}).then((function(e){t.attendanceData=l.prepareAttendances(e,t),t.loaded.attendance=!0,t.updateStatus()}))},updateAttendancesActive:function(){var t=this;t.loaded.active=!1;var e={others:t.viewOthers};return c.getAttendancesActive({otherOptions:e}).then((function(e){t.activeData=l.prepareAttendance(e,t),null!==t.activeData&&(t.loaded.timestamp=t.activeData.timestamp),t.loaded.active=!0}))},updateStatus:function(){var t=this.attendanceData.find((function(t){if(t.user_id=c.actorId)return!0}));if(t)switch(t.status){case"start":this.clock_on=!0,this.break_on=!1;break;case"stop":this.clock_on=!1,this.break_on=!1;break;case"pause":this.clock_on=!0,this.break_on=!0;break;case"resume":this.clock_on=!0,this.break_on=!1;break;default:this.clock_on=!1,this.break_on=!1}else this.clock_on=!1,this.break_on=!1},formatDuration:function(){if(null!==this.activeData)return this.$moment.utc(this.$moment.duration(this.loaded.duration,"hours").asMilliseconds()).format("H:mm:ss")},calculateDuration:function(){if(null!==this.activeData&&(console.log("self.loaded.timestamp",this.loaded.timestamp),!1!==this.loaded.timestamp)){var t=this.$moment(this.loaded.timestamp),e=this.$moment(new Date),a=this.$moment.duration(e.diff(t));this.loaded.duration=a.asHours()}},onPtrRefresh:function(t){var e=t.detail;this.updateAll().then((function(){e()}))}},beforeDestroy:function(){this.$events.$off("".concat(this.addonConfig.package,":attedance_edit"),this.updateAll),this.$events.$off("".concat(this.addonConfig.package,":attedance_delete"),this.updateAll),clearInterval(this.loaded.interval)},mounted:function(){var t=this;return console.log("TIME_CLOCK - mounted"),t.loaded.interval=setInterval((function(){t.calculateDuration()}),1e3),console.log("TIMECLOCK - mounted"),Promise.all([t.$api.getInstalledAddonPermission(t.addonConfig.package,"attendance_other_access",{with_filters:!0})]).then((function(e){console.log("TIMECLOCK - mounted - promise then"),t.viewOthers=c.checkPermision(e[0],t);var a={others:t.viewOthers};console.log("TIMECLOCK - mounted promise then other options",JSON.stringify(a)),c.getAttendances({otherOptions:a}).then((function(e){console.log("TIMECLOCK - mounted promise get attendances"),t.attendanceData=l.prepareAttendances(e,t),t.loaded.attendance=!0,t.loaded.first=!0,console.log("TIMECLOCK - mounted promise get attendances - before update status"),t.updateStatus(),console.log("TIMECLOCK - mounted promise get attendances - before calculateDuration"),t.calculateDuration(),console.log("TIMECLOCK - mounted promise get attendances - after calculateDuration")})),c.getAttendancesActive({otherOptions:a}).then((function(e){console.log("TIMECLOCK - mounted promise get active attendances"),t.activeData=l.prepareAttendance(e,t),null!==t.activeData&&(t.loaded.timestamp=t.activeData.timestamp),t.loaded.active=!0}))}))}},o,[],!1,null,null,null);C.options.__file="addons/time_clock_dev/1.0.0/src/pages/index.vue";var w=C.exports,$=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("f7-page",{staticClass:"time-clock-settings-page"},[a("f7-navbar",[a("tommy-nav-back"),t._v(" "),a("f7-nav-title",[t._v(t._s(t.$t(t.addonConfig.package+".settings.title")))]),t._v(" "),a("f7-nav-right")],1),t._v(" "),a("f7-page-content",{ref:"pageContent"},[t.canLockMiniProgram?[a("f7-block-title",{staticClass:"time-clock-divider"},[t._v(t._s(t.$t(t.addonConfig.package+".settings.lock_mini_program_title"))+"\n        ")]),t._v(" "),a("f7-list",[a("f7-list-item",[a("span",[t._v(t._s(t.$t(t.addonConfig.package+".settings.lock_mini_program_toggle")))]),t._v(" "),a("f7-toggle",{attrs:{checked:t.$root.miniProgramLocked.isLocked},on:{"toggle:change":t.toggleIsMiniProgramLocked}})],1)],1)]:t._e()],2)],1)};$._withStripped=!0;var A=a(0);function O(t,e){var a=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),a.push.apply(a,n)}return a}function P(t,e,a){return e in t?Object.defineProperty(t,e,{value:a,enumerable:!0,configurable:!0,writable:!0}):t[e]=a,t}var D=u({name:"TimeClockSettings",components:{},computed:function(t){for(var e=1;e<arguments.length;e++){var a=null!=arguments[e]?arguments[e]:{};e%2?O(Object(a),!0).forEach((function(e){P(t,e,a[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(a)):O(Object(a)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(a,e))}))}return t}({},Object(A.a)("account",["canLockMiniProgram"])),mounted:function(){var t=this;t.$api.getInstalledAddonPermission("wallet_accounts","wallet_accounts_transaction_create_access",{resource_id:void 0,with_filters:!0}).then((function(e){e.resource_id=void 0,t.permissions.push(e)})),t.$api.getInstalledAddonPermission("wallet_accounts","wallet_accounts_transaction_edit_access",{resource_id:void 0,with_filters:!0}).then((function(e){e.resource_id=void 0,t.permissions.push(e)}))},methods:{saveListPermission:function(t){this.$api.updateInstalledAddonPermission("wallet_accounts",t.name,{resource_id:t.resource_id,with_filters:!0,filters:JSON.stringify(t.filters)})},addListPermission:function(t,e){t.filters.push(e),this.saveListPermission(t)},removeListPermission:function(t,e){t.filters.splice(t.filters.indexOf(e),1),this.saveListPermission(t)},toggleIsMiniProgramLocked:function(t){var e=this,a=e.addonConfig.package,n=window.device&&window.device.uuid?window.device.uuid:"",o={name:a,uuid:n,locked:t,platform:String(window.device.platform).toLowerCase()};e.$api.updateDevice(o).then((function(){e.$root.miniProgramLocked.isLocked=t,t&&(e.$root.miniProgramLocked.miniProgram=a),localStorage.miniProgramLocked=JSON.stringify(e.$root.miniProgramLocked)}))}},data:function(){return{addonConfig:n,hasActorId:c.actorId,permissions:[],attendanceData:[],csvHeaders:[]}}},$,[],!1,null,null,null);D.options.__file="addons/time_clock_dev/1.0.0/src/pages/settings.vue";var S=D.exports,x=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("f7-page",{staticClass:"time-clock-detail-page",on:{"page:beforeremove":t.onPageBeforeRemove,"page:beforeout":t.onPageBeforeOut}},[a("f7-navbar",[a("tommy-nav-back"),t._v(" "),a("f7-nav-title",[t._v(t._s(t.$t(t.addonConfig.package+".event_details.title")))]),t._v(" "),a("f7-nav-right",{staticClass:"whs-navbar-links"},[t.edit_acces?a("f7-link",{attrs:{"icon-only":""},on:{click:t.editAttendance}},[a("f7-icon",{attrs:{f7:"check"}})],1):t._e()],1)],1),t._v(" "),t.edit_acces?a("f7-toolbar",[a("f7-button",{on:{click:function(e){return t.deleteClick()}}},[t._v(t._s(t.$t(t.addonConfig.package+".event_details.delete_button")))])],1):t._e(),t._v(" "),t.loaded?a("f7-list",{attrs:{"media-list":""}},[a("f7-list-item",{attrs:{title:t.$t(t.addonConfig.package+".event_details.time_label"),link:t.edit_acces},nativeOn:{click:function(e){return t.openTimePickerDetail()}}},[a("div",{attrs:{slot:"after"},slot:"after"},[a("input",{attrs:{type:"text",id:"timePicker",readonly:""},domProps:{value:t.timeField}})])]),t._v(" "),a("f7-list-item",{attrs:{title:t.$t(t.addonConfig.package+".event_details.date_label"),link:t.edit_acces,after:t.dateField},nativeOn:{click:function(e){return t.openCalendar()}}}),t._v(" "),a("f7-list-item",{attrs:{title:t.$t(t.addonConfig.package+".event_details.who_label"),link:t.edit_acces},nativeOn:{click:function(e){return t.openSelector()}}},[a("div",{staticClass:"after-container",attrs:{slot:"after"},slot:"after"},[a("div",{staticClass:"name"},[t._v(t._s(t.detail_data.user_name))]),t._v(" "),a("div",{staticClass:"image",style:{backgroundImage:"url("+t.detail_data.icon_url+")"}})])]),t._v(" "),a("f7-list-item",{attrs:{title:t.$t(t.addonConfig.package+".event_details.where_label"),link:!0,after:t.detail_data.address},nativeOn:{click:function(e){return t.openMapPage(e)}}}),t._v(" "),"start"===t.detail_data.status||"stop"===t.detail_data.status?a("f7-list-item",{attrs:{title:t.$t(t.addonConfig.package+".event_details.photo_label"),link:!0},nativeOn:{click:function(e){return t.openPhoto()}}},[a("div",{staticClass:"after-container",attrs:{slot:"after"},slot:"after"},[a("div",{staticClass:"image",style:{backgroundImage:"url("+t.image_preview+")"}})])]):t._e(),t._v(" "),a("f7-list-item",{attrs:{title:t.$t(t.addonConfig.package+".event_details.action_label"),link:t.edit_acces,"sheet-open":".time-clock-action-sheet",after:t.$t(t.addonConfig.package+".index.clock_event_options."+t.detail_data.status)},on:{click:function(e){t.sheet_action_opened=!0}}})],1):t._e(),t._v(" "),t.loaded?t._e():a("f7-list",{staticClass:"skeleton-effect-blink skeleton-text",attrs:{"media-list":""}},[a("f7-list-item",{attrs:{title:"__________",after:"________"}}),t._v(" "),a("f7-list-item",{attrs:{title:"__________",after:"________"}}),t._v(" "),a("f7-list-item",{attrs:{title:"__________"}},[a("div",{staticClass:"after-container",attrs:{slot:"after"},slot:"after"},[a("div",{staticClass:"name"},[t._v("_______")]),t._v(" "),a("div",{staticClass:"image"})])]),t._v(" "),a("f7-list-item",{attrs:{title:"__________",after:"________"}}),t._v(" "),a("f7-list-item",{attrs:{title:"__________"}},[a("div",{staticClass:"after-container",attrs:{slot:"after"},slot:"after"},[a("div",{staticClass:"image"})])]),t._v(" "),a("f7-list-item",{attrs:{title:"__________",after:"________"}})],1),t._v(" "),a("f7-sheet",{ref:"actionSheet",staticClass:"time-clock-action-sheet"},[a("f7-toolbar",[a("div",{staticClass:"left"},[a("f7-link",{staticClass:"cancel",attrs:{"sheet-close":""},on:{click:t.clearAction}},[t._v(t._s(t.$t(t.addonConfig.package+".event_details.cancel_button")))])],1),t._v(" "),a("div",{staticClass:"right"},[a("f7-link",{attrs:{"sheet-close":""},on:{click:t.setAction}},[t._v(t._s(t.$t(t.addonConfig.package+".event_details.done_button")))])],1)]),t._v(" "),a("f7-page-content",[t.edit_acces&&t.loaded?a("f7-list",[a("f7-list-item",{attrs:{radio:"",checked:"start"===t.detail_data.status,title:t.$t(t.addonConfig.package+".index.clock_event_options.start"),name:"time-clock-detail-action",value:"start"},on:{change:function(e){return t.changeAction("start")}}}),t._v(" "),a("f7-list-item",{attrs:{radio:"",checked:"stop"===t.detail_data.status,title:t.$t(t.addonConfig.package+".index.clock_event_options.stop"),name:"time-clock-detail-action",value:"stop"},on:{change:function(e){return t.changeAction("stop")}}}),t._v(" "),a("f7-list-item",{attrs:{radio:"",checked:"pause"===t.detail_data.status,title:t.$t(t.addonConfig.package+".index.clock_event_options.pause"),name:"time-clock-detail-action",value:"pause"},on:{change:function(e){return t.changeAction("pause")}}}),t._v(" "),a("f7-list-item",{attrs:{radio:"",checked:"resume"===t.detail_data.status,title:t.$t(t.addonConfig.package+".index.clock_event_options.resume"),name:"time-clock-detail-action",value:"resume"},on:{change:function(e){return t.changeAction("resume")}}})],1):t._e()],1)],1),t._v(" "),t.edit_acces?a("Photo",{ref:"photo",attrs:{direction:"front"}}):t._e()],1)};x._withStripped=!0;var M=u({methods:{alertDialog:function(t,e,a){var n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null;this.$f7.dialog.create({title:t,text:e,cssClass:n,buttons:[{text:a,cssClass:"dialog-button-bold",keyCodes:[13]}]}).open()},confirmDialog:function(t,e,a,n,o,i){var r=arguments.length>6&&void 0!==arguments[6]?arguments[6]:null,c=arguments.length>7&&void 0!==arguments[7]&&arguments[7],s=!(arguments.length>8&&void 0!==arguments[8])||arguments[8];this.$f7.dialog.create({title:t,text:e,cssClass:r,buttons:[{text:n,bold:c,keyCodes:[27],onClick:function(){"function"==typeof i&&i()}},{text:a,bold:s,keyCodes:[13],onClick:function(){"function"==typeof o&&o()}}]}).open()}}},void 0,void 0,!1,null,null,null);M.options.__file="addons/time_clock_dev/1.0.0/src/mixins/dialog.vue";var E=M.exports,T=u({methods:{openTimePicker:function(){this.timePickerInstance.open()},createTimePicker:function(t){for(var e=this,a=new Date(t),n=[],o=[],i=0;i<=23;i+=1)n.push(i);for(var r=0;r<=59;r+=1)o.push(r);this.timePickerInstance=this.$f7.picker.create({inputEl:"#timePicker",toolbar:!0,rotateEffect:!1,sheetPush:!0,openIn:"popover",formatValue:function(t){return t[1]<10?t[0]+":0"+t[1]:t[0]+":"+t[1]},value:[a.getHours(),a.getMinutes()],cols:[{values:n},{divider:!0,content:":"},{values:o,displayValues:o.map((function(t){return t<10?"0".concat(t):t}))}]}),this.timePickerInstance.on("close",(function(){var t=e,a=new Date(t.detail_data.timestamp);a.setHours(Number(t.timePickerInstance.value[0])),a.setMinutes(Number(t.timePickerInstance.value[1])),a=a.toISOString(),t.detail_data.timestamp=a}))}}},void 0,void 0,!1,null,null,null);T.options.__file="addons/time_clock_dev/1.0.0/src/mixins/time-picker.vue";var I=T.exports,j=function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"camera-input-file",staticStyle:{display:"none"}},[this.isCordova?this._e():e("input",{ref:"inputFileCamera",attrs:{type:"file",multiple:!1,accept:"image/*"},on:{change:this.onFileCameraChange}})])};j._withStripped=!0;var L=u({props:{direction:{type:String,default:"BACK"}},mounted:function(){console.log("SDK - PHOTO mounted")},methods:{takePhoto:function(){this.isCordova?(this.openCamera(),window.addEventListener("focus",this.CordovaCameraCheck,!1)):(window.addEventListener("focus",this.FileCameraCheck,!1),this.$refs.inputFileCamera.click())},takePhotoAsync:function(){console.log("takePhotoAsync");var t=this,e=new Promise((function(e,a){t.resolvePromise=e,t.rejectPromise=a}));return t.takePhoto(),e},openCamera:function(){var t=this,e=(Camera.PictureSourceType.CAMERA,{quality:85,targetHeight:1080,targetWidth:1080,destinationType:Camera.DestinationType.DATA_URL,sourceType:Camera.PictureSourceType.CAMERA,encodingType:Camera.EncodingType.JPEG,mediaType:Camera.MediaType.PICTURE,allowEdit:!1,correctOrientation:!0,saveToPhotoAlbum:!1});e.cameraDirection=Camera.Direction[String(t.direction).toUpperCase()],navigator.camera.getPicture((function(e){t.photo_taken=!0,t.$emit("photo:send",e),"function"==typeof t.resolvePromise&&t.resolvePromise(e),navigator.camera.cleanup()}),(function(e){t.$app.notify("Unable to obtain picture: "+e,"app"),console.debug("Unable to obtain picture: "+e,"app"),"function"==typeof t.rejectPromise&&t.rejectPromise(e),navigator.camera.cleanup()}),e)},onFileCameraChange:function(t){var e=this,a=t.target.files;if(a.length)for(var n=function(t){var n=a[t],o=new FileReader;o.onload=function(){e.photo_taken=!0,e.resizeImageCamera(o.result).then((function(t){e.$emit("photo:send",t),"function"==typeof e.resolvePromise&&e.resolvePromise(t)}))},o.onError=function(t){e.$emit("photo:error",t),"function"==typeof e.rejectPromise&&e.rejectPromise(t)},o.readAsDataURL(n)},o=0;o<a.length;o+=1)n(o)},FileCameraCheck:function(t){var e=this;setTimeout((function(){0===e.$refs.inputFileCamera.files.length&&(e.$emit("photo:error","Photo not taken"),window.removeEventListener("focus",e.FileCameraCheck,!1),"function"==typeof e.rejectPromise&&e.rejectPromise("Photo not taken"))}),300)},CordovaCameraCheck:function(t){var e=this;setTimeout((function(){!1===photo_taken&&(e.$emit("photo:error","Photo not taken"),window.removeEventListener("focus",e.CordovaCameraCheck,!1),"function"==typeof e.rejectPromise&&e.rejectPromise("Photo not taken"))}),300)},resizeImageCamera:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1080,a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1080,n=new Image;return n.src=t,new Promise((function(o){n.onload=function(){if(n.height<=a&&n.width<=e)o(t);else{n.height>n.width?e=Math.floor(a*(n.width/n.height)):a=Math.floor(e*(n.height/n.width));var i=document.createElement("canvas"),r=i.getContext("2d");i.width=n.width,i.height=n.height,r.drawImage(n,0,0,i.width,i.height);for(var c={width:Math.floor(n.width),height:Math.floor(n.height)},s={width:null,height:null};.5*c.width>e;)s.width=Math.floor(.5*c.width),s.height=Math.floor(.5*c.height),r.drawImage(i,0,0,c.width,c.height,0,0,s.width,s.height),c.width=s.width,c.height=s.height;var l=document.createElement("canvas"),d=l.getContext("2d");l.width=e,l.height=a,d.drawImage(i,0,0,c.width,c.height,0,0,e,a);var u=l.toDataURL("image/jpeg");o(u)}}}))}},data:function(){return{photo_taken:!1,isCordova:this.$f7.device.cordova}}},j,[],!1,null,null,null);L.options.__file="addons/time_clock_dev/1.0.0/src/components/photo.vue";var R=u({name:"DetailActivity",mixins:[E,I,y],components:{Photo:L.exports},methods:{changeAction:function(t){this.detail_data.status=t},setAction:function(){null!==this.new_action&&(this.detail_data.event=String(this.new_action))},clearAction:function(){this.new_action=null},getPhotoCamera:function(t){},openMapPage:function(){var t="https://www.google.com/maps/place/".concat(this.detail_data.latitude,"+").concat(this.detail_data.longitude);window.open(t,"_system","location=yes,hidden=yes,beforeload=yes")},editCoordinates:function(t,e,a,n){this.detail_data.latitude=t,this.detail_data.longitude=e,this.detail_data.accuracy=a,this.detail_data.address=n},openPhoto:function(){this.$refs.actionSheet.close(),this.photoPreview.open()},openSelector:function(){var t=this;t.edit_acces&&t.$f7router.navigate("/time-clock/select-picker/",{props:{selected:t.detail_data.user_id,pageTitle:t.$t("".concat(n.package,".event_details.who_label")),multiply:!1,getData:t.getDataUser,type:"team",saveChange:function(e){t.detail_data.user_id=e.user_id,t.detail_data.user_name=e.first_name+" "+e.last_name,t.detail_data.icon_url=e.icon_url}}})},getDataUser:function(t){t.$api.getCurrentTeamMembers({cache:!0}).then((function(e){e.forEach((function(t,e){t.context="members"})),Object.assign(t.targets,e),t.loaded=!0,t.createSearchbar()}))},editAttendance:function(){var t=this;if(t.edit_acces){var e=new FormData;"pause"===t.detail_data.status||"resume"===t.detail_data.status?e.append("image",null):e.append("image",t.dataURLToBlob(t.image_preview),"attendance_".concat(t.detail_data.id,".jpg")),e.append("address",t.detail_data.address),e.append("latitude",t.detail_data.latitude),e.append("longitude",t.detail_data.longitude),e.append("accuracy",t.detail_data.accuracy),e.append("event_id",t.detail_data.event_id),e.append("status",t.detail_data.status),e.append("team_id",t.detail_data.team_id),e.append("user_id",t.detail_data.user_id),e.append("timestamp",t.detail_data.timestamp),c.editAttendance(t.detail_data.id,e).then((function(){t.$f7router.back(),t.$events.$emit("".concat(n.package,":attedance_edit"),t.detail_data)}))}},deleteAttendance:function(){var t=this;t.edit_acces&&c.deleteAttendance(t.detail_data.id).then((function(){t.$f7router.back(),t.$events.$emit("".concat(n.package,":attedance_delete"),t.detail_data)}))},deleteClick:function(){this.confirmDialog(!1,this.$t("".concat(n.package,".event_details.delete_text")),this.$t("".concat(n.package,".event_details.confirm_button")),this.$t("".concat(n.package,".event_details.cancel_button")),this.deleteAttendance,!1,null,!0,!1)},openCalendar:function(){this.edit_acces&&this.calendarInstance.open()},createCalendar:function(){var t=this,e=new Date(t.detail_data.timestamp);t.calendarInstance=t.$f7.calendar.create({value:[e],openIn:"customModal",backdrop:!0,closeOnSelect:!0,on:{change:function(e,a){var n=new Date(t.detail_data.timestamp),o=new Date(a[0]);n.setFullYear(o.getFullYear()),n.setMonth(o.getMonth()),n.setDate(o.getDate()),t.detail_data.timestamp=n.toISOString()}}})},onPageBeforeOut:function(){this.$refs.actionSheet.close()},onPageBeforeRemove:function(){this.$refs.actionSheet.$destroy(),this.calendarInstance&&this.calendarInstance.destroy()},prepareAttendance:function(t){var e=this.$store.state.teamMembers.teamMembers.filter((function(e){return e.user_id===t.user_id}));return t.user_name=e[0].first_name+" "+e[0].last_name,t.icon_url=e[0].icon_url,t},createPhotoPreview:function(){var t=this;t.photoPreview=t.$f7.photoBrowser.create({photos:[{url:t.image_preview}],theme:"dark",type:"standalone",toolbar:!1,backLinkText:"",swiper:{initialSlide:0,spaceBetween:20,speed:300,loop:!1,preloadImages:!0,navigation:{},zoom:{enabled:!0,maxRatio:3,minRatio:1},lazy:{enabled:!1}},renderNavbar:function(){var e="";return t.edit_acces&&(e='\n              <a href="#" class="link icon-only" id="time-clock-reload-photo" ref="reloadPhoto">\n                <i class="icon f7-icons color-white">reload</i>\n              </a>\n            '),'\n            <div class="navbar">\n              <div class="navbar-inner sliding">\n                <div class="left">\n                  <a href="#" class="link popup-close icon-only" data-popup=".photo-browser-popup">\n                    <i class="icon icon-back color-white"></i>\n                  </a>\n                </div>\n                <div class="right">'.concat(e,"</div>\n              </div>\n            </div>\n          ").trim()},on:{open:function(){t.$f7.$("#time-clock-reload-photo").on("click",t.reloadPhoto)},close:function(){t.$f7.$("#time-clock-reload-photo").off("click")}}})},reloadPhoto:function(){var t=this;t.$refs.photo.takePhotoAsync().then((function(e){t.image_preview=e,t.photoPreview.swiper.removeSlide(0),t.photoPreview.swiper.appendSlide('<div class="photo-browser-slide swiper-slide swiper-slide-active" data-swiper-slide-index="0"><span class="swiper-zoom-container"><img src="'.concat(e,'" ></span></div>')),t.photoPreview.params.photos=[{url:e}]}))},checkPermision:function(t){return void 0!==t.filters.find((function(t){if("members"===t.context){if(t.user_id===c.actorId)return!0}else if("roles"===t.context&&c.actor.roles.indexOf(t.name)>0)return!0}))},openTimePickerDetail:function(){this.edit_acces&&this.openTimePicker()}},computed:{dateField:function(){return this.detail_data?this.$moment(this.detail_data.timestamp).format("DD MMM YYYY"):null},timeField:function(){return this.detail_data?this.$moment(this.detail_data.timestamp).format("H:mm"):null}},mounted:function(){var t=this;t.$api.getInstalledAddonPermission(n.package,"attendance_edit_access",{with_filters:!0}).then((function(e){t.edit_acces=t.checkPermision(e),c.getAttendancesDetail(t.edit_id).then((function(e){t.detail_data=t.prepareAttendance(e),void 0!==t.detail_data.image&&(t.image_preview=t.detail_data.image.url),t.loaded=!0,t.edit_acces?t.$nextTick((function(){t.createCalendar(),t.createTimePicker(t.detail_data.timestamp),t.createPhotoPreview()})):t.$nextTick((function(){t.createPhotoPreview()}))}))}))},created:function(){},data:function(){return{addonConfig:n,image_preview:null,sheet_action_opened:!1,new_action:null,edit_id:this.$f7route.params.id,edit_acces:!1,detail_data:null,loaded:!1}}},x,[],!1,null,null,null);R.options.__file="addons/time_clock_dev/1.0.0/src/pages/detail.vue";var U=R.exports,Y=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("f7-page",{staticClass:"time-clock-search-page",attrs:{"page-content":!1},on:{"page:beforein":t.pageBeforeIn,"page:beforeout":t.pageBeforeOut}},[a("f7-navbar",[a("tommy-nav-back",{attrs:{force:""}}),t._v(" "),a("f7-nav-title",[t._v(t._s(t.$t(t.addonConfig.package+".search.title")))]),t._v(" "),a("f7-nav-right",{staticClass:"time-clock-navbar-links"},[a("f7-link",{attrs:{href:"#","icon-only":""},on:{click:function(e){return e.preventDefault(),t.csvExport()}}},[a("export-icon")],1)],1)],1),t._v(" "),a("f7-page-content",{ref:"pageContent"},[a("f7-list",{staticClass:"time-clock-searchbar-list"},[a("date-range-select",{on:{change:t.onDateRangeChange,save:t.onDateRangeSave},model:{value:t.dateRange,callback:function(e){t.dateRange=e},expression:"dateRange"}}),t._v(" "),a("f7-icon",{attrs:{slot:"media",icon:"demo-list-icon"},slot:"media"}),t._v(" "),a("f7-searchbar",{ref:"searhbar",staticClass:"time-clock-searchbar",attrs:{placeholder:t.$t(t.addonConfig.package+".search.search_placeholder"),customSearch:"",backdrop:!1,disableButton:"","disable-button-text":t.$t(t.addonConfig.package+".search.search_disable_button"),value:t.search},on:{input:function(e){return t.onSearchbarSearch(e.target.value)},"searchbar:clear":t.onSearchbarClear,"searchbar:enable":function(e){t.searchEnabled=!0},"searchbar:disable":function(e){t.searchEnabled=!1}}})],1),t._v(" "),t.isSearch?[t.viewOthers&&null!==t.activeData?a("div",{staticClass:"time-clock-active"},[a("Events",{attrs:{data:t.formattedActiveData,skeleton:1,loaded:t.loaded.active}})],1):t._e(),t._v(" "),a("Events",{attrs:{data:t.formattedAttendanceData,loaded:t.loaded.attendance}})]:t._e(),t._v(" "),0===t.attendanceData.length?a("div",{staticClass:"not-found"},[a("p",[t._v(t._s(t.$t(t.addonConfig.package+".search.not_found")))])]):t._e()],2)],1)};Y._withStripped=!0;var G=function(){var t=this.$createElement,e=this._self._c||t;return e("ul",[e("f7-list-item",{attrs:{link:"#",title:this.$t("common.date_range","Date Range"),after:this.formatDateRange(this.value)},on:{click:this.openSelector}})],1)};function B(t){var e=new Date(t),a=e.getFullYear(),n=e.getMonth()+1,o=e.getDate();return n<10&&(n="0".concat(n)),o<10&&(o="0".concat(o)),"".concat(a,"-").concat(n,"-").concat(o)}G._withStripped=!0;var K=u({props:{value:[Array,String]},data:function(){return{}},mounted:function(){},methods:{formatDateRange:function(t){if(!t)return"";if("string"==typeof t){var e=t.charAt(0).toUpperCase()+t.slice(1);return window.tommy.i18n.t("date_range.".concat(t),e)}return Array.isArray(t)?"".concat(B(t[0])," - ").concat(B(t[1])):t||""},openSelector:function(){var t=this;t.$f7router.navigate("/settings/date-range/",{props:{dateRange:t.value,onChange:function(e){console.log("tommycore  : date range select: on change",e),t.$emit("input",e)},onSave:function(){console.log("tommycore  : date range select: on save",t.value),t.$emit("save",t.value)}}})}}},G,[],!1,null,null,null);K.options.__file="tommy-core/src/components/date-range-select.vue";var N=K.exports,H=function(){var t=this.$createElement,e=this._self._c||t;return e("svg",{staticStyle:{display:"block",height:"20px",width:"20px","z-index":"1"},attrs:{"aria-hidden":"true",focusable:"false",role:"img",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 384 512"}},[e("path",{attrs:{fill:"#333",d:"M216 236.07c0-6.63-5.37-12-12-12h-24c-6.63 0-12 5.37-12 12v84.01h-48.88c-10.71 0-16.05 12.97-8.45 20.52l72.31 71.77c4.99 4.95 13.04 4.95 18.03 0l72.31-71.77c7.6-7.54 2.26-20.52-8.45-20.52H216v-84.01zM369.83 97.98L285.94 14.1c-9-9-21.2-14.1-33.89-14.1H47.99C21.5.1 0 21.6 0 48.09v415.92C0 490.5 21.5 512 47.99 512h287.94c26.5 0 48.07-21.5 48.07-47.99V131.97c0-12.69-5.17-24.99-14.17-33.99zM255.95 51.99l76.09 76.08h-76.09V51.99zM336 464.01H47.99V48.09h159.97v103.98c0 13.3 10.7 23.99 24 23.99H336v287.95z"}})])};H._withStripped=!0;var F=u({name:"export-icon"},H,[],!1,null,"55a81718",null);F.options.__file="addons/time_clock_dev/1.0.0/src/components/icons/export-icon.vue";var V=F.exports,z=u({name:"TimeClockSearch",props:{start_search:{type:String,default:null}},components:{Events:m,dateRangeSelect:N,exportIcon:V},data:function(){return{addonConfig:n,dateRange:"",delayTimerSearch:null,search:null,searchEnabled:!1,scrollTop:0,loaded:{first:!1,active:!1,attendance:!1},activeData:[],formattedActiveData:{},attendanceData:[],formattedAttendanceData:{}}},created:function(){c.actorId=c.getUserId(this),c.actor=c.getActor(this)},computed:{isSearch:function(){return this.dateRange||this.search}},methods:{pageBeforeIn:function(){this.$refs.pageContent.$el.scrollTop=this.scrollTop},pageBeforeOut:function(){this.scrollTop=this.$refs.pageContent.$el.scrollTop},onSearchbarSearch:function(t){var e=this;e.search=t,clearTimeout(e.delayTimerSearch),e.delayTimerSearch=setTimeout((function(){e.getSearchData(t)}),1e3)},getSearchData:function(t){this.search=t,this.refreshSearchResults()},onSearchbarClear:function(){this.search=""},onDateRangeChange:function(t){console.log("search - date range change: "+t)},onDateRangeSave:function(t){console.log("search - date range save: "+t),this.refreshSearchResults()},refreshSearchResults:function(){var t=this,e={others:t.viewOthers};t.dateRange&&(e.date_range=t.dateRange,console.log("daterange",t.dateRange)),t.search&&(e.search=encodeURIComponent(t.search)),c.getAttendances({otherOptions:e}).then((function(e){t.attendanceData=l.prepareAttendances(e,t),t.formattedAttendanceData=l.splitAttendanceIntoDays(t.attendanceData,t),t.loaded.attendance=!0,t.loaded.first=!0})),c.getAttendancesActive({otherOptions:e}).then((function(e){t.activeData=l.prepareAttendance(e,t),t.formattedActiveData=l.formatAttendanceActive(t.activeData,t),t.loaded.active=!0}))},csvExport:function(){var t=this,e="data:text/csv;charset=utf-8,";e+='"Person","Action","Address","Latitude","Longitude","Image","Timestamp"\n',t.attendanceData.forEach((function(a){e+='"'.concat(a.user_name,'","').concat(a.status,'","').concat(a.address,'","').concat(a.latitude,'","').concat(a.longitude,'","').concat(a.icon_url,'","').concat(t.$moment(a.timestamp).format("dddd, MMMM Do YYYY, h:mm:ss a"),'"')+"\n"}));var a=encodeURI(e),n=document.createElement("a");n.setAttribute("href",a),n.setAttribute("download","export.csv"),n.click()}},beforeDestroy:function(){},mounted:function(){var t=this;return Promise.all([t.$api.getInstalledAddonPermission(t.addonConfig.package,"attendance_other_access",{with_filters:!0})]).then((function(e){t.viewOthers=c.checkPermision(e[0],t),t.refreshSearchResults()}))}},Y,[],!1,null,null,null);z.options.__file="addons/time_clock_dev/1.0.0/src/pages/search.vue";var J=z.exports,q=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("f7-page",[a("f7-navbar",[a("tommy-nav-back"),t._v(" "),a("f7-nav-title",[t._v(t._s(t.pageTitle))]),t._v(" "),a("f7-nav-right",[t.changet?a("f7-link",{attrs:{"icon-only":""},on:{click:function(e){return t.saveSelected()}}},[a("f7-icon",{attrs:{f7:"check"}})],1):t._e()],1),t._v(" "),a("f7-subnavbar",{attrs:{inner:!1}},[a("f7-searchbar",{attrs:{init:!1}})],1)],1),t._v(" "),a("select-list",{attrs:{type:t.type,data:t.targets,loaded:t.loaded,selected:t.selected,multiply:t.multiply,image_link:t.image_link},on:{change:t.selectChanget}})],1)};q._withStripped=!0;var X=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"main-list-container"},[t.loaded?[Object.keys(t.data).length>0?a("f7-list",{staticClass:"time-clock-select-list searchbar-found",attrs:{"media-list":"",id:"time-clock-select-"+t.type}},t._l(t.data,(function(e,n){return a("f7-list-item",{key:t.type+"_"+n,attrs:{checkbox:t.multiply,radio:!t.multiply,name:"time-clock-select-list-item",checked:t.selected==e.user_id,title:e.name||e.first_name+" "+e.last_name},on:{change:function(a){return t.toggleItem(e,a.target.checked)}}},[a("div",{staticClass:"time-clock-item-image",style:[e.icon_url?{"background-image":"url("+e.icon_url+")"}:""],attrs:{slot:"media"},slot:"media"})])})),1):t._e()]:t._e(),t._v(" "),t.loaded?t._e():[a("div",{staticStyle:{background:"#fff"}},[a("f7-list",{staticClass:"time-clock-list time-clock-select-list skeleton-text skeleton-effect-blink",attrs:{"media-list":""}},t._l(t.skeleton_count,(function(e){return a("f7-list-item",{key:"skeleton"+t.type+"_"+e},[a("div",{staticClass:"item-title",staticStyle:{color:"#ccc !important"}},[t._v("_______________")]),t._v(" "),a("div",{staticClass:"time-clock-item-image",attrs:{slot:"media"},slot:"media"}),t._v(" "),a("div",{staticClass:"time-clock-item-row"},[t._v("_______________")])])})),1)],1)]],2)};X._withStripped=!0;var W=u({name:"MainList",props:{type:String,data:Object,selected:Number,multiply:Boolean,loaded:{type:Boolean,default:!1},skeleton_count:{type:Number,default:5}},methods:{toggleItem:function(t,e){self=this,self.$emit("change",{target:t,checked:e})}},data:function(){return{}}},X,[],!1,null,null,null);W.options.__file="addons/time_clock_dev/1.0.0/src/components/select-list.vue";var Q=W.exports,Z=u({props:{selected:Number,saveChange:Function,getData:Function,pageTitle:String,type:String,multiply:Boolean,image_link:String},components:{"select-list":Q},mounted:function(){this.getData(this)},methods:{createSearchbar:function(){var t=this;t.$nextTick((function(){t.$f7.searchbar.create({el:".searchbar",searchContainer:"#time-clock-select-"+t.type,searchIn:".item-title"})}))},selectChanget:function(t){this.changet=!0,this.changet_data=t},saveSelected:function(){this.saveChange(this.changet_data.target),this.$f7router.back()}},data:function(){return{changet:!1,changet_data:null,targets:{},loaded:!1}}},q,[],!1,null,null,null);Z.options.__file="addons/time_clock_dev/1.0.0/src/pages/select-picker.vue";var tt=Z.exports,et=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("f7-page",{staticClass:"time-clock-take-photo",attrs:{"page-content":!1}},[a("f7-navbar",[a("tommy-nav-menu"),t._v(" "),a("f7-nav-title",[t._v(t._s(t.$t(t.addonConfig.package+".take_photo.title")))])],1),t._v(" "),a("f7-toolbar",{staticClass:"time-clock-main-toolbar",style:t.toolbarStyle},[t.clock_on?t._e():a("f7-button",{staticClass:"time-clock-toolbar-button clock-on",attrs:{raised:"",fill:""},on:{click:t.clockOnClick}},[t._v(t._s(t.$t(t.addonConfig.package+".index.clock_on_button"))+"\n    ")]),t._v(" "),t.clock_on?a("f7-button",{staticClass:"time-clock-toolbar-button clock-off",attrs:{raised:"",fill:""},on:{click:t.clockOffClick}},[t._v(t._s(t.$t(t.addonConfig.package+".index.clock_off_button"))+" "+t._s(t.formatDuration())+"\n    ")]):t._e()],1),t._v(" "),a("f7-page-content",[a("h1",{staticClass:"time-clock-take-photo__time"},[t._v(t._s(t.timeDisplay))]),t._v(" "),a("h2",{staticClass:"time-clock-take-photo__date"},[t._v(t._s(t.dayDisplay))]),t._v(" "),a("Geo",{ref:"geo",attrs:{dialog:!1}})],1)],1)};et._withStripped=!0;var at=u({name:"TimeClockTakePhoto",components:{Geo:k},mixins:[y],data:function(){return{addonConfig:n,timeDisplay:this.$moment().format("h:mm:ss A"),dayDisplay:this.$moment().format("dddd, Do MMMM"),clock_on:!1,activeData:[],loaded:{first:!1,active:!1,attendance:!1,duration:0,timestamp:!1,interval:!1}}},mounted:function(){var t=this;setInterval((function(){t.timeDisplay=t.$moment().format("h:mm:ss A"),t.dayDisplay=t.$moment().format("dddd, Do MMM")}),1e3),window.cordova&&CameraPreview.startCamera({x:50,y:185,width:220,height:220,toBack:!1,previewDrag:!1,tapPhoto:!0});c.getAttendances({otherOptions:{others:!1}}).then((function(e){t.attendanceData=l.prepareAttendances(e,t),t.updateStatus()}))},computed:{toolbarStyle:function(){return{height:"72px"}}},methods:{updateStatus:function(){var t=this.attendanceData.find((function(t){if(t.user_id=c.actorId)return!0}));if(t)switch(t.status){case"start":this.clock_on=!0;break;case"stop":this.clock_on=!1;break;case"pause":case"resume":this.clock_on=!0;break;default:this.clock_on=!1}else this.clock_on=!1},formatDuration:function(){if(null!==this.activeData)return this.$moment.utc(this.$moment.duration(this.loaded.duration,"hours").asMilliseconds()).format("H:mm:ss")},calculateDuration:function(){if(null!==this.activeData&&!1!==this.loaded.timestamp){var t=this.$moment(this.loaded.timestamp),e=this.$moment(new Date),a=this.$moment.duration(e.diff(t));this.loaded.duration=a.asHours()}},clockOnClick:function(){var t=this;console.log("TIME CLOCK: clockOnClick"),t.$f7.preloader.show(),t.$refs.geo.takeGeoAsync().then((function(e){console.log("TAKE_PHOTO: ",JSON.stringify(e)),CameraPreview.takePicture({width:1024,height:1024,quality:80},(function(a){console.log("TAKE_PHOTO: CameraPreview.takePicture ",JSON.stringify(a)),CameraPreview.stopCamera(),console.log("TAKE_PHOTO: After  CameraPreview.stopCamera();");var n=new FormData;n.append("event_id",c.shifts_active_id),n.append("latitude",e.latitude),n.append("longitude",e.longitude),n.append("accuracy",e.accuracy),n.append("status","start"),n.append("address",e.name),n.append("image",t.dataURLToBlob(a),"attendance_stop.jpg"),t.loaded.duration=0,c.setAttendances(n).then((function(){t.clock_on=!1,t.$f7.preloader.hide(),t.$f7router.navigate("/time-clock/")}))})).catch((function(){t.$f7.preloader.hide()}))}))},clockOffClick:function(){var t=this;console.log("TIME CLOCK: clockOffClick"),t.$f7.preloader.show(),t.$refs.geo.takeGeoAsync().then((function(e){console.log("TAKE_PHOTO: ",JSON.stringify(e)),CameraPreview.takePicture({width:1024,height:1024,quality:80},(function(a){console.log("TAKE_PHOTO: CameraPreview.takePicture ",JSON.stringify(a)),CameraPreview.stopCamera(),console.log("TAKE_PHOTO: After  CameraPreview.stopCamera();");var n=new FormData;n.append("event_id",c.shifts_active_id),n.append("latitude",e.latitude),n.append("longitude",e.longitude),n.append("accuracy",e.accuracy),n.append("status","stop"),n.append("address",e.name),n.append("image",t.dataURLToBlob(a),"attendance_stop.jpg"),t.loaded.duration=0,c.setAttendances(n).then((function(){t.clock_on=!1,t.$f7.preloader.hide(),t.$f7router.navigate("/time-clock/")}))})).catch((function(){t.$f7.preloader.hide()}))}))}}},et,[],!1,null,"0ff0936b",null);at.options.__file="addons/time_clock_dev/1.0.0/src/pages/take-photo.vue";var nt=at.exports;console.log("TIME_CLOCK addon");var ot=[{path:"".concat(n.baseUrl),component:w},{path:"".concat(n.baseUrl,"settings/"),component:S},{path:"".concat(n.baseUrl,"detail/:id"),component:U},{path:"".concat(n.baseUrl,"search/"),component:J},{path:"".concat(n.baseUrl,"select-picker/"),component:tt},{path:"".concat(n.baseUrl,"take-photo/"),component:nt}];e.default=ot}]).default;