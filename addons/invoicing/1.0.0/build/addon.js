var addon=function(){var r=window.tommy,o=r.api,n={actor:void 0,actorId:void 0,isNurse:!1,assignee_id:null,contacts:null,loadOrder:function loadOrder(t){var e={with_filters:!0,with_permission_to:!0,actor_id:n.actorId};return o.call({endpoint:"vendor/manager/orders/"+t,data:e})},saveOrder:function saveOrder(t){return o.call({method:t.id?"PUT":"POST",endpoint:"vendor/manager/orders/"+(t.id||""),data:t})},cancelOrder:function cancelOrder(t){return o.call({endpoint:"vendor/manager/orders/"+t.id,method:"DELETE"})},loadListOrders:function loadListOrders(t){var e=[];if(t.data&&t.filters)for(var i=0;i<t.filters.length;i+=1)e.indexOf(t.filters[i].name)<0&&e.push(t.filters[i].name);var a={tags:e,with_filters:!0,with_permission_to:!0,actor_id:n.actorId,assignee_id:n.assignee_id||void 0};return t.data.date_range&&(a.date_range=t.data.date_range,Array.isArray(a.date_range)&&(a.date_range=a.date_range.map(function(t){return t/1e3}))),t.data.status?a.status=t.data.status:n.assignee_id&&(a.status=["complete","paid","processing"]),t.data.sort&&(a.sort=t.data.sort),t.data.price_min&&(a.price_min=t.data.price_min),t.data.price_max&&(a.price_max=t.data.price_max),t.data.balance_min&&(a.balance_min=t.data.balance_min),t.data.balance_max&&(a.balance_max=t.data.balance_max),"invoice"===t.data.type&&(a.invoices=!0),"quote"===t.data.type&&(a.quotes=!0),t.data.customer&&(a.user_id=t.data.customer),t.data.only_assigned?a.assignee_id=n.actorId||r.root.user.id:t.data.assignee&&(a.assignee_id=t.data.assignee),a.data=JSON.stringify(a.data),o.call({endpoint:"/vendor/manager/orders",data:a})},loadList:function loadList(t){return o.getFragment(t,{data:{addon:"invoicing",kind:"OrderList",with_filters:!0,with_permission_to:!0}})},loadLists:function loadLists(t,e){void 0===t&&(t={}),void 0===e&&(e={});var i=Object.assign({addon:"invoicing",kind:"OrderList",with_filters:!0,with_permission_to:!0,actor_id:n.actorId,user_id:n.actorId,only_owned:!n.actorId&&!n.isNurse},t);return n.actorId||n.isNurse||void 0!==i.only_owned||(i.only_owned=!0),o.getFragments(i,e)},deleteList:function deleteList(t,e){return o.deleteFragment(t,{data:e})},saveList:function saveList(t){t.addon="invoicing",t.kind="OrderList",t.with_filters=!0,t.with_permission_to=!0,t.data||(t.data={}),void 0===t.data.position&&(t.data.position=0),void 0===t.data.active&&(t.data.active=!0),t.id||(t.with_permissions=["order_list_read_access","order_list_edit_access"]);var e=Object.assign({},t,{data:JSON.stringify(t.data),filters:JSON.stringify(t.filters)});return t.id?o.updateFragment(t.id,e):o.createFragment(e)},createDefaultList:function createDefaultList(){var t={name:r.i18n.t("invoicing.index.default_list_name"),data:{default:!0},filters:[]};return n.saveList(t)},loadPromotions:function loadPromotions(){return o.call({endpoint:"vendor/manager/coupons",method:"GET",cache:!1})},loadPromotion:function loadPromotion(t){return o.call({endpoint:"vendor/manager/coupons/"+t,method:"GET",cache:!1})},savePromotion:function savePromotion(t){return o.call({endpoint:"vendor/manager/coupons/"+(t.id||""),method:t.id?"PUT":"POST",data:t,dataType:"json",contentType:"application/json",processData:!1})},loadProducts:function loadProducts(){return o.call({endpoint:"vendor/manager/products",method:"GET",cache:!1})},loadProduct:function loadProduct(t){return o.call({endpoint:"vendor/manager/products/"+t,method:"GET",cache:!1})},saveProduct:function saveProduct(t,e){var a=new FormData,n=Object.assign({},t);return n.data&&"object"==typeof n.data&&(n.data=Object.assign({},n.data)),Object.keys(n).forEach(function(t){var e,i=n[t];if(null===i&&(i=""),"null"===i&&(i=""),("data"===t||"filters"===t||"vendor_product_ids"===t)&&i||Array.isArray(i))return"string"==typeof i&&"[object Object]"!==i&&(i=JSON.parse(i)),"[object Object]"===i?(i="",void a.append(t,i)):Array.isArray(i)&&!i.length?(i=null,void a.append(t,i)):void(Object.keys(i).length?i=r.app.f7.utils.serializeObject(((e={})[t]=i,e)).split("&").forEach(function(t){a.append(t.split("=")[0],decodeURIComponent(t.split("=")[1]))}):(i="",a.append(t,i)));"image"!==t||i||(i=null),"image_url"!==t||i||(i=null),a.append(t,i)}),o.call({endpoint:"vendor/manager/"+(e?"packages":"products")+"/"+(t.id||""),method:t.id?"PUT":"POST",data:a,contentType:"multipart/form-data"})},loadPackages:function loadPackages(t,e){return void 0===t&&(t={}),void 0===e&&(e={}),o.call({endpoint:"vendor/manager/packages",method:"GET",cache:!1})},loadPackage:function loadPackage(t){return o.call({endpoint:"vendor/manager/packages/"+t,method:"GET",cache:!1})}};function g(){var i=this,t=i.$createElement,a=i._self._c||t;return a("f7-page",{staticClass:"invoicing-page",attrs:{id:"invoicing__index",name:"invoicing__index"}},[a("f7-navbar",[a("tommy-nav-menu"),i._v(" "),a("f7-nav-title",[i._v(i._s(i.pageTitle))]),i._v(" "),i.isNurse?i._e():a("f7-nav-right",[a("f7-link",{attrs:{href:"/invoicing/settings/","icon-f7":"gear"}}),i._v(" "),a("f7-link",{attrs:{href:"/invoicing/order-details/","icon-f7":"add"}})],1)],1),i._v(" "),i.orderedLists&&i.orderedLists.length?a("f7-swiper",{staticClass:"no-swipe-panel",attrs:{params:{slidesPerView:"auto",breakpointsInverse:!0,centeredSlides:!1,touchMoveStopPropagation:!1,on:{tap:i.onSlideClick},breakpoints:{768:{centeredSlides:!0}}}}},i._l(i.orderedLists,function(e){return a("f7-swiper-slide",{key:e.id},[a("div",{staticClass:"orders-list",class:{hasScroll:i.listWithScroll[e.id]},attrs:{"data-id":e.id}},[a("div",{staticClass:"orders-list-header"},[a("div",[i._v(i._s(e.name))]),i._v(" "),a("div",{staticClass:"order-list-header-right"},[i.canEditList(e)?a("a",{attrs:{"data-url":"/invoicing/list-edit/"+e.id+"/"}},[a("img",{attrs:{src:i.$addonAssetsUrl+"slice6.png",srcset:i.$addonAssetsUrl+"slice6@2x.png 2x, "+i.$addonAssetsUrl+"slice6@3x.png 3x"}})]):i._e(),i._v(" "),i.canEditList(e)&&0<e.orders.length?a("a",{ref:"download",refInFor:!0,on:{click:function(t){return i.downloadCSV(e.orders,e.name)}}},[a("img",{attrs:{src:i.$addonAssetsUrl+"slice20.png",srcset:i.$addonAssetsUrl+"slice20@2x.png 2x, "+i.$addonAssetsUrl+"slice20@3x.png 3x"}})]):i._e()])]),i._v(" "),a("div",{staticClass:"orders-list-content"},[e.orders&&e.orders.length?i._l(e.orders,function(t,e){return a("a",{key:e,staticClass:"card invoicing-order-card",attrs:{"data-url":"/invoicing/order-details/"+t.id+"/"}},[a("div",{staticClass:"card-header"},[t.data&&t.data.date?a("span",{staticClass:"order-date"},[i._v(i._s(i.orderDate(t.data?t.data.date:null)))]):i._e(),i._v(" "),i.isNurse?i._e():a("span",{staticClass:"order-status"},[i._v(i._s(i.$t("invoicing.order_status."+t.status)))])]),i._v(" "),a("div",{staticClass:"card-content"},[a("f7-list",{staticClass:"no-hairlines no-hairlines-between"},[t.user_id?a("f7-list-item",{attrs:{title:i.orderUserName(t.user_id)}},[a("img",{attrs:{slot:"media",src:i.$addonAssetsUrl+"icon-user.svg"},slot:"media"})]):i._e(),i._v(" "),a("f7-list-item",{attrs:{title:t.name}},[a("img",{attrs:{slot:"media",src:i.$addonAssetsUrl+"icon-product.svg"},slot:"media"})]),i._v(" "),t.total&&!i.isNurse?a("f7-list-item",{attrs:{title:t.total}},[a("img",{attrs:{slot:"media",src:i.$addonAssetsUrl+"icon-money.svg"},slot:"media"})]):i._e(),i._v(" "),t.data&&t.data.location?a("f7-list-item",{attrs:{title:t.data.location.address+" "+t.data.location.city}},[a("img",{attrs:{slot:"media",src:i.$addonAssetsUrl+"icon-location.svg"},slot:"media"})]):i._e()],1)],1)])}):i._e()],2)])])}),1):i._e()],1)}function p(){var t=this,e=t.$createElement,i=t._self._c||e;return i("f7-page",{staticClass:"invoicing-page",attrs:{id:"invoicing__settings","data-name":"invoicing__settings"}},[i("f7-navbar",[i("tommy-nav-back"),t._v(" "),i("f7-nav-title",[t._v(t._s(t.$t("invoicing.settings.title","Settings")))])],1),t._v(" "),i("f7-list",{staticClass:"list-custom"},[t.hasActorId?t._e():i("f7-list-item",{attrs:{link:"/invoicing/list-management/",title:t.$t("invoicing.settings.list_management","List Management")}}),t._v(" "),t.isNurse?t._e():i("f7-list-item",{attrs:{link:"/invoicing/item-service-management/",title:t.$t("invoicing.settings.item_service_management","Item/Service Management")}}),t._v(" "),t.isNurse?t._e():i("f7-list-item",{attrs:{link:"/invoicing/promotion-management/",title:t.$t("invoicing.settings.promotion_management","Promotion Management")}})],1)],1)}function z(){var e=this,t=e.$createElement,i=e._self._c||t;return i("f7-page",{staticClass:"invoicing-page",attrs:{name:"invoicing__item-service-management",id:"invoicing__item-service-management"}},[i("f7-navbar",[i("tommy-nav-back"),e._v(" "),i("f7-nav-title",[e._v(e._s(e.$t("invoicing.item_service_management.title","Items / Service")))]),e._v(" "),i("f7-nav-right",[i("f7-link",{attrs:{"icon-f7":"add"},on:{click:e.addItem}})],1)],1),e._v(" "),i("div",{staticClass:"item-service-tabs-links"},[i("f7-link",{class:{active:"items"===e.activeTab},on:{click:function(t){e.activeTab="items"}}},[e._v(e._s(e.$t("invoicing.item_service_management.items_tab")))]),e._v(" "),i("f7-link",{class:{active:"packages"===e.activeTab},on:{click:function(t){e.activeTab="packages"}}},[e._v(e._s(e.$t("invoicing.item_service_management.packages_tab")))])],1),e._v(" "),i("div",{directives:[{name:"show",rawName:"v-show",value:"items"===e.activeTab,expression:"activeTab === 'items'"}],staticClass:"item-service-tab"},[e.items&&e.items.length?i("f7-searchbar",{attrs:{"search-container":".invoicing-list-items",backdrop:!1,"disable-button":!1,placeholder:e.$t("invoicing.item_service_management.search_items")}}):e._e(),e._v(" "),e.items&&e.items.length?i("f7-list",{staticClass:"list-custom invoicing-list-items",attrs:{"no-hairlines":""}},e._l(e.orderedProducts,function(t){return i("f7-list-item",{key:t.id,attrs:{title:t.name,link:"/invoicing/product-details/"+t.id+"/?title="+(t.name||"")}})}),1):e._e()],1),e._v(" "),i("div",{directives:[{name:"show",rawName:"v-show",value:"packages"===e.activeTab,expression:"activeTab === 'packages'"}],staticClass:"item-service-tab"},[e.packages&&e.packages.length?i("f7-searchbar",{attrs:{"search-container":".invoicing-list-packages",backdrop:!1,"disable-button":!1,placeholder:e.$t("invoicing.item_service_management.search_packages")}}):e._e(),e._v(" "),e.packages&&e.packages.length?i("f7-list",{staticClass:"list-custom invoicing-list-packages",attrs:{"no-hairlines":""}},e._l(e.orderedPackages,function(t){return i("f7-list-item",{key:t.id,attrs:{title:t.name,link:"/invoicing/package-details/"+t.id+"/?title="+(t.name||"")}})}),1):e._e()],1)],1)}function I(){var i=this,t=i.$createElement,a=i._self._c||t;return a("f7-page",{staticClass:"invoicing-page",attrs:{name:"invoicing__list-management",id:"invoicing__list-management"}},[a("f7-navbar",[a("tommy-nav-back"),i._v(" "),a("f7-nav-title",[i._v(i._s(i.$t("invoicing.list_management.title","List Management")))]),i._v(" "),a("f7-nav-right",[i.showSave?a("f7-link",{attrs:{"icon-f7":"check"},on:{click:i.save}}):i._e()],1)],1),i._v(" "),i.lists?a("f7-list",{staticClass:"list-custom",attrs:{sortable:"",sortableEnabled:"",inset:""},on:{"sortable:sort":i.onSort}},i._l(i.orderedLists,function(e){return a("f7-list-item",{key:e.id,attrs:{checkbox:"",checked:e.data.active,title:e.name},on:{change:function(t){return i.toggleListActive(e,t.target.checked)}}})}),1):i._e(),i._v(" "),a("f7-list",{staticClass:"list-custom margin-bottom",attrs:{inset:""}},[a("f7-list-item",{attrs:{link:"/invoicing/list-add/",title:i.$t("invoicing.list_management.create_list","Create New List")}})],1)],1)}function R(){var e=this,t=e.$createElement,i=e._self._c||t;return i("f7-page",{staticClass:"invoicing-page",attrs:{name:"invoicing__list-add",id:"invoicing__list-add"}},[i("f7-navbar",[i("tommy-nav-back"),e._v(" "),i("f7-nav-title",[e._v(e._s(e.$t("invoicing.list_add.title","Add List")))]),e._v(" "),i("f7-nav-right",[e.showSave?i("f7-link",{attrs:{"icon-f7":"check"},on:{click:e.save}}):e._e()],1)],1),e._v(" "),i("f7-list",{staticClass:"top-0 list-custom"},[i("f7-list-item",[i("f7-input",{attrs:{type:"text",placeholder:e.$t("invoicing.list_add.name_placeholder","Name"),value:e.name},on:{input:function(t){e.name=t.target.value}}})],1)],1)],1)}var t=function normalizeComponent(t,e,i,a,n,r,o,s,d,c){"boolean"!=typeof o&&(d=s,s=o,o=!1);var l,u="function"==typeof i?i.options:i;if(t&&t.render&&(u.render=t.render,u.staticRenderFns=t.staticRenderFns,u._compiled=!0,n&&(u.functional=!0)),a&&(u._scopeId=a),r?(l=function hook(t){(t=t||this.$vnode&&this.$vnode.ssrContext||this.parent&&this.parent.$vnode&&this.parent.$vnode.ssrContext)||"undefined"==typeof __VUE_SSR_CONTEXT__||(t=__VUE_SSR_CONTEXT__),e&&e.call(this,d(t)),t&&t._registeredComponents&&t._registeredComponents.add(r)},u._ssrRegister=l):e&&(l=o?function(){e.call(this,c(this.$root.$options.shadowRoot))}:function(t){e.call(this,s(t))}),l)if(u.functional){var v=u.render;u.render=function renderWithStyleInjection(t,e){return l.call(e),v(t,e)}}else{var m=u.beforeCreate;u.beforeCreate=m?[].concat(m,l):[l]}return i},e={data:function data(){var t,e=this,i=e.$f7route.query.actor_id,a=(t=(t=i?e.$root.teamMembers.filter(function(t){return t.user_id===parseInt(e.actorId,10)})[0]:e.$root.account)||e.$root.account).roles;return n.isNurse=!a||a&&0===a.length||a&&(0<=a.indexOf("Nurse")||0<=a.indexOf("Employee")),n.assignee_id=n.isNurse?t.user_id:null,{lists:null,actorId:i,listWithScroll:{},isNurse:n.isNurse,contacts:n.contacts,orderContacts:{},orderContactsLoading:{},csvKeys:[],csvValues:[]}},created:function created(){this.actorId?(n.actorId=parseInt(this.actorId,10),n.actor=this.actor,n.actor.roles&&(0<=n.actor.roles.indexOf("Nurse")||0<=n.actor.roles.indexOf("Employee"))&&(n.isNurse=!0,this.isNurse=!0,n.assignee_id=n.actor.user_id)):(delete n.actorId,delete n.actor)},computed:{actor:function actor(){var e=this;return e.actorId?e.$root.teamMembers.filter(function(t){return t.user_id===parseInt(e.actorId,10)})[0]:null},pageTitle:function pageTitle(){var e=this;if(!e.actorId)return e.$t("invoicing.index.title","Orders");var t=e.$root.teamMembers.filter(function(t){return t.user_id===parseInt(e.actorId,10)})[0].first_name;return e.$t("invoicing.index.title_user",{user:t})},orderedLists:function orderedLists(){return this.lists?this.lists.sort(function(t,e){return t.data.position-e.data.position}).filter(function(t){return t.data.active}):null}},methods:{downloadCSV:function downloadCSV(t,e){var i=this;t.forEach(function(t,e){i.traversalObject(t,e)});var a=this.csvKeys.join(",")+"\n"+this.csvValues.join(","),n=e+".csv",r=(new Blob(["\ufeff"+a],{type:"text/csv"}),document.createElement("a"));r.href="data:attachment/csv;charset=utf-8,\ufeff"+encodeURIComponent(a),r.target="_blank",r.download=n,r.click()},traversalObject:function traversalObject(t,e){for(var i in t)"object"==typeof t[i]?this.traversalObject(t[i],0):(0===e&&this.csvKeys.push(i),this.csvValues.push(t[i]))},onSlideClick:function onSlideClick(t){var e=this.$$(t.target).closest("a").eq(0).attr("data-url");e&&this.$f7router.navigate(e)},humanTime:function humanTime(t){var e=window.tommy.moment,i=e.utc(t).toDate();if(e(i).isValid()){var a=e().diff(e(i),"days");if(1===a)return"Yesterday "+e(i).format("h:mm A");if(0===a)return"Today "+e(i).format("h:mm A");if(-1===a)return"Yesterday "+e(i).format("h:mm A");if(1<=a&&a<=8||-8<=a&&a<=-1)return e(i).format("ddd h:mm A");if(365<=a||a<=-365)return e(i).format("MMM D, YYYY h:mm A");if(8<=a||a<=-8)return e(i).format("MMM D h:mm A")}return"None"},orderDate:function orderDate(t){return t?this.$moment(parseInt(t,10)).format("HH:mm D MMM YYYY"):""},orderUserName:function orderUserName(e){var t,i=this;return i.isNurse&&(t=i.orderContacts[e]),!(t=t||i.$root.teamMembers.filter(function(t){return t.user_id===parseInt(e,10)})[0])&&i.contacts&&i.contacts.length&&(t=i.contacts.filter(function(t){return t.friend_id===parseInt(e,10)})[0]),t?t.name||(t.first_name||"")+" "+(t.last_name||""):""},listHasScroll:function listHasScroll(t){if(!t.orders||0===t.orders.length)return!1;var e=this.$$('.orders-list[data-id="'+t.id+'"] .orders-list-content')[0];return!!e&&e.scrollHeight>e.offsetHeight},loadListOrders:function loadListOrders(e){var i=this;n.loadListOrders(e).then(function(t){(e.orders=t).forEach(function(e){i.isNurse&&(i.orderContacts[e.user_id]||i.orderContactsLoading[e.user_id]||(i.orderContacts[e.user_id]={},i.orderContactsLoading[e.user_id]=!0,i.$api.getContact(e.user_id).then(function(t){i.orderContacts[e.user_id]=t,i.orderContactsLoading[e.user_id]=!1,i.$forceUpdate()})))}),i.$nextTick(function(){i.listHasScroll(e)?i.$set(i.listWithScroll,e.id,!0):i.$set(i.listWithScroll,e.id,!1)})})},reloadListsOrders:function reloadListsOrders(){var e=this;e.lists&&e.lists.forEach(function(t){e.loadListOrders(t)})},loadLists:function loadLists(t,e){void 0===e&&(e=!0);var i=this;n.loadLists({},{cache:!t}).then(function(t){t.forEach(function(t){t.orders=[]}),i.lists=t,!i.lists.length&&e?n.createDefaultList(i.$root.user).then(function(){i.loadLists(!0,!1)}).catch(function(){i.loadLists(!0,!1)}):i.lists.forEach(function(t){t.data.active&&i.loadListOrders(t)})})},reloadLists:function reloadLists(){this.loadLists(!0)},canEditList:function canEditList(t){if(this.isNurse&&!this.actorId)return!1;var e=this.$root.account,i="Team"===e.type||"TeamMember"===e.type||0<=e.roles.indexOf("Team Manager"),a=0<=e.roles.indexOf("Team Manager");return!(!t.data.default||!a)||(!t.data.default||i)&&-1!==t.permission_to.indexOf("update")}},beforeDestroy:function beforeDestroy(){this.$events.$off("invoicing:reloadListsOrders",this.reloadListsOrders),this.$events.$off("invoicing:reloadLists",this.reloadLists)},mounted:function mounted(){var e=this;e.loadLists(),n.contacts||e.$api.getContacts().then(function(t){e.contacts=t,n.contacts=t}),e.$events.$on("invoicing:reloadListsOrders",e.reloadListsOrders),e.$events.$on("invoicing:reloadLists",e.reloadLists)}},i=(g._withStripped=!0,t({render:g,staticRenderFns:[]},void 0,e,void 0,!(g._withStripped=!0),void 0,void 0,void 0)),a={data:function data(){return{isNurse:n.isNurse}}},s=(p._withStripped=!0,t({render:p,staticRenderFns:[]},void 0,a,void 0,!(p._withStripped=!0),void 0,void 0,void 0)),d={data:function data(){return{items:null,packages:null,activeTab:"items"}},mounted:function mounted(){var t=this;t.loadProducts(),t.loadPackages(),t.$events.$on("invoicing:reloadProducts",t.loadProducts),t.$events.$on("invoicing:reloadPackages",t.loadPackages)},beforeDestroy:function beforeDestroy(){this.$events.$off("invoicing:reloadProducts",this.loadProducts),this.$events.$off("invoicing:reloadPackages",this.loadPackages)},computed:{orderedProducts:function orderedProducts(){return this.items?this.items.sort(function(t,e){return t.id-e.id}):[]},orderedPackages:function orderedPackages(){return this.packages?this.packages.sort(function(t,e){return t.id-e.id}):[]}},methods:{addItem:function addItem(){"items"===this.activeTab?this.$f7router.navigate("/invoicing/product-details/"):this.$f7router.navigate("/invoicing/package-details/")},loadPackages:function loadPackages(){var e=this;n.loadPackages({},{cache:!1}).then(function(t){e.packages=t})},loadProducts:function loadProducts(){var e=this;n.loadProducts({},{cache:!1}).then(function(t){e.items=t})},add:function add(){}}},c=(z._withStripped=!0,t({render:z,staticRenderFns:[]},void 0,d,void 0,!(z._withStripped=!0),void 0,void 0,void 0)),l={data:function data(){return{saving:!1,showSave:!1,lists:null}},mounted:function mounted(){var e=this;n.loadLists({},{cache:!1}).then(function(t){e.lists=t})},computed:{orderedLists:function orderedLists(){return this.lists?this.lists.sort(function(t,e){return t.data.position-e.data.position}):null}},methods:{onSort:function onSort(t,e){void 0===e&&(e={});var i=e.from,a=e.to,n=this;n.saving||(n.showSave=!0,n.$nextTick(function(){var t;n.lists[i].data.position=a,(t=n.lists).splice.apply(t,[a,0].concat(n.lists.splice(i,1))),n.$forceUpdate()}))},toggleListActive:function toggleListActive(t,e){this.saving||(this.showSave=!0,t.data.active=e)},save:function save(){var t=this;t.showSave=!1;var i=[];t.lists.forEach(function(t,e){t.data.position=e,i.push(n.saveList(t))}),Promise.all(i).then(function(){t.$events.$emit("invoicing:reloadLists"),t.$f7router.back()})}}},u=(I._withStripped=!0,t({render:I,staticRenderFns:[]},void 0,l,void 0,!(I._withStripped=!0),void 0,void 0,void 0)),v={data:function data(){return{saving:!1,name:""}},computed:{showSave:function showSave(){return this.name.trim().length}},methods:{save:function save(){var t=this;t.saving||(t.saving=!0,n.saveList({name:t.name}).then(function(){t.$events.$emit("invoicing:reloadLists"),t.$f7router.back("/invoicing/"+(n.actorId?"?actor_id="+n.actorId:""),{force:!0})}))}}},m=(R._withStripped=!0,t({render:R,staticRenderFns:[]},void 0,v,void 0,!(R._withStripped=!0),void 0,void 0,void 0)),f=["pending","paid","processing","qa","complete"];function formatDate(t){var e=new Date(t),i=e.getFullYear(),a=e.getMonth()+1,n=e.getDate();return a<10&&(a="0"+a),n<10&&(n="0"+n),i+"-"+a+"-"+n}function _(){var i=this,t=i.$createElement,a=i._self._c||t;return a("div",{staticClass:"tag-select tasks-tag-select orders-list-tags-select"},[a("ul",[a("li",{staticClass:"item-divider"},[i._v(i._s(i.data.title))]),i._v(" "),a("li",[a("a",{staticClass:"item-link tag-search",attrs:{href:"#"},on:{click:i.openSelector}},[a("div",{staticClass:"item-content"},[i._m(0),i._v(" "),a("div",{staticClass:"item-inner"},[a("div",{staticClass:"item-title"},[i._v(i._s(i.data.placeholder))])])])])])]),i._v(" "),a("ul",{staticClass:"tag-items"},i._l(i.data.tags,function(e,t){return a("li",{key:t,staticClass:"tag-item"},[a("div",{staticClass:"item-content"},[a("div",{staticClass:"item-inner"},[a("div",{staticClass:"item-title"},[i._v(i._s(e.name))]),i._v(" "),a("div",{staticClass:"item-after"},[a("a",{staticClass:"item-link",staticStyle:{height:"24px"},attrs:{href:"#"},on:{click:function(t){return i.removeTag(e)}}},[a("i",{staticClass:"material-icons"},[i._v("close")])])])])])])}),0)])}function ia(){var i=this,t=i.$createElement,a=i._self._c||t;return a("f7-page",{staticClass:"invoicing-page",attrs:{name:"invoicing__list-edit",id:"invoicing__list-edit"}},[a("f7-navbar",[a("tommy-nav-back"),i._v(" "),a("f7-nav-title",[i._v(i._s(i.$t("invoicing.list_edit.title","Edit List")))]),i._v(" "),a("f7-nav-right",[i.showSave?a("f7-link",{attrs:{"icon-f7":"check"},on:{click:i.save}}):i._e()],1)],1),i._v(" "),i.list?a("f7-list",{staticClass:"list-custom"},[a("f7-list-item",[a("f7-label",[i._v(i._s(i.$t("invoicing.list_edit.name","Name")))]),i._v(" "),a("f7-input",{attrs:{type:"text",value:i.list.name},on:{input:function(t){return i.onNameChange(t.target.value)}}})],1),i._v(" "),a("f7-list-item",{attrs:{"smart-select":"","smart-select-params":{closeOnSelect:!0},title:i.$t("invoicing.list_edit.sort","Sort")}},[a("select",{staticClass:"toggle-save",attrs:{name:"sort"},on:{change:i.onSortChange}},i._l(["default","price_high","price_low","newest"],function(t,e){return a("option",{key:e,domProps:{value:t,selected:i.list.data.sort===t||"default"===t&&!i.list.data.sort}},[i._v(i._s(i.$t("invoicing.list_edit.sort_"+t)))])}),0)]),i._v(" "),a("f7-list-item",{attrs:{link:"#",title:i.$t("invoicing.common.date_range","Date Range"),after:i.formatDateRange(i.list.data.date_range)},on:{click:i.showDateRange}}),i._v(" "),a("f7-list-item",{attrs:{"smart-select":"","smart-select-params":{openIn:"popover",closeOnSelect:!0},title:i.$t("invoicing.list_edit.filter_status","Status")}},[a("select",{staticClass:"toggle-save",attrs:{name:"statuses",multiple:""},on:{change:i.onStatusChange}},i._l(i.orderStatuses,function(t,e){return a("option",{key:e,domProps:{value:t,selected:0<=i.list.data.status.indexOf(t)||!i.list.data.status}},[i._v(i._s(i.$t("invoicing.order_status."+t)))])}),0)]),i._v(" "),a("f7-list-item",{attrs:{"smart-select":"","smart-select-params":{openIn:"popover",closeOnSelect:!0},title:i.$t("invoicing.list_edit.type")}},[a("select",{attrs:{name:"type"},on:{change:i.onTypeChange}},[a("option",{attrs:{value:"all"},domProps:{selected:"all"===i.list.data.type||!i.list.data.type}},[i._v(i._s(i.$t("invoicing.list_edit.type_all")))]),i._v(" "),a("option",{attrs:{value:"invoice"},domProps:{selected:"invoice"===i.list.data.type}},[i._v(i._s(i.$t("invoicing.list_edit.type_invoice")))]),i._v(" "),a("option",{attrs:{value:"quote"},domProps:{selected:"quote"===i.list.data.type}},[i._v(i._s(i.$t("invoicing.list_edit.type_quote")))])])]),i._v(" "),a("f7-list-item",{attrs:{link:"",title:i.$t("invoicing.list_edit.payment_range"),after:void 0!==i.list.data.price_min&&void 0!==i.list.data.price_max?i.list.data.price_min+" - "+i.list.data.price_max:""},on:{click:i.showPaymentRange}}),i._v(" "),i.$root.team&&i.$root.teamMembers&&!i.list.data.only_assigned?a("f7-list-item",{attrs:{"smart-select":"","smart-select-params":{searchbar:!0},title:i.$t("invoicing.list_edit.assignee","Assignee")}},[a("select",{attrs:{name:"assignee",multiple:""},on:{change:i.onAssigneeChange}},i._l(i.$root.teamMembers,function(t){return a("option",{key:t.id,attrs:{"data-option-class":"invoicing-smart-select-option","data-option-image":t.icon_url},domProps:{value:t.user_id,selected:0<=i.list.data.assignee.indexOf(t.user_id)}},[i._v(i._s(t.first_name||"")+" "+i._s(t.last_name||""))])}),0)]):i._e(),i._v(" "),i.contacts?a("f7-list-item",{attrs:{"smart-select":"","smart-select-params":{searchbar:!0},title:i.$t("invoicing.list_edit.customer","Customer")}},[a("select",{attrs:{name:"customer",multiple:""},on:{change:i.onCustomerChange}},i._l(i.contacts,function(t,e){return a("option",{key:e+"-"+t.id+"-"+t.friend_id,attrs:{"data-option-class":"invoicing-smart-select-option","data-option-image":t.icon_url},domProps:{value:t.friend_id,selected:0<=i.list.data.customer.indexOf(t.friend_id)}},[i._v(i._s(t.name||(t.first_name||"")+" "+(t.last_name||"")))])}),0)]):i._e(),i._v(" "),a("f7-list-item",{attrs:{title:i.$t("invoicing.list_edit.only_assigned","Show only assigned")}},[a("f7-toggle",{attrs:{slot:"after",checked:!!i.list.data.only_assigned},on:{change:function(t){return i.setOnlyAssigned(t.target.checked)}},slot:"after"})],1),i._v(" "),i._l(i.permissions,function(e,t){return a("tag-select",{key:t,attrs:{listId:i.list.id,data:{title:i.$t("invoicing.permissions."+e.name+".title"),placeholder:i.$t("invoicing.common.search_members_tags","Search Members, Tags"),pageTitle:i.$t("invoicing.common.search_members_tags","Search Members, Tags"),tags:e.filters}},on:{tagAdd:function(t){return i.addListPermission(e,t)},tagRemove:function(t){return i.removeListPermission(e,t)}}})})],2):i._e(),i._v(" "),i.list?a("f7-list",{staticClass:"margin-top"},[a("f7-list-button",{staticClass:"color-custom",attrs:{color:"custom"},on:{click:i.deleteList}},[i._v(i._s(i.$t("invoicing.list_edit.delete-list","Delete List")))])],1):i._e()],1)}function ra(){var e=this,t=e.$createElement,i=e._self._c||t;return i("f7-page",{staticClass:"invoicing-page",attrs:{name:"invoicing__date-range-select",id:"invoicing__date-range-select"}},[i("f7-navbar",[i("tommy-nav-back"),e._v(" "),i("f7-nav-title",[e._v(e._s(e.$t("invoicing.common.date_range","Date Range")))]),e._v(" "),i("f7-nav-right",[e.showSave?i("f7-link",{attrs:{"icon-f7":"check"},on:{click:e.save}}):e._e()],1)],1),e._v(" "),i("f7-list",[i("f7-list-item",{attrs:{radio:"",value:"",checked:!(e.isCustomRange||""!==e.range&&e.range),title:e.$t("invoicing.date_range.none","None")},on:{change:function(t){return e.setPlainRange("")}}}),e._v(" "),i("f7-list-item",{attrs:{radio:"",value:"today",checked:!e.isCustomRange&&"today"===e.range,title:e.$t("invoicing.date_range.today","Today")},on:{change:function(t){return e.setPlainRange("today")}}}),e._v(" "),i("f7-list-item",{attrs:{radio:"",value:"week",checked:!e.isCustomRange&&"week"===e.range,title:e.$t("invoicing.date_range.week","This Week")},on:{change:function(t){return e.setPlainRange("week")}}}),e._v(" "),i("f7-list-item",{attrs:{radio:"",value:"month",checked:!e.isCustomRange&&"month"===e.range,title:e.$t("invoicing.date_range.month","This Month")},on:{change:function(t){return e.setPlainRange("month")}}})],1),e._v(" "),i("f7-list",{staticClass:"top-10 list-custom"},[i("f7-list-item",{attrs:{title:e.$t("invoicing.common.choose_range","Choose Range")}},[i("f7-toggle",{attrs:{slot:"after",checked:e.isCustomRange},on:{change:function(t){return e.toggleCustomRange(t.target.checked)}},slot:"after"})],1),e._v(" "),i("f7-list-item",{directives:[{name:"show",rawName:"v-show",value:e.isCustomRange,expression:"isCustomRange"}]},[i("f7-label",[e._v(e._s(e.$t("invoicing.common.start_date","Start Date")))]),e._v(" "),i("f7-input",{ref:"rangeStart",attrs:{type:"text"}})],1),e._v(" "),i("f7-list-item",{directives:[{name:"show",rawName:"v-show",value:e.isCustomRange,expression:"isCustomRange"}]},[i("f7-label",[e._v(e._s(e.$t("invoicing.common.end_date","End Date")))]),e._v(" "),i("f7-input",{ref:"rangeEnd",attrs:{type:"text"}})],1)],1)],1)}function Aa(){var i=this,t=i.$createElement,a=i._self._c||t;return a("f7-page",{staticClass:"invoicing-page"},[a("f7-navbar",[a("tommy-nav-back"),i._v(" "),a("f7-nav-title",[i._v(i._s(i.pageTitle))]),i._v(" "),a("f7-subnavbar",{attrs:{inner:!1}},[a("f7-searchbar",{attrs:{"search-container":"#list-edit-tag-select","search-in":".item-title"},on:{"searchbar:search":i.onSearch}})],1)],1),i._v(" "),i.query&&i.query.length?a("f7-list",[a("f7-list-item",{staticClass:"tasks-tag-select-tags-list",attrs:{checkbox:"",title:i.query},on:{change:function(t){return i.toggleTag({context:"tags",name:i.query,label:"Tag"},t.target.checked,!0)}}},[a("span",{staticClass:"tag-select-list-icon",attrs:{slot:"media"},slot:"media"},[a("img",{attrs:{src:i.contextIconSrc({context:"tags",name:i.query,label:"Tag"}),srcset:i.contextIconSrcset({context:"tags",name:i.query,label:"Tag"})}})])])],1):i._e(),i._v(" "),a("f7-list",{staticClass:"no-margin no-hairlines tasks-tag-select-tags-list",attrs:{id:"list-edit-tag-select"}},i._l(i.allTags,function(e,t){return a("f7-list-item",{key:t,attrs:{checkbox:"",checked:i.isTagSelected(e),title:e.name},on:{change:function(t){return i.toggleTag(e,t.target.checked)}}},["members"===e.context?a("span",{staticClass:"tag-select-list-avatar",style:"background-image: url("+(e.icon||"")+")",attrs:{slot:"media"},slot:"media"}):a("span",{staticClass:"tag-select-list-icon",attrs:{slot:"media"},slot:"media"},[a("img",{attrs:{src:i.contextIconSrc(e),srcset:i.contextIconSrcset(e)}})])])}),1)],1)}function Ja(){var e=this,t=e.$createElement,i=e._self._c||t;return i("f7-page",{staticClass:"invoicing-page",attrs:{id:"invoicing__item-details","data-name":"invoicing__item-details"}},[i("f7-navbar",[i("tommy-nav-back"),e._v(" "),i("f7-nav-title",[e._v(e._s(e.pageTitle))]),e._v(" "),i("f7-nav-right",[e.showSave?i("f7-link",{attrs:{"icon-f7":"check"},on:{click:e.save}}):e._e()],1)],1),e._v(" "),e.item?i("f7-list",{staticClass:"list-custom"},[i("f7-list-input",{attrs:{label:e.$t("invoicing.item.name_label","Name"),placeholder:e.$t("invoicing.item.name_placeholder","Enter item/service name"),type:"text",value:e.item.name},on:{input:function(t){e.item.name=t.target.value,e.enableSave()}}}),e._v(" "),i("f7-list-item",{attrs:{title:e.$t("invoicing.item.enabled_label","Enabled")}},[i("f7-toggle",{attrs:{checked:e.item.active},on:{change:function(t){e.item.active=t.target.checked,e.enableSave()}}})],1),e._v(" "),i("f7-list-item",{attrs:{divider:"",title:e.$t("invoicing.item.description_label","Description")}}),e._v(" "),i("f7-list-input",{attrs:{placeholder:e.$t("invoicing.item.description_placeholder","Enter item/service description"),type:"textarea",resizable:"",value:e.item.description},on:{input:function(t){e.item.description=t.target.value,e.enableSave()}}}),e._v(" "),i("f7-list-item",{attrs:{divider:"",title:e.$t("invoicing.item.duration_label","Duration")}}),e._v(" "),i("f7-list-input",{attrs:{placeholder:e.$t("invoicing.item.duration_placeholder","Item duration in minutes"),type:"number",value:e.item.data.duration},on:{input:e.onDurationChange}}),e._v(" "),i("f7-list-item",{attrs:{divider:"",title:e.$t("invoicing.item.category_label","Category")}}),e._v(" "),i("f7-list-input",{attrs:{placeholder:e.$t("invoicing.item.category_placeholder","Enter item/service category"),type:"text",value:e.item.category},on:{input:function(t){e.item.category=t.target.value,e.enableSave()}}}),e._v(" "),i("f7-list-item",{attrs:{divider:"",title:e.$t("invoicing.item.available_in_label","Available in")}}),e._v(" "),i("f7-list-input",{attrs:{placeholder:e.$t("invoicing.item.available_in_placeholder","City where it is available"),type:"text",value:e.availabile_in},on:{input:function(t){return e.setAvailable(t.target.value)}}}),e._v(" "),i("f7-list-item",{attrs:{divider:"",title:e.$t("invoicing.item.photo_label","Photo")}}),e._v(" "),i("li",[i("div",{staticClass:"invoicing-product-photo-container"},[e.item.image_url||e.imagePreview?i("div",{staticClass:"invoicing-product-photo"},[i("img",{attrs:{src:e.item.image_url||e.imagePreview}}),e._v(" "),i("f7-link",{attrs:{"icon-f7":"close_round_fill"},on:{click:e.deleteImage}})],1):i("label",{staticClass:"invoicing-product-photo-add"},[i("input",{attrs:{type:"file"},on:{change:e.onFileChange}}),e._v(" "),i("f7-icon",{attrs:{f7:"add"}})],1)])]),e._v(" "),i("tag-select",{attrs:{slot:"after-list",data:{title:e.$t("invoicing.item.tags_label"),placeholder:e.$t("invoicing.common.search_members_tags","Search Members, Tags"),pageTitle:e.$t("invoicing.common.search_members_tags","Search Members, Tags"),tags:e.item.filters}},on:{tagAdd:e.addItemTag,tagRemove:e.removeItemTag},slot:"after-list"})],1):e._e(),e._v(" "),e.item?i("f7-list",{staticClass:"list-custom margin-top"},[i("f7-list-input",{attrs:{label:e.$t("invoicing.item.price_label","Price"),placeholder:e.$t("invoicing.item.price_placeholder","Enter item/service price"),type:"number",value:e.item.price},on:{input:function(t){return e.setPrice(t.target.value)}}}),e._v(" "),i("f7-list-input",{attrs:{label:e.$t("invoicing.item.barcode_label","Barcode ID"),placeholder:e.$t("invoicing.item.barcode_placeholder","Enter item/service barcode ID"),type:"text",value:e.item.code},on:{input:function(t){e.item.code=t.target.value,e.enableSave()}}})],1):e._e()],1)}function Sa(){var i=this,t=i.$createElement,a=i._self._c||t;return a("f7-page",{staticClass:"invoicing-page",attrs:{id:"invoicing__item-details","data-name":"invoicing__item-details"}},[a("f7-navbar",[a("tommy-nav-back"),i._v(" "),a("f7-nav-title",[i._v(i._s(i.pageTitle))]),i._v(" "),a("f7-nav-right",[i.showSave?a("f7-link",{attrs:{"icon-f7":"check"},on:{click:i.save}}):i._e()],1)],1),i._v(" "),i.item?a("f7-list",{staticClass:"list-custom"},[a("f7-list-input",{attrs:{label:i.$t("invoicing.item.name_label","Name"),placeholder:i.$t("invoicing.item.name_placeholder","Enter item/service name"),type:"text",value:i.item.name},on:{input:function(t){i.item.name=t.target.value,i.enableSave()}}}),i._v(" "),a("f7-list-item",{attrs:{title:i.$t("invoicing.item.enabled_label","Enabled")}},[a("f7-toggle",{attrs:{checked:i.item.active},on:{change:function(t){i.item.active=t.target.checked,i.enableSave()}}})],1),i._v(" "),a("f7-list-item",{attrs:{divider:"",title:i.$t("invoicing.item.description_label","Description")}}),i._v(" "),a("f7-list-input",{attrs:{placeholder:i.$t("invoicing.item.description_placeholder","Enter item/service description"),type:"textarea",resizable:"",value:i.item.description},on:{input:function(t){i.item.description=t.target.value,i.enableSave()}}}),i._v(" "),a("f7-list-item",{attrs:{divider:"",title:i.$t("invoicing.item.duration_label","Duration")}}),i._v(" "),a("f7-list-input",{attrs:{placeholder:i.$t("invoicing.item.duration_placeholder","Item duration in minutes"),type:"number",value:i.item.data.duration},on:{input:i.onDurationChange}}),i._v(" "),a("f7-list-item",{attrs:{divider:"",title:i.$t("invoicing.item.category_label","Cagegory")}}),i._v(" "),a("f7-list-input",{attrs:{placeholder:i.$t("invoicing.item.category_placeholder","Enter item/service category"),type:"text",value:i.item.category},on:{input:function(t){i.item.category=t.target.value,i.enableSave()}}}),i._v(" "),a("f7-list-item",{attrs:{divider:"",title:i.$t("invoicing.item.available_in_label","Available in")}}),i._v(" "),a("f7-list-input",{attrs:{placeholder:i.$t("invoicing.item.available_in_placeholder","City where it is available"),type:"text",value:i.availabile_in},on:{input:function(t){return i.setAvailable(t.target.value)}}}),i._v(" "),a("f7-list-item",{attrs:{divider:"",title:i.$t("invoicing.item.photo_label","Photo")}}),i._v(" "),a("li",[a("div",{staticClass:"invoicing-product-photo-container"},[i.item.image_url||i.imagePreview?a("div",{staticClass:"invoicing-product-photo"},[a("img",{attrs:{src:i.item.image_url||i.imagePreview}}),i._v(" "),a("f7-link",{attrs:{"icon-f7":"close_round_fill"},on:{click:i.deleteImage}})],1):a("label",{staticClass:"invoicing-product-photo-add"},[a("input",{attrs:{type:"file"},on:{change:i.onFileChange}}),i._v(" "),a("f7-icon",{attrs:{f7:"add"}})],1)])]),i._v(" "),a("tag-select",{attrs:{slot:"after-list",data:{title:i.$t("invoicing.item.tags_label"),placeholder:i.$t("invoicing.common.search_members_tags","Search Members, Tags"),pageTitle:i.$t("invoicing.common.search_members_tags","Search Members, Tags"),tags:i.item.filters}},on:{tagAdd:i.addItemTag,tagRemove:i.removeItemTag},slot:"after-list"}),i._v(" "),a("f7-list-item",{attrs:{divider:"",title:i.$t("invoicing.package.items_label")}}),i._v(" "),i.products?a("li",{staticClass:"invoicing-order-items"},[a("div",{staticClass:"invoicing-order-add-box",on:{click:function(t){i.productsOpened=!0}}},[a("f7-icon",{attrs:{f7:"add"}}),i._v(" "),a("div",{staticClass:"invoicing-order-add-box-placeholder"},[i._v(i._s(i.$t("invoicing.package.add_item_label")))])],1),i._v(" "),i._l(i.item.vendor_package_products_attributes,function(t,e){return t._destroy?i._e():a("div",{key:e,staticClass:"invoicing-order-item"},[a("div",{staticClass:"invoicing-order-item-name"},[i._v(i._s(i.productName(t.vendor_product_id)))]),i._v(" "),a("div",{staticClass:"invoicing-order-item-selector"},[a("f7-link",{attrs:{"icon-f7":"delete_round"},on:{click:function(t){return i.decreaseProduct(e)}}}),i._v(" "),a("div",{staticClass:"invoicing-order-item-qty"},[i._v(i._s(t.quantity))]),i._v(" "),a("f7-link",{attrs:{"icon-f7":"add_round_fill"},on:{click:function(t){return i.increaseProduct(e)}}})],1)])})],2):i._e()],1):i._e(),i._v(" "),i.item?a("f7-list",{staticClass:"list-custom margin-top"},[a("f7-list-input",{attrs:{label:i.$t("invoicing.item.price_label","Price"),placeholder:i.$t("invoicing.item.price_placeholder","Enter item/service price"),type:"text",value:i.item.price},on:{input:function(t){return i.setPrice(t.target.value)}}}),i._v(" "),a("f7-list-input",{attrs:{label:i.$t("invoicing.item.barcode_label","Barcode ID"),placeholder:i.$t("invoicing.item.barcode_placeholder","Enter item/service barcode ID"),type:"text",value:i.item.code},on:{input:function(t){i.item.code=t.target.value,i.enableSave()}}})],1):i._e(),i._v(" "),i.products?a("f7-popup",{attrs:{opened:i.productsOpened},on:{"popup:closed":function(t){i.productsOpened=!1}}},[a("f7-view",{attrs:{init:!1}},[a("f7-page",{staticClass:"invoicing-page"},[a("f7-navbar",[a("f7-nav-right",[a("f7-link",{attrs:{"popup-close":"","icon-f7":"close"}})],1),i._v(" "),a("f7-nav-title",[i._v(i._s(i.$t("invoicing.package.add_item_label")))])],1),i._v(" "),a("f7-searchbar",{attrs:{"search-container":".invoicing-package-details-products","disable-button":!1}}),i._v(" "),a("f7-list",{staticClass:"list-custom invoicing-order-details-products invoicing-package-details-products"},i._l(i.products,function(e){return a("f7-list-item",{key:e.id,attrs:{link:"",title:e.name,after:"¥"+e.price},on:{click:function(t){return i.addProduct(e)}}})}),1)],1)],1)],1):i._e()],1)}function _a(){var e=this,t=e.$createElement,i=e._self._c||t;return i("f7-page",{staticClass:"invoicing-page",attrs:{name:"invoicing__range-select",id:"invoicing__range-select"}},[i("f7-navbar",[i("tommy-nav-back"),e._v(" "),i("f7-nav-title",[e._v(e._s(e.pageTitle))]),e._v(" "),i("f7-nav-right",[e.showSave?i("f7-link",{attrs:{"icon-f7":"check"},on:{click:e.save}}):e._e()],1)],1),e._v(" "),i("f7-list",{staticClass:"list-custom"},[i("f7-list-item",{attrs:{title:e.$t("invoicing.common.choose_range","Choose Range")}},[i("f7-toggle",{attrs:{slot:"after",checked:e.isCustomRange},on:{change:function(t){return e.toggleCustomRange(t.target.checked)}},slot:"after"})],1),e._v(" "),e.isCustomRange?i("f7-list-input",{attrs:{label:e.$t("invoicing.common.amount_min","From"),type:"number",value:e.amount_min},on:{input:function(t){return e.setMin(t.target.value)}}}):e._e(),e._v(" "),e.isCustomRange?i("f7-list-input",{attrs:{label:e.$t("invoicing.common.amount_max","To"),type:"number",value:e.amount_max},on:{input:function(t){return e.setMax(t.target.value)}}}):e._e()],1)],1)}function ib(){var i=this,t=i.$createElement,a=i._self._c||t;return a("f7-popup",{ref:"popup"},[a("f7-view",{attrs:{"ios-dynamic-navbar":!1}},[a("f7-page",{staticClass:"invoicing-page",attrs:{name:"invoicing__order-details",id:"invoicing__order-details"}},[a("f7-navbar",[a("f7-nav-left",[a("f7-link",{attrs:{"popup-close":"","icon-f7":"close"}})],1),i._v(" "),a("f7-nav-title",[i._v(i._s(i.pageTitle))]),i._v(" "),a("f7-nav-right",[i.showSave?a("f7-link",{attrs:{"icon-f7":"check"},on:{click:i.save}}):i._e()],1)],1),i._v(" "),i.order?[a("f7-list",{staticClass:"list-custom"},[i.order.created_at&&i.order.id?a("f7-list-item",{attrs:{title:i.$t("invoicing.order_details.created"),after:i.formatDate(i.order.created_at)}}):i._e(),i._v(" "),a("f7-list-item",{attrs:{title:i.$t("invoicing.order_details.due_date"),link:!0,after:i.formatOrderDate(i.order.data?parseInt(i.order.data.date,10):null)},on:{click:i.openDateSelect}}),i._v(" "),a("f7-list-item",{attrs:{title:i.$t("invoicing.order_details.due_time"),link:!0,after:i.formatOrderTime(i.order.data?parseInt(i.order.data.date,10):null)},on:{click:i.openTimeSelect}}),i._v(" "),i.order.data&&i.order.data.location?a("f7-list-input",{attrs:{label:i.$t("invoicing.order_details.city"),placeholder:i.$t("invoicing.order_details.city_placeholder"),type:"text",value:i.order.data.location.city},on:{input:i.onCityChange}}):i._e(),i._v(" "),i.order.data&&i.order.data.location?a("f7-list-input",{attrs:{label:i.$t("invoicing.order_details.address"),placeholder:i.$t("invoicing.order_details.address_placeholder"),type:"text",value:i.order.data.location.address},on:{input:i.onAddressChange}}):i._e(),i._v(" "),a("f7-list-item",{attrs:{title:i.$t("invoicing.order_details.status"),"smart-select":"","smart-select-params":{openIn:"popover",closeOnSelect:!0,routableModals:!1}}},[a("select",{on:{change:i.onStatusChange}},i._l(i.orderStatuses,function(t,e){return a("option",{key:e,domProps:{value:t,selected:i.order.status===t}},[i._v(i._s(i.$t("invoicing.order_status."+t)))])}),0)]),i._v(" "),a("f7-list-item",{attrs:{title:i.$t("invoicing.order_details.type"),"smart-select":"","smart-select-params":{openIn:"popover",closeOnSelect:!0,routableModals:!1}}},[a("select",{on:{change:i.onTypeChange}},[a("option",{attrs:{value:"invoice"},domProps:{selected:!i.order.quote}},[i._v(i._s(i.$t("invoicing.list_edit.type_invoice")))]),i._v(" "),a("option",{attrs:{value:"quote"},domProps:{selected:i.order.quote}},[i._v(i._s(i.$t("invoicing.list_edit.type_quote")))])])]),i._v(" "),a("f7-list-item",{attrs:{divider:"",title:i.$t("invoicing.order_details.comment")}}),i._v(" "),a("f7-list-input",{attrs:{type:"textarea",value:i.order.comment,placeholder:i.$t("invoicing.order_details.comment_placeholder"),resizable:""},on:{input:i.onCommentChange}}),i._v(" "),i.orderAssignee?[a("f7-list-item",{attrs:{divider:"",title:i.$t("invoicing.order_details.assignee")}}),i._v(" "),a("f7-list-item",{attrs:{title:i.orderAssignee?i.orderAssigneeName:"","smart-select":""}},[a("tommy-circle-avatar",{attrs:{slot:"media",data:i.orderAssignee},slot:"media"}),i._v(" "),a("select",{attrs:{name:"assignee"},on:{change:i.onAssigneeChange}},i._l(i.$root.teamMembers,function(t,e){return a("option",{key:"teamMember-"+e+"-"+t.id,attrs:{"data-option-class":"invoicing-smart-select-option","data-option-image":t.icon_url},domProps:{value:t.user_id,selected:i.order.user_id===t.user_id}},[i._v("\n                  "+i._s(t.first_name||"")+" "+i._s(t.last_name||""))])}),0),i._v(" "),a("f7-link",{staticStyle:{"margin-left":"80px",padding:"8px 0"},attrs:{slot:"root",href:"/team-member-details/?user_id="+i.order.assignee_id+"&name="+i.orderAssigneeName},slot:"root"},[a("span",[i._v(i._s(i.$t("invoicing.order_details.assignee_profile")))]),i._v(" "),a("f7-icon",{attrs:{f7:"chevron_right",size:16}})],1)],1)]:i._e(),i._v(" "),[a("f7-list-item",{attrs:{divider:"",title:i.$t("invoicing.order_details.customer")}}),i._v(" "),a("f7-list-item",{attrs:{title:i.orderUser?i.orderUserName:"","smart-select":""}},[a("tommy-circle-avatar",{attrs:{slot:"media",data:i.orderUser},slot:"media"}),i._v(" "),a("select",{attrs:{name:"customer"},on:{change:i.onCustomerChange}},[i._l(i.contacts,function(t,e){return a("option",{key:"contact-"+e+"-"+t.friend_id,attrs:{"data-option-class":"invoicing-smart-select-option","data-option-image":t.icon_url},domProps:{value:t.friend_id,selected:i.order.user_id===t.friend_id}},[i._v("\n                  "+i._s(t.first_name||"")+" "+i._s(t.last_name||""))])}),i._v(" "),i._l(i.$root.teamMembers,function(t,e){return a("option",{key:"teamMember-"+e+"-"+t.id,attrs:{"data-option-class":"invoicing-smart-select-option","data-option-image":t.icon_url},domProps:{value:t.user_id,selected:i.order.user_id===t.user_id}},[i._v("\n                  "+i._s(t.first_name||"")+" "+i._s(t.last_name||""))])})],2),i._v(" "),a("f7-link",{staticStyle:{"margin-left":"80px",padding:"8px 0"},attrs:{slot:"root",href:"/contact-details/?user_id="+i.order.assignee_id},slot:"root"},[a("span",[i._v(i._s(i.$t("invoicing.order_details.customer_profile")))]),i._v(" "),a("f7-icon",{attrs:{f7:"chevron_right",size:16}})],1)],1)],i._v(" "),a("f7-list-item",{attrs:{divider:"",title:i.$t("invoicing.order_details.items")}}),i._v(" "),i.products&&i.packages?a("li",{staticClass:"invoicing-order-items"},[a("div",{staticClass:"invoicing-order-add-box",on:{click:function(t){i.productsOpened=!0}}},[a("f7-icon",{attrs:{f7:"add"}}),i._v(" "),a("div",{staticClass:"invoicing-order-add-box-placeholder"},[i._v(i._s(i.$t("invoicing.order_details.add_item_label")))])],1),i._v(" "),i._l(i.order.vendor_order_items,function(t,e){return t._destroy?i._e():a("div",{key:t.orderable_id+"-"+e,staticClass:"invoicing-order-item"},[a("div",{staticClass:"invoicing-order-item-name"},[i._v(i._s(i.productName(t.orderable_id,t.orderable_type))+"\n              ")]),i._v(" "),a("div",{staticClass:"invoicing-order-item-details"},[a("div",{staticClass:"invoicing-order-item-price"},[i._v(i._s(i.productPrice(t.orderable_id,t.orderable_type))+"\n                ")]),i._v(" "),a("div",{staticClass:"invoicing-order-item-selector"},[a("f7-link",{attrs:{"icon-f7":"delete_round"},on:{click:function(t){return i.decreaseOrderItem(e)}}}),i._v(" "),a("div",{staticClass:"invoicing-order-item-qty"},[i._v(i._s(t.quantity))]),i._v(" "),a("f7-link",{attrs:{"icon-f7":"add_round_fill"},on:{click:function(t){return i.increaseOrderItem(e)}}})],1)])])}),i._v(" "),i.orderItemsTotal?a("div",{staticClass:"invoicing-order-total"},[a("div",{staticClass:"invoicing-order-total-row"},[a("div",{staticClass:"invoicing-order-total-label"},[i._v(i._s(i.$t("invoicing.order_details.total")))]),i._v(" "),a("div",{staticClass:"invoicing-order-total-value"},[i._v(i._s(i.orderItemsTotal))])])]):i._e()],2):i._e(),i._v(" "),a("f7-list-item",{attrs:{divider:"",title:i.$t("invoicing.order_details.promotions")}}),i._v(" "),i.promotions?a("li",{staticClass:"invoicing-order-items"},[a("div",{staticClass:"invoicing-order-add-box",on:{click:function(t){i.promotionsOpened=!0}}},[a("f7-icon",{attrs:{f7:"add"}}),i._v(" "),a("div",{staticClass:"invoicing-order-add-box-placeholder"},[i._v(i._s(i.$t("invoicing.order_details.add_promotion_label"))+"\n              ")])],1),i._v(" "),i.order.vendor_coupon_id?a("div",{staticClass:"invoicing-order-item"},[a("div",{staticClass:"invoicing-order-item-name"},[i._v(i._s(i.promotionName(i.order.vendor_coupon_id)))]),i._v(" "),a("div",{staticClass:"invoicing-order-item-details"},[a("div",{staticClass:"invoicing-order-item-price"},[i._v("-"+i._s(i.promotionDiscount(i.order.vendor_coupon_id)))]),i._v(" "),a("div",{staticClass:"invoicing-order-item-selector"},[a("f7-link",{attrs:{"icon-f7":"delete_round"},on:{click:function(t){return i.deleteOrderPromotion()}}})],1)])]):i._e(),i._v(" "),i.orderDiscountTotal?a("div",{staticClass:"invoicing-order-total"},[a("div",{staticClass:"invoicing-order-total-row"},[a("div",{staticClass:"invoicing-order-total-label"},[i._v(i._s(i.$t("invoicing.order_details.total")))]),i._v(" "),a("div",{staticClass:"invoicing-order-total-value"},[i._v("-"+i._s(i.orderDiscountTotal))])])]):i._e()]):i._e(),i._v(" "),a("f7-list-item",{attrs:{divider:"",title:i.$t("invoicing.order_details.payment")}}),i._v(" "),i.products&&i.packages&&i.promotions?a("li",{staticClass:"invoicing-order-items"},[a("div",{staticClass:"invoicing-order-total"},[i.orderItemsTotal?a("div",{staticClass:"invoicing-order-total-row"},[a("div",{staticClass:"invoicing-order-total-label"},[i._v(i._s(i.$t("invoicing.order_details.items")))]),i._v(" "),a("div",{staticClass:"invoicing-order-total-value"},[i._v(i._s(i.orderItemsTotal))])]):i._e(),i._v(" "),i.orderDiscountTotal?a("div",{staticClass:"invoicing-order-total-row"},[a("div",{staticClass:"invoicing-order-total-label"},[i._v(i._s(i.$t("invoicing.order_details.promotions")))]),i._v(" "),a("div",{staticClass:"invoicing-order-total-value"},[i._v("-"+i._s(i.orderDiscountTotal))])]):i._e(),i._v(" "),i.order.data.payment_method?a("div",{staticClass:"invoicing-order-total-row"},[a("div",{staticClass:"invoicing-order-total-label"},[i._v(i._s(i.$t("invoicing.order_details.via_label")))]),i._v(" "),a("div",{staticClass:"invoicing-order-total-value"},[i._v("\n                  "+i._s(i.$t("invoicing.order_details.via_"+i.order.data.payment_method)))])]):i._e(),i._v(" "),a("div",{staticClass:"invoicing-order-total-row invoicing-order-final-row"},[a("div",{staticClass:"invoicing-order-total-label"},[i._v(i._s(i.$t("invoicing.order_details.total")))]),i._v(" "),a("div",{staticClass:"invoicing-order-total-value"},[i._v(i._s(i.orderTotal))])])])]):i._e(),i._v(" "),i.order&&i.order.data.feedback&&i.products&&i.packages?[a("f7-list-item",{attrs:{divider:"",title:i.$t("invoicing.order_feedback_results.time_clocking")}}),i._v(" "),a("f7-list-item",{attrs:{title:i.$t("invoicing.order_feedback_results.scheduled"),after:i.calcOrderDuration()}}),i._v(" "),a("f7-list-item",{attrs:{title:i.$t("invoicing.order_feedback_results.start"),after:i.$moment(parseInt(i.order.data.date,10)).format("H:mm DD MMM YYYY")}}),i._v(" "),a("f7-list-item",{attrs:{title:i.$t("invoicing.order_feedback_results.finish"),after:i.$moment(parseInt(i.order.data.date,10)+60*i.calcOrderDuration()*1e3).format("H:mm DD MMM YYYY")}}),i._v(" "),i.order.data.feedback.start_date&&i.order.data.feedback.end_date?[a("f7-list-item",{attrs:{divider:"",title:i.$t("invoicing.order_feedback_results.time_change")}}),i._v(" "),a("f7-list-item",{attrs:{title:i.$t("invoicing.order_feedback_results.start"),after:i.$moment(i.order.data.feedback.start_date).format("H:mm DD MMM YYYY")}}),i._v(" "),a("f7-list-item",{attrs:{title:i.$t("invoicing.order_feedback_results.finish"),after:i.$moment(i.order.data.feedback.end_date).format("H:mm DD MMM YYYY")}})]:i._e(),i._v(" "),i.order.data.feedback.actual_start_date&&i.order.data.feedback.actual_end_date?[a("f7-list-item",{attrs:{divider:"",title:i.$t("invoicing.order_feedback_results.actual_time")}}),i._v(" "),a("f7-list-item",{attrs:{title:i.$t("invoicing.order_feedback_results.start"),after:i.$moment(i.order.data.feedback.actual_start_date).format("H:mm DD MMM YYYY")}}),i._v(" "),a("f7-list-item",{attrs:{title:i.$t("invoicing.order_feedback_results.finish"),after:i.$moment(i.order.data.feedback.actual_end_date).format("H:mm DD MMM YYYY")}})]:i._e(),i._v(" "),a("f7-list-item",{attrs:{divider:"",title:i.$t("invoicing.order_feedback_results.feedback")}}),i._v(" "),a("f7-list-item",{attrs:{title:i.$t("invoicing.order_feedback_results.question_1"),after:i.$t("invoicing.order_feedback_results."+i.order.data.feedback.question1)}}),i._v(" "),a("f7-list-item",{attrs:{title:i.$t("invoicing.order_feedback_results.question_2"),after:i.$t("invoicing.order_feedback_results."+i.order.data.feedback.question2)}}),i._v(" "),a("f7-list-item",{attrs:{title:i.$t("invoicing.order_feedback_results.question_3"),after:i.$t("invoicing.order_feedback_results."+i.order.data.feedback.question3)}})]:i._e()],2),i._v(" "),i.orderCancelable?a("f7-list",{staticClass:"margin-top margin-bottom"},[a("f7-list-button",{staticClass:"color-custom",attrs:{color:"custom"},on:{click:i.cancelOrder}},[i._v("\n            "+i._s(i.$t("invoicing.order_details.cancel_button","Cancel Order")))])],1):i._e(),i._v(" "),i.products&&i.packages?a("f7-popup",{attrs:{opened:i.productsOpened},on:{"popup:closed":function(t){i.productsOpened=!1}}},[a("f7-view",{attrs:{init:!1}},[a("f7-page",{staticClass:"invoicing-page"},[a("f7-navbar",[a("f7-nav-right",[a("f7-link",{attrs:{"icon-f7":"close"},on:{click:function(t){i.productsOpened=!1}}})],1),i._v(" "),a("f7-nav-title",[i._v(i._s(i.$t("invoicing.order_details.add_item_label")))])],1),i._v(" "),a("f7-searchbar",{attrs:{"search-container":".invoicing-order-details-items","disable-button":!1}}),i._v(" "),a("f7-list",{staticClass:"list-custom invoicing-order-details-products invoicing-order-details-items"},[a("f7-list-item",{attrs:{divider:"",title:i.$t("invoicing.order_details.packages")}}),i._v(" "),i._l(i.packages,function(e){return a("f7-list-item",{key:"package-"+e.id,attrs:{link:"",title:e.name,after:"¥"+e.price},on:{click:function(t){return i.addOrderItem(e,"VendorPackage")}}})}),i._v(" "),a("f7-list-item",{attrs:{divider:"",title:i.$t("invoicing.order_details.items")}}),i._v(" "),i._l(i.products,function(e){return a("f7-list-item",{key:"product-"+e.id,attrs:{link:"",title:e.name,after:"¥"+e.price},on:{click:function(t){return i.addOrderItem(e,"VendorProduct")}}})})],2)],1)],1)],1):i._e(),i._v(" "),i.promotions?a("f7-popup",{attrs:{opened:i.promotionsOpened},on:{"popup:closed":function(t){i.promotionsOpened=!1}}},[a("f7-view",{attrs:{init:!1}},[a("f7-page",[a("f7-navbar",[a("f7-nav-right",[a("f7-link",{attrs:{"icon-f7":"close"},on:{click:function(t){i.promotionsOpened=!1}}})],1),i._v(" "),a("f7-nav-title",[i._v(i._s(i.$t("invoicing.order_details.add_promotion_label")))])],1),i._v(" "),a("f7-searchbar",{attrs:{"search-container":".invoicing-order-details-promotions","disable-button":!1}}),i._v(" "),a("f7-list",{staticClass:"list-custom invoicing-order-details-products invoicing-order-details-promotions"},i._l(i.promotions,function(e){return a("f7-list-item",{key:e.id,attrs:{link:"",title:e.name,after:"- ¥"+("percentage"!==e.kind?e.amount:e.amount*i.order.total)},on:{click:function(t){return i.addOrderPromotion(e)}}})}),1)],1)],1)],1):i._e()]:i._e()],2)],1)],1)}function rb(){var e=this,t=e.$createElement,i=e._self._c||t;return i("f7-page",{staticClass:"invoicing-feedback"},[i("f7-navbar",[e.saved?i("f7-nav-left",[i("f7-link",{attrs:{"icon-f7":"close"},on:{click:e.closeFeedback}})],1):e._e(),e._v(" "),e.saved||"step-1"===e.step||"step-4"===e.step?e._e():i("f7-nav-left",[i("f7-link",{attrs:{icon:"icon-back"},on:{click:e.stepBack}})],1),e._v(" "),i("f7-nav-title",[e._v(e._s(e.navTitle))])],1),e._v(" "),"step-1"===e.step?i("div",{staticClass:"invoicing-feedback-buttons",attrs:{slot:"fixed"},slot:"fixed"},[i("a",{staticClass:"invoicing-feedback-button-no",on:{click:function(t){return e.setStep("step-1-2")}}},[e._v(e._s(e.t("button_no")))]),e._v(" "),i("a",{staticClass:"invoicing-feedback-button-yes",on:{click:function(t){return e.setStep("step-2")}}},[e._v(e._s(e.t("button_yes")))])]):e._e(),e._v(" "),"step-1-2"===e.step?i("div",{staticClass:"invoicing-feedback-buttons",attrs:{slot:"fixed"},slot:"fixed"},[i("a",{staticClass:"invoicing-feedback-button-submit",on:{click:function(t){return e.setStep("step-2")}}},[e._v(e._s(e.t("button_submit")))])]):e._e(),e._v(" "),"step-2"===e.step?i("div",{staticClass:"invoicing-feedback-buttons",attrs:{slot:"fixed"},slot:"fixed"},[i("a",{staticClass:"invoicing-feedback-button-submit",on:{click:function(t){return e.setStep("step-3")}}},[e._v(e._s(e.t("button_start")))])]):e._e(),e._v(" "),"step-3"===e.step?i("div",{staticClass:"invoicing-feedback-buttons",attrs:{slot:"fixed"},slot:"fixed"},[i("a",{staticClass:"invoicing-feedback-button-submit",on:{click:function(t){return e.setStep("question-1")}}},[e._v(e._s(e.t("button_next")))])]):e._e(),e._v(" "),"question-1"===e.step?i("div",{staticClass:"invoicing-feedback-buttons",attrs:{slot:"fixed"},slot:"fixed"},[i("a",{staticClass:"invoicing-feedback-button-no",on:{click:function(t){return e.setStep("question-2","no")}}},[e._v(e._s(e.t("button_no")))]),e._v(" "),i("a",{staticClass:"invoicing-feedback-button-yes",on:{click:function(t){return e.setStep("question-2","yes")}}},[e._v(e._s(e.t("button_yes")))])]):e._e(),e._v(" "),"question-2"===e.step?i("div",{staticClass:"invoicing-feedback-buttons",attrs:{slot:"fixed"},slot:"fixed"},[i("a",{staticClass:"invoicing-feedback-button-no",on:{click:function(t){return e.setStep("question-3","no")}}},[e._v(e._s(e.t("button_no")))]),e._v(" "),i("a",{staticClass:"invoicing-feedback-button-yes",on:{click:function(t){return e.setStep("question-3","yes")}}},[e._v(e._s(e.t("button_yes")))])]):e._e(),e._v(" "),"question-3"===e.step?i("div",{staticClass:"invoicing-feedback-buttons",attrs:{slot:"fixed"},slot:"fixed"},[i("a",{staticClass:"invoicing-feedback-button-no",on:{click:function(t){return e.setStep("step-4","no")}}},[e._v(e._s(e.t("button_no")))]),e._v(" "),i("a",{staticClass:"invoicing-feedback-button-yes",on:{click:function(t){return e.setStep("step-4","yes")}}},[e._v(e._s(e.t("button_yes")))])]):e._e(),e._v(" "),"step-1"===e.step?[i("div",{staticClass:"invoicing-feedback-confirm-title"},[e._v(e._s(e.t("time_confirm_title")))]),e._v(" "),e.orderDuration?i("div",{staticClass:"invoicing-feedback-confirm-time"},[e._v(e._s(e.durationFormatted)+" "+e._s(e.t("hours")))]):e._e()]:e._e(),e._v(" "),"step-1-2"===e.step?[i("div",{staticClass:"invoicing-feedback-confirm-title"},[e._v(e._s(e.t("time_select_title")))]),e._v(" "),i("div",{staticClass:"invoicing-feedback-confirm-text",domProps:{innerHTML:e._s(e.t("time_select_text"))}}),e._v(" "),i("f7-list",[i("f7-list-input",{attrs:{label:e.t("time_select_start"),"inline-label":"",type:"text",inputId:"start_date"}}),e._v(" "),i("f7-list-input",{attrs:{label:e.t("time_select_end"),"inline-label":"",type:"text",inputId:"end_date"}})],1)]:e._e(),e._v(" "),"step-2"===e.step?[i("div",{staticClass:"invoicing-feedback-question-text",domProps:{innerHTML:e._s(e.t("feedback_start_text"))}})]:e._e(),e._v(" "),"step-3"===e.step?[i("div",{staticClass:"invoicing-feedback-question-text",domProps:{innerHTML:e._s(e.t("feedback_info_text"))}})]:e._e(),e._v(" "),"question-1"===e.step?[i("div",{staticClass:"invoicing-feedback-question-text",domProps:{innerHTML:e._s(e.t("feedback_question_1"))}})]:e._e(),e._v(" "),"question-2"===e.step?[i("div",{staticClass:"invoicing-feedback-question-text",domProps:{innerHTML:e._s(e.t("feedback_question_2"))}})]:e._e(),e._v(" "),"question-3"===e.step?[i("div",{staticClass:"invoicing-feedback-question-text",domProps:{innerHTML:e._s(e.t("feedback_question_3"))}})]:e._e(),e._v(" "),"step-4"===e.step?[i("div",{staticClass:"invoicing-feedback-end-image"},[i("img",{attrs:{src:e.$addonAssetsUrl+"/feedback-image.svg"}})]),e._v(" "),i("div",{staticClass:"invoicing-feedback-end-title"},[e._v(e._s(e.t("feedback_end_title")))]),e._v(" "),i("div",{staticClass:"invoicing-feedback-end-text",domProps:{innerHTML:e._s(e.t("feedback_end_text"))}})]:e._e()],2)}function Ab(){var i=this,t=i.$createElement,a=i._self._c||t;return a("f7-popup",{ref:"popup"},[a("f7-view",{attrs:{"ios-dynamic-navbar":!1}},[i.isFeedback?a("order-feedback",{attrs:{order:i.order,orderDuration:i.orderDuration},on:{feedbackComplete:i.onFeedbackComplete,close:i.onFeedbackClose}}):i._e(),i._v(" "),i.isFeedback?i._e():a("f7-page",{staticClass:"invoicing-page",attrs:{name:"invoicing__order-details",id:"invoicing__order-details"}},[a("f7-navbar",[a("f7-nav-left",[a("f7-link",{attrs:{"popup-close":"","icon-f7":"close"}})],1),i._v(" "),a("f7-nav-title",[i._v(i._s(i.pageTitle))]),i._v(" "),a("f7-nav-right",[i.showSave?a("f7-link",{attrs:{"icon-f7":"check"},on:{click:i.save}}):i._e()],1)],1),i._v(" "),i.order&&i.showStartButton?a("div",{staticClass:"invoicing-toolbar-button",attrs:{slot:"fixed"},on:{click:i.startOrder},slot:"fixed"},[i._v(i._s(i.$t("invoicing.order_details.start_button")))]):i._e(),i._v(" "),i.order&&i.showFinishButton?a("div",{staticClass:"invoicing-toolbar-button",attrs:{slot:"fixed"},on:{click:i.finishOrder},slot:"fixed"},[i._v(i._s(i.$t("invoicing.order_details.finish_button")))]):i._e(),i._v(" "),i.order?[a("f7-list",{staticClass:"list-custom"},[a("f7-list-item",{attrs:{title:i.$t("invoicing.order_details.due_date"),link:!1,after:i.formatOrderDate(i.order.data?parseInt(i.order.data.date,10):null)}}),i._v(" "),a("f7-list-item",{attrs:{title:i.$t("invoicing.order_details.due_time"),link:!1,after:i.formatOrderTime(i.order.data?parseInt(i.order.data.date,10):null)}}),i._v(" "),i.order.data&&i.order.data.location?a("f7-list-item",{attrs:{title:i.$t("invoicing.order_details.city"),type:"text",after:i.order.data.location.city}}):i._e(),i._v(" "),i.order.data&&i.order.data.location?a("f7-list-item",{attrs:{title:i.$t("invoicing.order_details.address"),type:"text",after:i.order.data.location.address}}):i._e(),i._v(" "),i.order.comment?a("f7-list-item",{attrs:{divider:"",title:i.$t("invoicing.order_details.comment")}}):i._e(),i._v(" "),i.order.comment?a("f7-list-input",{attrs:{type:"textarea",value:i.order.comment,placeholder:i.$t("invoicing.order_details.comment_placeholder"),resizable:"",readonly:!0}}):i._e(),i._v(" "),i.orderUser?[a("f7-list-item",{attrs:{divider:"",title:i.$t("invoicing.order_details.customer")}}),i._v(" "),a("f7-list-item",{attrs:{title:i.orderUserName,link:"/contact-details/?user_id="+i.order.user_id+"&masterDetailRoot=true",view:".view-main","reload-all":!0}},[a("tommy-circle-avatar",{attrs:{slot:"media",data:i.orderUser},slot:"media"})],1)]:i._e(),i._v(" "),a("f7-list-item",{attrs:{divider:"",title:i.$t("invoicing.order_details.items")}}),i._v(" "),i.products&&i.packages?a("li",{staticClass:"invoicing-order-items"},i._l(i.order.vendor_order_items,function(t,e){return t._destroy?i._e():a("div",{key:t.orderable_id+"-"+e,staticClass:"invoicing-order-item"},[a("div",{staticClass:"invoicing-order-item-name"},[i._v(i._s(i.productName(t.orderable_id,t.orderable_type)))])])}),0):i._e()],2)]:i._e()],2)],1)],1)}function Jb(){var t=this,e=t.$createElement,i=t._self._c||e;return i("f7-page",{staticClass:"invoicing-page",attrs:{name:"invoicing__promotion-management",id:"invoicing__promotion-management"}},[i("f7-navbar",[i("tommy-nav-back"),t._v(" "),i("f7-nav-title",[t._v(t._s(t.$t("invoicing.promotion_management.title","Promotions")))]),t._v(" "),i("f7-nav-right",[i("f7-link",{attrs:{href:"/invoicing/promotion-details/","icon-f7":"add"}})],1)],1),t._v(" "),t.items&&t.items.length?i("f7-searchbar",{attrs:{slot:"static","search-container":".invoicing-list-items",backdrop:!1,"disable-button":!1,placeholder:t.$t("invoicing.promotion_management.search_placeholder")},slot:"static"}):t._e(),t._v(" "),t.items&&t.items.length?i("f7-list",{staticClass:"list-custom invoicing-list-items",attrs:{slot:"static","no-hairlines":""},slot:"static"},t._l(t.orderedPromotions,function(t){return i("f7-list-item",{key:t.id,attrs:{title:t.name,link:"/invoicing/promotion-details/"+t.id+"/?title="+encodeURIComponent(t.name||"")}})}),1):t._e()],1)}function Sb(){var i=this,t=i.$createElement,a=i._self._c||t;return a("f7-page",{staticClass:"invoicing-page",attrs:{id:"invoicing__promotion-details","data-name":"invoicing__promotion-details"}},[a("f7-navbar",[a("tommy-nav-back"),i._v(" "),a("f7-nav-title",[i._v(i._s(i.pageTitle))]),i._v(" "),a("f7-nav-right",[i.showSave?a("f7-link",{attrs:{"icon-f7":"check"},on:{click:i.save}}):i._e()],1)],1),i._v(" "),i.item?a("f7-list",{staticClass:"list-custom"},[a("f7-list-input",{attrs:{label:i.$t("invoicing.promotion.name_label","Name"),placeholder:i.$t("invoicing.promotion.name_placeholder","Enter promotion name"),type:"text",value:i.item.name},on:{input:function(t){i.item.name=t.target.value,i.enableSave()}}}),i._v(" "),a("f7-list-item",{attrs:{divider:"",title:i.$t("invoicing.promotion.description_label","Description")}}),i._v(" "),a("f7-list-input",{attrs:{placeholder:i.$t("invoicing.promotion.description_placeholder","Enter promotion description"),type:"textarea",resizable:"",value:i.item.description},on:{input:function(t){i.item.description=t.target.value,i.enableSave()}}}),i._v(" "),a("f7-list-item",{attrs:{divider:"",title:i.$t("invoicing.promotion.expires_label","Description")}}),i._v(" "),a("f7-list-input",{staticClass:"invoicing-valid-to-input",attrs:{title:i.$t("invoicing.order_details.due_date"),type:"text",readonly:"",value:i.item.valid_to?i.$moment(i.item.valid_to).format("D MMM YYYY"):""},on:{focus:i.openCalendar}},[a("span",{staticClass:"input-clear-button margin-right",attrs:{slot:"inner"},on:{click:function(t){i.item.valid_to=null,i.enableSave()}},slot:"inner"})]),i._v(" "),a("f7-list-item",{attrs:{divider:"",title:i.$t("invoicing.promotion.type_label")}}),i._v(" "),a("f7-list-item",{attrs:{checkbox:"",title:i.$t("invoicing.promotion.type_voucher_label"),checked:"voucher"===i.item.kind},on:{change:function(t){return i.setKind("voucher")}}}),i._v(" "),a("f7-list-item",{attrs:{checkbox:"",title:i.$t("invoicing.promotion.type_fixed_label"),checked:"fixed"===i.item.kind},on:{change:function(t){return i.setKind("fixed")}}}),i._v(" "),a("f7-list-item",{attrs:{checkbox:"",title:i.$t("invoicing.promotion.type_percentage_label"),checked:"percentage"===i.item.kind},on:{change:function(t){return i.setKind("percentage")}}}),i._v(" "),a("f7-list-item",{attrs:{divider:"",title:i.$t("invoicing.promotion.amount_label","Discount amount")}}),i._v(" "),"fixed"===i.item.kind||"voucher"===i.item.kind?a("f7-list-input",{attrs:{placeholder:i.$t("invoicing.promotion.amount_placeholder","Enter promotion discount"),type:"text",value:i.item.amount?"¥"+i.item.amount:""},on:{input:function(t){return i.setAmount(t.target.value)}}}):i._e(),i._v(" "),"percentage"===i.item.kind?a("f7-list-item",[a("f7-range",{staticClass:"invoicing-range-slider",attrs:{value:i.item.amount,min:0,max:1,step:.01,"format-label":function(t){return Math.floor(100*t)+"%"},label:""},on:{"range:changed":function(t){return i.setAmount(t)}}}),i._v(" "),a("div",{staticClass:"invoicing-range-slider-value"},[i._v(i._s(Math.floor(100*i.item.amount))+"%")])],1):i._e(),i._v(" "),a("f7-list-item",{attrs:{divider:"",title:i.$t("invoicing.promotion.category_label","Category")}}),i._v(" "),a("f7-list-input",{attrs:{placeholder:i.$t("invoicing.promotion.category_label","Category"),type:"text",value:i.item.category},on:{input:function(t){i.item.category=t.target.value,i.enableSave()}}}),i._v(" "),a("f7-list-item",{attrs:{divider:"",title:i.$t("invoicing.promotion.max_uses_label")}}),i._v(" "),a("f7-list-input",{attrs:{placeholder:i.$t("invoicing.promotion.max_uses_placeholder"),type:"number",value:i.item.max_uses},on:{input:function(t){i.item.max_uses=t.target.value,i.enableSave()}}}),i._v(" "),i.contacts?[a("f7-list-item",{attrs:{divider:"",title:i.$t("invoicing.promotion.customer_label","Customer")}}),i._v(" "),a("f7-list-item",{attrs:{title:i.customerTitle,link:""},on:{click:function(t){i.customerPopupOpened=!0}}},[i.customerAvatar?a("tommy-circle-avatar",{attrs:{slot:"media",data:i.customerAvatar},slot:"media"}):i._e()],1)]:i._e(),i._v(" "),a("f7-list-item",{attrs:{divider:"",title:i.$t("invoicing.promotion.item_label","Item")}}),i._v(" "),i.products&&i.packages?a("f7-list-item",{attrs:{title:i.itemTitle,link:""},on:{click:function(t){i.itemsPopupOpened=!0}}},[i.itemAvatar?a("tommy-circle-avatar",{attrs:{slot:"media",url:i.itemAvatar},slot:"media"}):i._e()],1):i._e()],2):i._e(),i._v(" "),i.item?a("f7-popup",{attrs:{opened:i.customerPopupOpened},on:{"popup:closed":function(t){i.customerPopupOpened=!1}}},[a("f7-view",{attrs:{init:!1}},[a("f7-page",{staticClass:"invoicing-page"},[a("f7-navbar",[a("f7-nav-title",[i._v(i._s(i.$t("invoicing.promotion.customer_label")))]),i._v(" "),a("f7-nav-right",[a("f7-link",{attrs:{"popup-close":"","icon-f7":"close"}})],1)],1),i._v(" "),a("f7-searchbar",{attrs:{"search-container":".invoicing-promotion-customers-list"}}),i._v(" "),a("f7-list",{staticClass:"invoicing-promotion-customers-list"},[i._l(i.contacts,function(t,e){return a("f7-list-item",{key:"contact-"+e+"-"+t.friend_id,attrs:{title:(t.first_name||"")+" "+(t.last_name||""),radio:"",checked:i.item.user_id===t.friend_id},on:{click:function(){i.item.user_id=t.friend_id,i.customerPopupOpened=!1,i.enableSave()}}},[a("tommy-circle-avatar",{attrs:{slot:"media",data:t},slot:"media"})],1)}),i._v(" "),i._l(i.$root.teamMembers,function(t){return a("f7-list-item",{key:"user-"+i.index+"-"+t.id,attrs:{title:(t.first_name||"")+" "+(t.last_name||""),radio:"",checked:i.item.user_id===t.user_id},on:{click:function(){i.item.user_id=t.user_id,i.customerPopupOpened=!1,i.enableSave()}}},[a("tommy-circle-avatar",{attrs:{slot:"media",data:t},slot:"media"})],1)})],2)],1)],1)],1):i._e(),i._v(" "),i.item&&i.products&&i.packages?a("f7-popup",{attrs:{opened:i.itemsPopupOpened},on:{"popup:closed":function(t){i.itemsPopupOpened=!1}}},[a("f7-view",{attrs:{init:!1}},[a("f7-page",{staticClass:"invoicing-page"},[a("f7-navbar",[a("f7-nav-title",[i._v(i._s(i.$t("invoicing.promotion.item_label")))]),i._v(" "),a("f7-nav-right",[a("f7-link",{attrs:{"popup-close":"","icon-f7":"close"}})],1)],1),i._v(" "),a("f7-searchbar",{attrs:{"search-container":".invoicing-promotion-items-list","disable-button":!1}}),i._v(" "),a("f7-list",{staticClass:"invoicing-promotion-items-list"},[i.products.length?a("f7-list-item",{attrs:{divider:"",title:i.$t("invoicing.item_service_management.items_tab")}}):i._e(),i._v(" "),i._l(i.products,function(t){return a("f7-list-item",{key:t.id,attrs:{title:t.name,radio:"",checked:i.item.vendor_product_id===t.id},on:{click:function(){i.item.vendor_product_id=t.id,i.item.vendor_package_id=null,i.itemsPopupOpened=!1,i.enableSave()}}},[a("tommy-circle-avatar",{attrs:{slot:"media",url:t.image_url},slot:"media"})],1)}),i._v(" "),i.packages.length?a("f7-list-item",{attrs:{divider:"",title:i.$t("invoicing.item_service_management.packages_tab")}}):i._e(),i._v(" "),i._l(i.packages,function(t){return a("f7-list-item",{key:t.id,attrs:{title:t.name,radio:"",checked:i.item.vendor_package_id===t.id},on:{click:function(){i.item.vendor_product_id=null,i.item.vendor_package_id=t.id,i.itemsPopupOpened=!1,i.enableSave()}}},[a("tommy-circle-avatar",{attrs:{slot:"media",url:t.image_url},slot:"media"})],1)})],2)],1)],1)],1):i._e()],1)}var h={props:{data:Object},data:function data(){return{teamTags:null}},mounted:function mounted(){var e=this;e.$api.getCurrentTeamTags({cache:!1}).then(function(t){e.teamTags=t})},methods:{openSelector:function openSelector(){var i=this;i.$f7router.navigate("/invoicing/tag-select/",{props:{tags:i.data.tags,pageTitle:i.data.pageTitle,teamTags:i.teamTags,onChange:function onChange(t,e){e?i.$emit("tagAdd",t):i.$emit("tagRemove",t)}}})},removeTag:function removeTag(t){this.$emit("tagRemove",t)}}},b=(_._withStripped=!0,t({render:_,staticRenderFns:[function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"item-media"},[e("i",{staticClass:"material-icons md-36"},[this._v("search")])])}]},void 0,h,void 0,!(_._withStripped=!0),void 0,void 0,void 0)),k={components:{tagSelect:b},props:{listId:[String,Number]},data:function data(){return{showSave:!1,id:parseInt(this.listId,10),orderStatuses:f,list:null,permissions:[],contacts:n.contacts}},beforeDestroy:function beforeDestroy(){this.$events.$off("invoicing:setListDateRange",this.updateListDateRange)},mounted:function mounted(){var i=this;n.loadList(i.id).then(function(e){e.data||(e.data={}),e.data.status||(e.data.status=[]),e.data.customer||(e.data.customer=[]),e.data.assignee||(e.data.assignee=[]),i.list=e,i.$api.getInstalledAddonPermission("invoicing","order_list_read_access",{taggable_id:e.id,with_filters:!0}).then(function(t){t.taggable_id=e.id,i.permissions.push(t)}),i.$api.getInstalledAddonPermission("invoicing","order_list_edit_access",{taggable_id:e.id,with_filters:!0}).then(function(t){t.taggable_id=e.id,i.permissions.push(t)}),n.contacts||i.$api.getContacts().then(function(t){i.contacts=t,n.contacts=t})}),i.$events.$on("invoicing:setListDateRange",i.updateListDateRange)},methods:{formatDateRange:function formatDateRange(t){return t?"string"==typeof t?window.tommy.i18n.t("invoicing.date_range."+t):Array.isArray(t)?formatDate(t[0])+" - "+formatDate(t[1]):t||"":""},updateListDateRange:function updateListDateRange(t,e){this.list.id===t&&(this.list.data.date_range=e)},onNameChange:function onNameChange(t){this.saving||(this.list.name=t,this.showSave=!0)},onSortChange:function onSortChange(t){this.saving||(this.list.data.sort=this.$$(t.target).val(),this.showSave=!0)},onStatusChange:function onStatusChange(t){this.saving||(this.list.data.status=this.$$(t.target).val(),this.showSave=!0)},onTypeChange:function onTypeChange(t){this.saving||(this.list.data.type=t.target.value,this.showSave=!0)},onCustomerChange:function onCustomerChange(t){this.saving||(this.list.data.customer=this.$$(t.target).val().map(function(t){return parseInt(t,10)}),this.showSave=!0)},onAssigneeChange:function onAssigneeChange(t){this.saving||(this.list.data.assignee=this.$$(t.target).val().map(function(t){return parseInt(t,10)}),this.showSave=!0)},setOnlyAssigned:function setOnlyAssigned(t){this.list.data.only_assigned=t,this.showSave=!0,t&&(this.list.data.assignee=[])},showDateRange:function showDateRange(){this.$f7router.navigate("/invoicing/list-edit/date-range/",{props:{list:this.list}})},showBalanceRange:function showBalanceRange(){var a=this,t=a.list.data,e=t.balance_min,i=t.balance_max;a.$f7router.navigate("/invoicing/range-select/",{props:{pageTitle:a.$t("invoicing.list_edit.balance_range"),from:e?parseFloat(e):e,to:i?parseFloat(i):i,onSave:function onSave(t){var e=t.from,i=t.to;a.list.data.balance_min=e,a.list.data.balance_max=i,a.list=a.list,n.saveList(a.list).then(function(){a.$f7router.back()})}}})},showPaymentRange:function showPaymentRange(){var a=this,t=a.list.data,e=t.price_min,i=t.price_max;a.$f7router.navigate("/invoicing/range-select/",{props:{pageTitle:a.$t("invoicing.list_edit.payment_range"),from:e?parseFloat(e):e,to:i?parseFloat(i):i,onSave:function onSave(t){var e=t.from,i=t.to;a.list.data.price_min=e,a.list.data.price_max=i,a.list=a.list,n.saveList(a.list).then(function(){a.$f7router.back()})}}})},save:function save(){var t=this;t.saving||(t.saving=!0,t.showSave=!1,n.saveList(t.list).then(function(){t.$events.$emit("invoicing:reloadLists",t.listId),t.$f7router.back()}))},deleteList:function deleteList(){var t=this;t.saving||(t.saving=!0,t.showSave=!1,n.deleteList(t.list.id,t.list).then(function(){t.$events.$emit("invoicing:reloadLists",t.listId),t.$f7router.back()}))},saveListPermission:function saveListPermission(t){this.$api.updateInstalledAddonPermission("invoicing",t.name,{taggable_id:t.taggable_id,with_filters:!0,filters:JSON.stringify(t.filters)})},addListPermission:function addListPermission(t,e){t.filters.push(e),this.saveListPermission(t)},removeListPermission:function removeListPermission(t,e){t.filters.splice(t.filters.indexOf(e),1),this.saveListPermission(t)}}},$=(ia._withStripped=!0,t({render:ia,staticRenderFns:[]},void 0,k,void 0,!(ia._withStripped=!0),void 0,void 0,void 0)),C={props:{list:Object},data:function data(){var t=this.list.data.date_range;return{showSave:!1,dateFrom:Array.isArray(t)&&t[0]?t[0]:(new Date).getTime(),dateTo:Array.isArray(t)&&t[1]?t[1]:(new Date).getTime(),range:t}},computed:{isCustomRange:function isCustomRange(){var t=this.range;return Array.isArray(t)||!(!t||"string"==typeof t)}},mounted:function mounted(){var i=this,a=!1,n=!1;i.calendarFrom=i.$f7.calendar.create({inputEl:i.$$(i.$refs.rangeStart.$el).find("input"),closeOnSelect:!0,value:[i.dateFrom],on:{change:function change(t,e){a&&(i.showSave=!0),a=!0,i.dateFrom=new Date(e[0]).getTime(),Array.isArray(i.range)&&i.range[0]&&(i.range[0]=i.dateFrom),i.dateFrom>i.dateTo&&i.calendarTo.setValue([i.dateFrom])}}}),i.calendarTo=i.$f7.calendar.create({inputEl:i.$$(i.$refs.rangeEnd.$el).find("input"),closeOnSelect:!0,value:[i.dateTo],on:{change:function change(t,e){n&&(i.showSave=!0),n=!0,i.dateTo=new Date(e[0]).getTime(),Array.isArray(i.range)&&i.range[1]&&(i.range[1]=i.dateTo),i.dateTo<i.dateFrom&&i.calendarFrom.setValue([i.dateTo])}}})},methods:{setPlainRange:function setPlainRange(t){this.range=t,this.showSave=!0},toggleCustomRange:function toggleCustomRange(t){var e=this;e.showSave=!0,e.range=t?[e.dateFrom,e.dateTo]:""},save:function save(){var t=this;if(!t.saving){t.saving=!0,t.showSave=!1;var e=Object.assign({},t.list);e.data.date_range=t.range,n.saveList(e).then(function(){t.$events.$emit("invoicing:setListDateRange",t.list.id,t.range),t.$f7router.back()})}}}},y=(ra._withStripped=!0,t({render:ra,staticRenderFns:[]},void 0,C,void 0,!(ra._withStripped=!0),void 0,void 0,void 0)),S={props:{listId:[String,Number],pageTitle:String,tags:Array,teamTags:Array,onChange:Function},data:function data(){return{query:null}},computed:{allTags:function allTags(){var t=this,a=[];return t.tags.forEach(function(e){var i;t.teamTags.forEach(function(t){i=i||e.context===t.context&&e.name===t.name&&e.label===t.label}),i||a.push(e)}),t.teamTags.concat(a)}},methods:{onSearch:function onSearch(t,e){this.query=e},isTagSelected:function isTagSelected(e){return 0<this.tags.filter(function(t){return t.name===e.name&&t.id===e.id&&t.type===e.type}).length},contextIconSrc:function contextIconSrc(t){return this.$addonAssetsUrl+"icons/"+t.context.slice(0,-1)+".png"},contextIconSrcset:function contextIconSrcset(t){var e=this.$addonAssetsUrl;return e+"icons/"+t.context.slice(0,-1)+"@2x.png 2x,"+e+"icons/"+t.context.slice(0,-1)+"@3x.png 3x"},toggleTag:function toggleTag(t,e,i){this.onChange&&(this.onChange(t,e),i&&this.$f7router.back())}}},w=(Aa._withStripped=!0,t({render:Aa,staticRenderFns:[]},void 0,S,void 0,!(Aa._withStripped=!0),void 0,void 0,void 0)),P={components:{tagSelect:b},props:{id:[String,Number]},data:function data(){return{pageTitle:this.$f7route.query.title||this.$t("invoicing.product.new_title"),item:null,showSave:!1,imagePreview:null,availabile_in:""}},mounted:function mounted(){var e=this;e.id?n.loadProduct(e.id).then(function(t){t.data&&"string"!=typeof t.data||(t.data={duration:null,availabile_in:[]}),e.availabile_in=(t.data.availabile_in||[]).join(","),"string"==typeof t.filters&&(t.filters=JSON.parse(decodeURIComponent(t.filters))),t.filters||(t.filters=[]),e.item=t}):e.item={active:!1,category:"",code:"",data:{duration:null,availabile_in:[]},filters:[],description:"",name:"",price:0}},methods:{setAvailable:function setAvailable(t){this.availabile_in=t,this.item.data.availabile_in=t.split(",").map(function(t){return t.trim()}).filter(function(t){return t}),this.enableSave()},setPrice:function setPrice(t){var e=this;e.item.price=t,e.item.price_cents=100*parseFloat(e.item.price),Number.isNaN(e.item.price_cents)&&(e.item.price_cents=0),e.enableSave()},enableSave:function enableSave(){this.item.name?this.showSave=!0:this.showSave=!1},addItemTag:function addItemTag(t){this.item.filters.push(t),this.enableSave()},removeItemTag:function removeItemTag(t){this.item.filters.splice(this.item.filters.indexOf(t),1),this.enableSave()},onDurationChange:function onDurationChange(t){this.item.data.duration=t.target.value,this.enableSave()},onFileChange:function onFileChange(t){var e=this,i=t.target.files[0],a=new FileReader;a.onload=function(t){e.imagePreview=t.target.result},a.readAsDataURL(i),e.item.image=i,e.enableSave()},deleteImage:function deleteImage(){this.item.image=null,this.item.image_url=null,this.imagePreview=null,this.enableSave()},save:function save(){var t=this;t.showSave=!1,n.saveProduct(t.item).then(function(){t.$events.$emit("invoicing:reloadProducts"),t.$f7router.back()})}}},T=(Ja._withStripped=!0,t({render:Ja,staticRenderFns:[]},void 0,P,void 0,!(Ja._withStripped=!0),void 0,void 0,void 0)),O={components:{tagSelect:b},props:{id:[String,Number]},data:function data(){return{pageTitle:this.$f7route.query.title||this.$t("invoicing.package.new_title"),item:null,showSave:!1,imagePreview:null,products:null,productsOpened:!1,availabile_in:"",data:{duration:null}}},mounted:function mounted(){var e=this;n.loadProducts().then(function(t){e.products=t}),e.id?n.loadPackage(e.id).then(function(t){t.vendor_package_products_attributes||(t.vendor_package_products_attributes=[]),t.vendor_package_products&&(t.vendor_package_products_attributes=t.vendor_package_products.map(function(t){return{id:t.id,vendor_product_id:t.vendor_product_id,quantity:t.quantity,vendor_package_id:t.vendor_package_id}}),delete t.vendor_package_products),t.data&&"string"!=typeof t.data||(t.data={availabile_in:[],duration:null}),e.availabile_in=(t.data.availabile_in||[]).join(","),"string"==typeof t.filters&&(t.filters=JSON.parse(decodeURIComponent(t.filters))),t.filters||(t.filters=[]),e.item=t}):e.item={active:!1,category:"",code:"",filters:[],description:"",name:"",price:0,vendor_package_products_attributes:[],data:{availabile_in:[],duration:null}}},methods:{setAvailable:function setAvailable(t){this.availabile_in=t,this.item.data.availabile_in=t.split(",").map(function(t){return t.trim()}).filter(function(t){return t}),this.enableSave()},productName:function productName(e){return this.products.filter(function(t){return t.id===parseInt(e,10)})[0].name},increaseProduct:function increaseProduct(t){this.item.vendor_package_products_attributes[t].quantity+=1,this.enableSave()},decreaseProduct:function decreaseProduct(t){var e=this;e.item.vendor_package_products_attributes[t].quantity-=1,0===e.item.vendor_package_products_attributes[t].quantity&&(e.item.vendor_package_products_attributes[t].id?e.item.vendor_package_products_attributes[t]._destroy=!0:e.item.vendor_package_products_attributes.splice(t,1)),e.enableSave()},addProduct:function addProduct(e){var i;this.productsOpened=!1,this.item.vendor_package_products_attributes.forEach(function(t){t.vendor_product_id===e.id&&(i=!0)}),i||(this.item.vendor_package_products_attributes.push({vendor_product_id:e.id,quantity:1}),this.showSave=!0)},setPrice:function setPrice(t){var e=this;e.item.price=t,e.item.price_cents=100*parseFloat(e.item.price),Number.isNaN(e.item.price_cents)&&(e.item.price_cents=0),e.enableSave()},enableSave:function enableSave(){this.item.name?this.showSave=!0:this.showSave=!1},addItemTag:function addItemTag(t){this.item.filters.push(t),this.enableSave()},removeItemTag:function removeItemTag(t){this.item.filters.splice(this.item.filters.indexOf(t),1),this.enableSave()},onDurationChange:function onDurationChange(t){this.item.data.duration=t.target.value,this.enableSave()},onFileChange:function onFileChange(t){var e=this,i=t.target.files[0],a=new FileReader;a.onload=function(t){e.imagePreview=t.target.result},a.readAsDataURL(i),e.item.image=i,e.enableSave()},deleteImage:function deleteImage(){this.item.image=null,this.item.image_url=null,this.imagePreview=null,this.enableSave()},save:function save(){var t=this;t.showSave=!1,n.saveProduct(t.item,!0).then(function(){t.$events.$emit("invoicing:reloadPackages"),t.$f7router.back()})}}},x=(Sa._withStripped=!0,t({render:Sa,staticRenderFns:[]},void 0,O,void 0,!(Sa._withStripped=!0),void 0,void 0,void 0)),D={props:{from:Number,to:Number,pageTitle:String,onSave:Function},data:function data(){var t=this.from,e=this.to;return{showSave:!1,amount_min:t,amount_max:e,isCustomRange:void 0!==t||void 0!==e}},methods:{save:function save(){var t=this;if(!t.saving){t.saving=!0,t.showSave=!1;var e,i,a=t.amount_min,n=t.amount_max;t.isCustomRange?(e=(e=a)||void 0,i=(i=n)||void 0,a&&n&&n<a&&(i=a)):i=e=void 0,t.onSave({from:e,to:i})}},setMin:function setMin(t){this.amount_min=t,this.showSave=!0},setMax:function setMax(t){this.amount_max=t,this.showSave=!0},toggleCustomRange:function toggleCustomRange(t){var e=this;e.showSave=!0,t?(e.isCustomRange=!0,e.amount_min=e.from,e.amount_max=e.to):(e.isCustomRange=!1,e.amount_min=void 0,e.amount_max=void 0)}}},L=(_a._withStripped=!0,t({render:_a,staticRenderFns:[]},void 0,D,void 0,!(_a._withStripped=!0),void 0,void 0,void 0)),M={props:{id:[Number,String]},data:function data(){return{pageTitle:this.id?this.$t("invoicing.order_details.title","Order")+" #"+this.id:this.$t("invoicing.order_details.new_title"),order:null,showSave:!1,orderStatuses:f,products:null,packages:null,productsOpened:!1,promotions:null,promotionsOpened:!1,isFeedback:!1,orderUser:null,orderAssignee:null,contacts:n.contacts}},mounted:function mounted(){var a=this;a.id?n.loadOrder(a.id).then(function(e){a.order=e;var i=a.$root.teamMembers.filter(function(t){return t.user_id===parseInt(e.user_id,10)})[0],t=a.$root.teamMembers.filter(function(t){return t.user_id===parseInt(e.assignee_id,10)})[0];if(a.orderAssignee=t,!i)return a.contacts?(i=a.contacts.filter(function(t){return t.friend_id===parseInt(e.user_id,10)})[0],void(a.orderUser=i)):void a.$api.getContacts.then(function(t){a.contacts=t,i=a.contacts.filter(function(t){return t.friend_id===parseInt(e.user_id,10)})[0],a.orderUser=i});a.orderUser=i}):a.order={comment:"",discount:0,total:0,user_id:null,vendor_coupon_id:null,vendor_order_items:[],wallet_transaction_id:null,status:"pending",canceled:!1,data:{location:{address:"",city:""},date:(new Date).getTime()}},n.loadProducts().then(function(t){a.products=t}),n.loadPackages().then(function(t){a.packages=t}),n.loadPromotions().then(function(t){a.promotions=t})},beforeDestroy:function beforeDestroy(){var t=this;t.dateCalendar&&t.dateCalendar.destroy&&t.dateCalendar.destroy(),t.timePicker&&t.timePicker.destroy&&t.timePicker.destroy()},computed:{orderAssigneeName:function orderAssigneeName(){var t=this.orderAssignee;return t?t.friend_team_name?t.friend_team_name.trim():t.name?t.name.trim():t.first_name?(t.first_name+(t.last_name?" "+t.last_name:"")).trim():"":""},orderUserName:function orderUserName(){var t=this.orderUser;return t?t.friend_team_name?t.friend_team_name.trim():t.name?t.name.trim():t.first_name?(t.first_name+(t.last_name?" "+t.last_name:"")).trim():"":""},orderItemsTotal:function orderItemsTotal(){var e=this,i=0;return e.order.vendor_order_items.forEach(function(t){i+=e.productPrice(t.orderable_id,t.orderable_type)*t.quantity}),i},orderDiscountTotal:function orderDiscountTotal(){var e=this,t=0;if(e.order.vendor_coupon_id){var i=e.promotions.filter(function(t){return t.id===e.order.vendor_coupon_id})[0];i&&(t="percentage"!==i.kind?i.amount:e.orderItemsTotal*i.amount)}return t},orderTotal:function orderTotal(){return Math.max(this.orderItemsTotal-this.orderDiscountTotal,0)},orderCancelable:function orderCancelable(){var t=this.order;return!t.canceled&&("paid"===t.status||"pending"===t.status)}},methods:{cancelOrder:function cancelOrder(){var e=this;e.order.canceled=!0,n.cancelOrder(e.order).then(function(t){e.order=t,e.order.canceled=!0,e.$events.$emit("invoicing:reloadListsOrders")}).catch(function(){e.order.canceled=!1})},calcOrderDuration:function calcOrderDuration(){var e=this,i=0;return e.order&&e.products&&e.packages&&e.order.vendor_order_items.forEach(function(t){i+=e.productDuration(t.orderable_id,t.orderable_type)*t.quantity}),i},onAssigneeChange:function onAssigneeChange(t){var e=parseInt(t.target.value,10),i=this.$root.teamMembers.filter(function(t){return t.user_id===parseInt(e,10)})[0];this.order.assignee_id=i.user_id,this.order.data.nurse=i,this.showSave=!0},onCustomerChange:function onCustomerChange(t){var e=this,i=parseInt(t.target.value,10),a=e.$root.teamMembers.filter(function(t){return t.user_id===parseInt(i,10)})[0];!a&&e.contacts&&(a=e.contacts.filter(function(t){return t.friend_id===parseInt(i,10)})[0]),e.orderUser=a,e.order.user_id=parseInt(t.target.value,10),e.showSave=!0},onCommentChange:function onCommentChange(t){this.order.comment=t.target.value,this.showSave=!0},onCityChange:function onCityChange(t){var e=this;e.order.data||(e.order.data={}),e.order.data.location||(e.order.data.location={}),e.order.data.location.city=t.target.value,e.showSave=!0},onAddressChange:function onAddressChange(t){var e=this;e.order.data||(e.order.data={}),e.order.data.location||(e.order.data.location={}),e.order.data.location.address=t.target.value,e.showSave=!0},openTimeSelect:function openTimeSelect(){var a=this,t=a.order;if(a.timePicker)a.timePicker.open();else{var n,e=a.formatOrderTime(t.data?parseInt(t.data.date,10):null);a.timePicker=a.$f7.picker.create({value:e?e.split(":"):[],cols:[{values:"00 01 02 03 04 05 06 07 08 09 10 11 12 13 14 15 16 17 18 19 20 21 22 23".split(" ")},{divider:!0,content:" : "},{values:function(){for(var t=[],e=0;e<=59;e+=1)t.push(e<10?"0"+e:""+e);return t}()}],on:{change:function change(t,e){if(n){var i=new Date(parseInt(a.order.data.date,10));i.setHours(parseInt(e[0],10),parseInt(e[1],10)),a.order.data.date=i.getTime(),a.showSave=!0}else n=!0}}}),a.timePicker.open()}},openDateSelect:function openDateSelect(){var n,r=this;r.dateCalendar?r.dateCalendar.open():(r.dateCalendar=r.$f7.calendar.create({value:r.order.data.date?[parseInt(r.order.data.date,10)]:[],on:{change:function change(t,e){if(n){var i=new Date(parseInt(r.order.data.date,10)),a=new Date(e[0]);i.setFullYear(a.getFullYear()),i.setMonth(a.getMonth()),i.setDate(a.getDate()),r.order.data.date=i.getTime(),r.showSave=!0}else n=!0}}}),r.dateCalendar.open())},promotionName:function promotionName(e){return this.promotions.filter(function(t){return t.id===parseInt(e,10)})[0].name},promotionDiscount:function promotionDiscount(e){var t=this.promotions.filter(function(t){return t.id===parseInt(e,10)})[0];return t?"percentage"!==t.kind?t.amount:this.orderItemsTotal*t.amount:0},productName:function productName(e,t){void 0===t&&(t="VendorProduct");var i=this["VendorProduct"===t?"products":"packages"].filter(function(t){return t.id===parseInt(e,10)})[0];return i?i.name:""},productPrice:function productPrice(e,t){void 0===t&&(t="VendorProduct");var i=this["VendorProduct"===t?"products":"packages"].filter(function(t){return t.id===parseInt(e,10)})[0];return i?i.price:0},productDuration:function productDuration(e,t){void 0===t&&(t="VendorProduct");var i=this["VendorProduct"===t?"products":"packages"].filter(function(t){return t.id===parseInt(e,10)})[0];return i?parseInt(i.data.duration,10):0},formatOrderDate:function formatOrderDate(t){return t?this.$moment(new Date(parseInt(t,10))).format("D MMM YYYY"):""},formatOrderTime:function formatOrderTime(t){return t?this.$moment(new Date(parseInt(t,10))).format("HH:mm"):""},formatDate:function formatDate(t){return this.$moment(new Date(t)).format("HH:mm D MMM YYYY")},onStatusChange:function onStatusChange(t){var e=this,i=e.order.status;e.order.status=t.target.value,"paid"!==i&&"paid"===e.order.status&&(e.orderChangedToPaid=!0),e.showSave=!0},onTypeChange:function onTypeChange(t){"quote"===t.target.value?this.order.quote=!0:this.order.quote=!1,this.showSave=!0},increaseOrderItem:function increaseOrderItem(t){this.order.vendor_order_items[t].quantity+=1,this.showSave=!0},decreaseOrderItem:function decreaseOrderItem(t){var e=this;e.order.vendor_order_items[t].quantity-=1,0===e.order.vendor_order_items[t].quantity&&(e.order.vendor_order_items[t].id?e.order.vendor_order_items[t]._destroy=!0:e.order.vendor_order_items.splice(t,1)),e.showSave=!0},addOrderItem:function addOrderItem(e,t){var i,a=this;a.productsOpened=!1,a.order.vendor_order_items.forEach(function(t){t.orderable_id===e.id&&(i=!0,t._destroy&&(t._destroy=!1,delete t._destroy,t.quantity=1,a.showSave=!0))}),i||(a.order.vendor_order_items.push({orderable_id:e.id,orderable_type:t,quantity:1}),a.showSave=!0)},addOrderPromotion:function addOrderPromotion(t){this.promotionsOpened=!1,this.order.vendor_coupon_id=t.id,this.showSave=!0},deleteOrderPromotion:function deleteOrderPromotion(){this.order.vendor_coupon_id=null,this.showSave=!0},save:function save(){var e=this,t=Object.assign({},e.order);if(e.showSave=!1,!t.name&&t.vendor_order_items.length&&(t.name=e.productName(t.vendor_order_items[0].orderable_id,t.vendor_order_items[0].orderable_type)),t.vendor_order_items_attributes=[].concat(t.vendor_order_items),t.total=e.orderItemsTotal,t.discount=e.orderDiscountTotal,delete t.vendor_order_items,e.orderChangedToPaid&&!t.event_id&&t.data.date&&t.data.nurse&&t.data.location&&t.id&&t.user_id){var i,a=t.data.date;"string"==typeof a&&(a=parseInt(a,10)),t.data.duration&&0<t.data.duration&&(i=a+60*parseInt(t.data.duration,10)*1e3),t.event_attributes={addon:"nurse_booking",title:t.name,start_at:new Date(a).toJSON(),end_at:new Date(i).toJSON(),location:t.data.location.city+" "+t.data.location.address,user_id:t.user_id,team_id:null,assignee_id:t.data.nurse.user_id,assignee_team_id:e.$root.team.id,kind:"Booking",resource_id:t.id,resource_type:"VendorOrder"}}n.saveOrder(t).then(function(t){e.order=t,e.$events.$emit("invoicing:reloadListsOrders")})}}},A=(ib._withStripped=!0,t({render:ib,staticRenderFns:[]},void 0,M,void 0,!(ib._withStripped=!0),void 0,void 0,void 0)),N={props:{order:Object,orderDuration:Number},data:function data(){return{navTitle:this.t("confirm_title"),step:"step-1",q1:null,q2:null,q3:null,saved:!1,start_date:null,end_date:null}},computed:{durationFormatted:function durationFormatted(){return Math.floor(this.orderDuration/60*10)/10}},mounted:function mounted(){this.$f7.navbar.size(this.$el.querySelector(".navbar"))},methods:{t:function t(e,i){return this.$t("invoicing.order_feedback."+e,i)},stepBack:function stepBack(){var t=this,e=t.step;"step-1-2"===e&&(t.start_date=null,t.end_date=null,t.step="step-1"),"step-2"===e&&t.start_date?(t.step="step-1-2",t.$nextTick(function(){t.initTimePickers()})):"step-2"===e&&(t.step="step-1"),"step-3"===e&&(t.step="step-2"),"question-1"===e&&(t.step="step-3"),"question-2"===e&&(t.step="question-1"),"question-3"===e&&(t.step="question-2")},setStep:function setStep(t,e){var i=this;"step-1-2"===t&&(i.step=t,i.$nextTick(function(){i.initTimePickers()})),"step-2"===t&&(i.step=t),"step-3"===t&&(i.step=t),"question-1"===t&&(i.step=t),"question-2"===t&&(i.step=t,i.q1=e),"question-3"===t&&(i.step=t,i.q2=e),"step-4"===t&&(i.step=t,i.q3=e,i.saveFeedback())},initTimePickers:function initTimePickers(){for(var a=this,t=new Date(parseInt(a.order.data.date,10)),e=t.getTime()-864e6,i=[],n=0;n<21;n+=1)i.push(e+24*n*60*60*1e3);for(var r=[],o=0;o<24;o+=1)r.push(o<10?"0"+o:o);for(var s=[],d=0;d<60;d+=1)s.push(d<10?"0"+d:d);var c=t.getHours();c<10&&(c="0"+c);var l=t.getMinutes();l<10&&(l="0"+l),a.$f7.picker.create({inputEl:a.$el.querySelector("#start_date"),openIn:"popover",value:[t.getTime(),c,l],cols:[{values:i,displayValues:i.map(function(t){return a.$moment(t).format("ddd, DD MMM")})},{values:r},{divider:!0,content:":"},{values:s}],formatValue:function formatValue(t,e){return e[0]+" "+e[1]+":"+e[2]},on:{change:function change(t,e){var i=new Date(parseInt(e[0],10));i.setHours(parseInt(e[1],10),parseInt(e[2],10),0,0),a.start_date=i}}});var u=new Date(t.getTime()+60*a.orderDuration*1e3),v=u.getHours();v<10&&(v="0"+v);var m=u.getMinutes();m<10&&(m="0"+m),a.$f7.picker.create({inputEl:a.$el.querySelector("#end_date"),openIn:"popover",value:[t.getTime(),v,m],cols:[{values:i,displayValues:i.map(function(t){return a.$moment(t).format("ddd, DD MMM")})},{values:r},{divider:!0,content:":"},{values:s}],formatValue:function formatValue(t,e){return e[0]+" "+e[1]+":"+e[2]},on:{change:function change(t,e){var i=new Date(parseInt(e[0],10));i.setHours(parseInt(e[1],10),parseInt(e[2],10),0,0),a.end_date=i}}})},saveFeedback:function saveFeedback(){var t=this;t.$emit("feedbackComplete",{feedback:{question1:t.q1,question2:t.q2,question3:t.q2,start_date:t.start_date?t.start_date.toJSON():null,end_date:t.end_date?t.end_date.toJSON():null},callback:function callback(){t.saved=!0}})},closeFeedback:function closeFeedback(){this.$emit("close")}}},q=(rb._withStripped=!0,{components:{OrderFeedback:t({render:rb,staticRenderFns:[]},void 0,N,void 0,!(rb._withStripped=!0),void 0,void 0,void 0)},props:{id:[Number,String]},data:function data(){return{pageTitle:this.id?this.$t("invoicing.order_details.title","Order")+" #"+this.id:this.$t("invoicing.order_details.new_title"),order:null,showSave:!1,orderStatuses:f,products:null,packages:null,isFeedback:!1,orderDuration:0,orderUser:null}},mounted:function mounted(){var i=this;Promise.all([n.loadOrder(i.id).then(function(e){i.order=e;var t=i.$root.teamMembers.filter(function(t){return t.user_id===parseInt(e.user_id,10)})[0];t?i.orderUser=t:i.$api.getContact(e.user_id).then(function(t){i.orderUser=t})}),n.loadProducts().then(function(t){i.products=t}),n.loadPackages().then(function(t){i.packages=t})]).then(function(){i.orderDuration=i.calcOrderDuration()})},computed:{orderUserName:function orderUserName(){var t=this.orderUser;return t?t.friend_team_name?t.friend_team_name.trim():t.name?t.name.trim():t.first_name?(t.first_name+(t.last_name?" "+t.last_name:"")).trim():"":""},showStartButton:function showStartButton(){if("paid"!==this.order.status)return!1;var t=(new Date(parseInt(this.order.data.date,10)).getTime()-(new Date).getTime())/1e3/60;return Math.abs(t)<=60},showFinishButton:function showFinishButton(){return"processing"===this.order.status},orderItemsTotal:function orderItemsTotal(){var e=this,i=0;return e.order.vendor_order_items.forEach(function(t){i+=e.productPrice(t.orderable_id,t.orderable_type)*t.quantity}),i}},methods:{calcOrderDuration:function calcOrderDuration(){var e=this,i=0;return e.order&&e.products&&e.packages&&e.order.vendor_order_items.forEach(function(t){i+=e.productDuration(t.orderable_id,t.orderable_type)*t.quantity}),i},productName:function productName(e,t){void 0===t&&(t="VendorProduct");var i=this["VendorProduct"===t?"products":"packages"].filter(function(t){return t.id===parseInt(e,10)})[0];return i?i.name:""},productPrice:function productPrice(e,t){void 0===t&&(t="VendorProduct");var i=this["VendorProduct"===t?"products":"packages"].filter(function(t){return t.id===parseInt(e,10)})[0];return i?i.price:0},productDuration:function productDuration(e,t){void 0===t&&(t="VendorProduct");var i=this["VendorProduct"===t?"products":"packages"].filter(function(t){return t.id===parseInt(e,10)})[0];return i?parseInt(i.data.duration,10):0},formatOrderDate:function formatOrderDate(t){return t?this.$moment(new Date(parseInt(t,10))).format("D MMM YYYY"):""},formatOrderTime:function formatOrderTime(t){return t?this.$moment(new Date(parseInt(t,10))).format("HH:mm"):""},formatDate:function formatDate(t){return this.$moment(new Date(t)).format("HH:mm D MMM YYYY")},startOrder:function startOrder(){var e=this,t=Object.assign({},e.order);t.status="processing",t.data.feedback||(t.data.feedback={}),t.data.feedback.actual_start_date=(new Date).toJSON(),n.saveOrder(t).then(function(t){e.order=t,e.$events.$emit("invoicing:reloadListsOrders")})},finishOrder:function finishOrder(){this.$refs.popup.f7Popup.params.closeByBackdropClick=!1,this.isFeedback=!0},onFeedbackComplete:function onFeedbackComplete(e){var i=this,t=e.feedback,a=Object.assign({},i.order);a.status="qa",a.data.feedback?Object.assign(a.data.feedback,t):a.data.feedback=t,a.data.feedback.actual_end_date=(new Date).toJSON(),delete a.vendor_order_items,n.saveOrder(a).then(function(t){i.order=t,i.$events.$emit("invoicing:reloadListsOrders"),e.callback&&e.callback()})},onFeedbackClose:function onFeedbackClose(){this.isFeedback=!1,this.$refs.popup.f7Popup.close()}}}),F=(Ab._withStripped=!0,t({render:Ab,staticRenderFns:[]},void 0,q,void 0,!(Ab._withStripped=!0),void 0,void 0,void 0)),E={data:function data(){return{items:null,packages:null,activeTab:"items"}},mounted:function mounted(){this.loadPromotions(),this.$events.$on("invoicing:reloadPromotions",this.loadPromotions)},beforeDestroy:function beforeDestroy(){this.$events.$off("invoicing:reloadPromotions",this.loadPromotions)},computed:{orderedPromotions:function orderedPromotions(){return this.items?this.items.sort(function(t,e){return t.id-e.id}):[]}},methods:{loadPromotions:function loadPromotions(){var e=this;n.loadPromotions({},{cache:!1}).then(function(t){e.items=t})}}},Y=(Jb._withStripped=!0,t({render:Jb,staticRenderFns:[]},void 0,E,void 0,!(Jb._withStripped=!0),void 0,void 0,void 0)),U={components:{tagSelect:b},props:{id:[String,Number]},data:function data(){return{pageTitle:this.$f7route.query.title||this.$t("invoicing.promotion.new_title"),item:null,showSave:!1,customerPopupOpened:!1,itemsPopupOpened:!1,products:null,packages:null,contacts:n.contacts}},mounted:function mounted(){var a=this;a.id?n.loadPromotion(a.id).then(function(t){a.item=t}):a.item={description:"",name:"",amount:0,user_id:null,vendor_product_id:null,vendor_package_id:null,category:null,kind:"fixed",valid_from:null,valid_to:null,max_uses:null},a.contacts?Promise.all([n.loadProducts(),n.loadPackages()]).then(function(t){var e=t[0],i=t[1];a.products=e,a.packages=i}):a.$api.getContacts.then(function(t){a.contacts=t,n.contacts=t})},computed:{customerAvatar:function customerAvatar(){var t,e=this;return e.item.user_id?(e.$root.teamMembers&&(t=e.$root.teamMembers.filter(function(t){return t.user_id===e.item.user_id})[0]),!t&&e.contacts&&(t=e.contacts.filter(function(t){return t.friend_id===e.item.user_id})[0]),t||null):null},customerTitle:function customerTitle(){var t,e=this;return e.item.user_id?(e.$root.teamMembers&&(t=e.$root.teamMembers.filter(function(t){return t.user_id===e.item.user_id})[0]),!t&&e.contacts&&(t=e.contacts.filter(function(t){return t.friend_id===e.item.user_id})[0]),t?(t.first_name||"")+" "+(t.last_name||""):""):e.$t("invoicing.promotion.customer_placeholder")},itemAvatar:function itemAvatar(){var t,e=this;return e.item.vendor_product_id||e.item.vendor_package_id?(e.item.vendor_product_id&&(t=e.products.filter(function(t){return t.id===e.item.vendor_product_id})[0]),e.item.vendor_package_id&&(t=e.packages.filter(function(t){return t.id===e.item.vendor_package_id})[0]),t?t.image_url:null):null},itemTitle:function itemTitle(){var t,e=this;return e.item.vendor_product_id||e.item.vendor_package_id?(e.item.vendor_product_id&&(t=e.products.filter(function(t){return t.id===e.item.vendor_product_id})[0]),e.item.vendor_package_id&&(t=e.packages.filter(function(t){return t.id===e.item.vendor_package_id})[0]),t?t.name:""):e.$t("invoicing.promotion.item_placeholder")}},methods:{openCalendar:function openCalendar(){var i=this;i.calendarTo=i.$f7.calendar.create({openIn:"customModal",value:i.item.valid_to?[new Date(i.item.valid_to)]:[],backdrop:!0,closeByOutsideClick:!1,on:{change:function change(t,e){i.item.valid_to=new Date(e[0]).toJSON(),i.enableSave()}}}),i.calendarTo.once("closed",function(){i.calendarTo.destroy()}),i.calendarTo.open()},formatValueDate:function formatValueDate(t){return t?this.$moment(new Date(t)).format("YYYY-MM-DDTHH:mm"):""},onDateChange:function onDateChange(t){var e=t.target.value;clearTimeout(this.dateChangeTimeout),this.item.valid_to=new Date(e).toJSON(),this.enableSave()},setKind:function setKind(t){var e=this,i=e.item.kind;e.item.kind!==t&&("fixed"!==t&&"voucher"!==t||"percentage"!==i?"percentage"===t&&e.setAmount(.5):e.setAmount(0),e.item.kind=t,e.enableSave())},setAmount:function setAmount(t){var e=t;e="string"==typeof e?t.replace(/[¥ ]*/,"").replace(/,/g,".").trim():1<=e?1:(e=Math.floor(1e3*e/10))<10?parseFloat("0.0"+e):parseFloat("0."+e),this.item.amount=e,this.$set(this.item,"amount",e),this.enableSave()},enableSave:function enableSave(){this.showSave=!0},save:function save(){var t=this;t.showSave=!1,"string"==typeof t.item.amount&&(t.item.amount=parseFloat(t.item.amount),Number.isNaN(t.item.amount)&&(t.item.amount=0)),t.item.vendor_product_id&&(t.item.vendor_package_id=null),t.item.vendor_package_id&&(t.item.vendor_product_id=null),n.savePromotion(t.item).then(function(){t.$events.$emit("invoicing:reloadPromotions"),t.$f7router.back()})}}};Sb._withStripped=!0;return[{path:"/invoicing/",component:i},{path:"/invoicing/settings/",component:s},{path:"/invoicing/item-service-management/",component:c},{path:"/invoicing/list-management/",component:u},{path:"/invoicing/promotion-management/",component:Y},{path:"/invoicing/list-add/",component:m},{path:"/invoicing/list-edit/date-range/",component:y},{path:"/invoicing/list-edit/:listId/",component:$},{path:"/invoicing/tag-select/",component:w},{path:"/invoicing/product-details/:id?/",component:T},{path:"/invoicing/package-details/:id?/",component:x},{path:"/invoicing/range-select/",component:L},{path:"/invoicing/order-details/:id?/",popup:{async:function async(t,e,i){i({component:n.isNurse?F:A})}}},{path:"/invoicing/promotion-details/:id?/",component:t({render:Sb,staticRenderFns:[]},void 0,U,void 0,!(Sb._withStripped=!0),void 0,void 0,void 0)}]}();