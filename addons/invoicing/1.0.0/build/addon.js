var addon=function(){var s=window.tommy.api,n={actor:void 0,actorId:void 0,loadListOrders:function loadListOrders(t,i){if(t.data&&t.filters)for(var e=0;e<t.filters.length;e+=1)i.indexOf(t.filters[e].name)<0&&i.push(t.filters[e].name);var a={addon:"tasks",kind:"Task",tags:i,with_filters:!0,with_permission_to:!0,actor_id:n.actorId};return t.data.date_range&&(a.date_range=t.data.date_range),t.data.statuses&&(a.status=t.data.statuses),a.data=JSON.stringify(a.data),s.getFragments(a)},getTask:function getTask(t){return s.getFragment(t,{data:{with_filters:!0}})},saveTask:function saveTask(t){if(t.addon="tasks",t.kind="Task",t.with_filters=!0,t.with_permission_to=!0,t.start_at||(t.start_at=(new Date).getTime()),!t.id){t.with_permissions=["task_create_access","task_edit_access"];var i=n.actor;i&&(t.filters||(t.filters=[]),t.filters.push({context:"members",name:i.first_name+" "+i.last_name,user_id:i.user_id}))}var e=Object.assign({},t,{data:JSON.stringify(t.data)});return t.id?s.updateFragment(t.id,e):s.createFragment(e)},loadList:function loadList(t){return s.getFragment(t,{data:{addon:"invoicing",kind:"OrderList",with_filters:!0,with_permission_to:!0}})},loadLists:function loadLists(t,i){return void 0===t&&(t={}),void 0===i&&(i={}),s.getFragments(Object.assign({addon:"invoicing",kind:"OrderList",with_filters:!0,with_permission_to:!0,actor_id:n.actorId,user_id:n.actorId},t),i)},deleteList:function deleteList(t){return s.deleteFragment(t)},saveList:function saveList(t){t.addon="invoicing",t.kind="OrderList",t.with_filters=!0,t.with_permission_to=!0,t.data||(t.data={}),void 0===t.data.position&&(t.data.position=0),void 0===t.data.active&&(t.data.active=!0),t.id||(t.with_permissions=["invoicing_order_list_read_access","invoicing_order_list_edit_access"]);var i=Object.assign({},t,{data:JSON.stringify(t.data),filters:JSON.stringify(t.filters)});return t.id?s.updateFragment(t.id,i):s.createFragment(i)},loadItems:function loadItems(t,i){return void 0===t&&(t={}),void 0===i&&(i={}),s.getFragments(Object.assign({addon:"invoicing",kind:"InvoicingItem",with_filters:!0,with_permission_to:!0,actor_id:n.actorId,user_id:n.actorId},t),i)},loadPackages:function loadPackages(t,i){return void 0===t&&(t={}),void 0===i&&(i={}),s.getFragments(Object.assign({addon:"invoicing",kind:"InvoicingPackage",with_filters:!0,with_permission_to:!0,actor_id:n.actorId,user_id:n.actorId},t),i)}};return[{path:"/invoicing/",component:{render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("f7-page",{staticClass:"invoicing-page",attrs:{id:"invoicing__index",name:"invoicing__index"}},[a("f7-navbar",[a("tommy-nav-menu"),e._v(" "),a("f7-nav-title",[e._v(e._s(e.pageTitle))]),e._v(" "),a("f7-nav-right",[a("f7-link",{attrs:{href:"/invoicing/settings/","icon-f7":"gear"}})],1)],1),e._v(" "),e.orderedLists&&e.orderedLists.length?a("f7-swiper",{attrs:{params:{slidesPerView:"auto",breakpointsInverse:!0,centeredSlides:!1,breakpoints:{768:{centeredSlides:!0}}}}},e._l(e.orderedLists,function(t){return a("f7-swiper-slide",{key:t.id},[a("div",{staticClass:"orders-list",class:{hasScroll:e.listWithScroll[t.id]},attrs:{"data-id":t.id}},[a("div",{staticClass:"orders-list-header"},[a("div",[e._v(e._s(t.name))]),e._v(" "),e.canEditList(t)?a("div",[a("a",{attrs:{href:"/invoicing/list-edit/"+t.id+"/"}},[a("img",{attrs:{src:e.$addonAssetsUrl+"slice6.png",srcset:e.$addonAssetsUrl+"slice6@2x.png 2x, "+e.$addonAssetsUrl+"slice6@3x.png 3x"}})])]):e._e()]),e._v(" "),a("div",{staticClass:"orders-list-content"},[t.orders&&t.orders.length?e._l(t.orders,function(t,i){return a("a",{key:i,staticClass:"card order-card",attrs:{href:"/invoicing/order-details/"+t.id+"/"}},[a("div",{staticClass:"card-content card-content-padding"}),e._v(" "),a("div",{staticClass:"card-footer no-border color-gray"})])}):e._e()],2)])])})):e._e()],1)},staticRenderFns:[],data:function data(){return{lists:null,actorId:this.$f7route.query.actor_id,listWithScroll:{}}},created:function created(){var t=this;t.actorId?(n.actorId=parseInt(t.actorId,10),n.actor=t.actor):(delete n.actorId,delete n.actor)},computed:{actor:function actor(){var i=this;return i.actorId?i.$root.teamMembers.filter(function(t){return t.user_id===parseInt(i.actorId,10)})[0]:null},pageTitle:function pageTitle(){var i=this;if(!i.actorId)return i.$t("invoicing.index.title","Orders");var t=i.$root.teamMembers.filter(function(t){return t.user_id===parseInt(i.actorId,10)})[0].first_name;return i.$t("invoicing.index.title_user",{user:t})},orderedLists:function orderedLists(){return this.lists?this.lists.sort(function(t,i){return t.data.position-i.data.position}).filter(function(t){return t.data.active}):null}},methods:{humanTime:function humanTime(t){var i=window.tommy.moment,e=i.utc(t).toDate();if(i(e).isValid()){var a=i().diff(i(e),"days");if(1===a)return"Yesterday "+i(e).format("h:mm A");if(0===a)return"Today "+i(e).format("h:mm A");if(-1===a)return"Yesterday "+i(e).format("h:mm A");if(1<=a&&a<=8||-8<=a&&a<=-1)return i(e).format("ddd h:mm A");if(365<=a||a<=-365)return i(e).format("MMM D, YYYY h:mm A");if(8<=a||a<=-8)return i(e).format("MMM D h:mm A")}return"None"},listHasScroll:function listHasScroll(t){if(!t.orders||0===t.orders.length)return!1;var i=this.$$('.orders-list[data-id="'+t.id+'"] .orders-list-content')[0];return!!i&&i.scrollHeight>i.offsetHeight},loadListOrders:function loadListOrders(i){var e=this,t=e.actor||e.$root.user;n.loadListOrders(i,[t.first_name+" "+t.last_name]).then(function(t){i.orders=t,e.$nextTick(function(){e.listHasScroll(i)?e.$set(e.listWithScroll,i.id,!0):e.$set(e.listWithScroll,i.id,!1)})})},reloadListsOrders:function reloadListsOrders(){var i=this;i.lists&&i.lists.forEach(function(t){i.loadListOrders(t)})},loadLists:function loadLists(t){var i=this;n.loadLists({},{cache:!t}).then(function(t){t.forEach(function(t){t.orders=[]}),i.lists=t,i.lists.forEach(function(t){t.data.active&&i.loadListOrders(t)})})},reloadLists:function reloadLists(){this.loadLists(!0)},canEditList:function canEditList(t){var i=this.$root.account,e="Team"===i.type||"TeamMember"===i.type;return!(t.data.default&&!e)&&-1!==t.permission_to.indexOf("update")}},beforeDestroy:function beforeDestroy(){this.$events.$off("invoicing:reloadListsOrders",this.reloadListsOrders),this.$events.$off("invoicing:reloadLists",this.reloadLists)},mounted:function mounted(){var t=this;t.loadLists(),t.$events.$on("invoicing:reloadListsOrders",t.reloadListsOrders),t.$events.$on("invoicing:reloadLists",t.reloadLists)}}},{path:"/invoicing/settings/",component:{render:function(){var t=this,i=t.$createElement,e=t._self._c||i;return e("f7-page",{staticClass:"invoicing-page",attrs:{id:"invoicing__settings","data-name":"invoicing__settings"}},[e("f7-navbar",[e("tommy-nav-back"),t._v(" "),e("f7-nav-title",[t._v(t._s(t.$t("invoicing.settings.title","Settings")))])],1),t._v(" "),e("f7-list",{staticClass:"list-custom"},[t.hasActorId?t._e():e("f7-list-item",{attrs:{link:"/invoicing/list-management/",title:t.$t("invoicing.settings.list_management","List Management")}}),t._v(" "),e("f7-list-item",{attrs:{link:"/invoicing/item-service-management/",title:t.$t("invoicing.settings.item_service_management","Item/Service Management")}}),t._v(" "),e("f7-list-item",{attrs:{link:"/invoicing/promotion-management/",title:t.$t("invoicing.settings.promotion_management","Promotion Management")}})],1)],1)},staticRenderFns:[]}},{path:"/invoicing/item-service-management/",component:{render:function(){var i=this,t=i.$createElement,e=i._self._c||t;return e("f7-page",{staticClass:"invoicing-page",attrs:{name:"invoicing__item-service-management",id:"invoicing__item-service-management"}},[e("f7-navbar",[e("tommy-nav-back"),i._v(" "),e("f7-nav-title",[i._v(i._s(i.$t("invoicing.item_service_management.title","Items / Service")))]),i._v(" "),e("f7-nav-right",[e("f7-link",{attrs:{"icon-f7":"add"},on:{click:i.add}})],1)],1),i._v(" "),e("div",{staticClass:"item-service-tabs-links"},[e("f7-link",{class:{active:"items"===i.activeTab},on:{click:function(t){i.activeTab="items"}}},[i._v(i._s(i.$t("invoicing.item_service_management.items_tab")))]),i._v(" "),e("f7-link",{class:{active:"packages"===i.activeTab},on:{click:function(t){i.activeTab="packages"}}},[i._v(i._s(i.$t("invoicing.item_service_management.packages_tab")))])],1),i._v(" "),e("div",{directives:[{name:"show",rawName:"v-show",value:"items"===i.activeTab,expression:"activeTab === 'items'"}],staticClass:"item-service-tab"},[i.items&&i.items.length?e("f7-searchbar",{attrs:{"search-container":".invoicing-list-items",backdrop:!1,"disable-button":!1,placeholder:i.$t("invoicing.item_service_management.search_items")}}):i._e(),i._v(" "),i.items&&i.items.length?e("f7-list",{staticClass:"list-custom invoicing-list-items",attrs:{"no-hairlines":""}},i._l(i.items,function(t){return e("f7-list-item",{key:t.id,attrs:{title:t.name,link:"/invoicing/item-details/"+t.id+"/"}})})):i._e()],1),i._v(" "),e("div",{directives:[{name:"show",rawName:"v-show",value:"packages"===i.activeTab,expression:"activeTab === 'packages'"}],staticClass:"item-service-tab"},[i.packages&&i.packages.length?e("f7-searchbar",{attrs:{"search-container":".invoicing-list-packages",backdrop:!1,"disable-button":!1,placeholder:i.$t("invoicing.item_service_management.search_packages")}}):i._e(),i._v(" "),i.packages&&i.packages.length?e("f7-list",{staticClass:"list-custom invoicing-list-packages",attrs:{"no-hairlines":""}},i._l(i.packages,function(t){return e("f7-list-item",{key:t.id,attrs:{title:t.name,link:"/invoicing/package-details/"+t.id+"/"}})})):i._e()],1)],1)},staticRenderFns:[],data:function data(){return{items:null,packages:null,activeTab:"items"}},mounted:function mounted(){var e=this;n.loadItems({},{cache:!1}).then(function(t){var i;e.items=t,(i=e.items).push.apply(i,[{id:1,name:"Hello"},{id:2,name:"Ololo"}])}),n.loadPackages({},{cache:!1}).then(function(t){var i;e.packages=t,(i=e.packages).push.apply(i,[{id:1,name:"Hello Package"},{id:2,name:"Ololo Package"}])})},computed:{},methods:{add:function add(){}}}},{path:"/invoicing/list-management/",component:{render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("f7-page",{staticClass:"invoicing-page",attrs:{name:"invoicing__list-management",id:"invoicing__list-management"}},[a("f7-navbar",[a("tommy-nav-back"),e._v(" "),a("f7-nav-title",[e._v(e._s(e.$t("invoicing.list_management.title","List Management")))]),e._v(" "),a("f7-nav-right",[e.showSave?a("f7-link",{attrs:{"icon-f7":"check"},on:{click:e.save}}):e._e()],1)],1),e._v(" "),e.lists?a("f7-list",{staticClass:"list-custom",attrs:{sortable:"",sortableEnabled:"",inset:""},on:{"sortable:sort":e.onSort}},e._l(e.orderedLists,function(i){return a("f7-list-item",{key:i.id,attrs:{checkbox:"",checked:i.data.active,title:i.name},on:{change:function(t){e.toggleListActive(i,t.target.checked)}}})})):e._e(),e._v(" "),a("f7-list",{staticClass:"list-custom margin-bottom",attrs:{inset:""}},[a("f7-list-item",{attrs:{link:"/invoicing/list-add/",title:e.$t("invoicing.list_management.create_list","Create New List")}})],1)],1)},staticRenderFns:[],data:function data(){return{saving:!1,showSave:!1,lists:null}},mounted:function mounted(){var i=this;n.loadLists({},{cache:!1}).then(function(t){i.lists=t})},computed:{orderedLists:function orderedLists(){return this.lists?this.lists.sort(function(t,i){return t.data.position-i.data.position}):null}},methods:{onSort:function onSort(t,i){void 0===i&&(i={});var e=i.from,a=i.to,s=this;s.saving||(s.showSave=!0,s.$nextTick(function(){var t;s.lists[e].data.position=a,(t=s.lists).splice.apply(t,[a,0].concat(s.lists.splice(e,1))),s.$forceUpdate()}))},toggleListActive:function toggleListActive(t,i){this.saving||(this.showSave=!0,t.data.active=i)},save:function save(){var t=this;t.showSave=!1;var e=[];t.lists.forEach(function(t,i){t.data.position=i,e.push(n.saveList(t))}),Promise.all(e).then(function(){t.$events.$emit("invoicing:reloadLists"),t.$f7router.back()})}}}},{path:"/invoicing/list-add/",component:{render:function(){var i=this,t=i.$createElement,e=i._self._c||t;return e("f7-page",{staticClass:"invoicing-page",attrs:{name:"invoicing__list-add",id:"invoicing__list-add"}},[e("f7-navbar",[e("tommy-nav-back"),i._v(" "),e("f7-nav-title",[i._v(i._s(i.$t("invoicing.list_add.title","Add List")))]),i._v(" "),e("f7-nav-right",[i.showSave?e("f7-link",{attrs:{"icon-f7":"check"},on:{click:i.save}}):i._e()],1)],1),i._v(" "),e("f7-list",{staticClass:"top-0"},[e("f7-list-item",[e("f7-input",{attrs:{type:"text",placeholder:i.$t("invoicing.list_add.name_placeholder","Name"),value:i.name},on:{input:function(t){i.name=t.target.value}}})],1)],1)],1)},staticRenderFns:[],data:function data(){return{saving:!1,name:""}},computed:{showSave:function showSave(){return this.name.trim().length}},methods:{save:function save(){var t=this;t.saving||(t.saving=!0,n.saveList({name:t.name}).then(function(){t.$events.$emit("invoicing:reloadLists"),t.$f7router.back("/invoicing/"+(n.actorId?"?actor_id="+n.actorId:""),{force:!0})}))}}}}]}();